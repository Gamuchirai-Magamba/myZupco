/*! permutive-javascript-sdk v19.31.0 (web) (built 2022-10-07T13:53:03.574Z) */(()=>{"use strict";var __webpack_modules__={2688:(e,t,i)=>{function n(e){return e instanceof Error?e:new Error("string"==typeof e?e:JSON.stringify(e))}i.d(t,{w:()=>n})},787:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(3735),r=i(6567);function o(e){return(0,n.zG)((0,r.Y3)((()=>JSON.parse(e))),(0,r.fS)(n.gn))}},7183:(e,t,i)=>{i.d(t,{h:()=>n});const n=e=>new r(e);class r{constructor(e){const t=this;this._worker=e,this._callbacks={},this._id=0,e.addEventListener("message",(function(e){r.onMessage(t,e)}))}set id(e){this._id=e}get id(){return this._id}newId(){const e=this.id;return this.id=this.id+1,e}static onMessage(e,t){if(i=t.data,!(Array.isArray(i)&&i.length>=2))return;var i;const[n,r,o]=t.data,s=e._callbacks[n];s&&(delete e._callbacks[n],s(r,o))}static isServiceWorker(e){return void 0!==e.controller}postMessage(e){const t=this,i=this.newId(),n=[i,e];return new Promise((function(e,o){var s;if(t._callbacks[i]=function(t,i){if(t)return o(new Error(t.message));e(i)},r.isServiceWorker(t._worker)){const e=new MessageChannel;e.port1.onmessage=function(e){r.onMessage(t,e)},null===(s=t._worker.controller)||void 0===s||s.postMessage(n,[e.port2])}else t._worker.postMessage(n)}))}}},1828:(e,t,i)=>{i.d(t,{ap:()=>o,gz:()=>u});var n=i(3735),r=i(9384);function o(e,t){return function(i){return function(n){return e.ap(e.map(n,(function(e){return function(i){return t.ap(e,i)}})),i)}}}function s(e,t,i){return function(n){for(var r=Array(i.length+1),o=0;o<i.length;o++)r[o]=i[o];return r[i.length]=n,0===t?e.apply(null,r):s(e,t-1,r)}}var a={1:function(e){return[e]},2:function(e){return function(t){return[e,t]}},3:function(e){return function(t){return function(i){return[e,t,i]}}},4:function(e){return function(t){return function(i){return function(n){return[e,t,i,n]}}}},5:function(e){return function(t){return function(i){return function(n){return function(r){return[e,t,i,n,r]}}}}}};function c(e){return r.e$.call(a,e)||(a[e]=s(n.bc,e-1,[])),a[e]}function u(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var n=t.length,r=c(n),o=e.map(t[0],r),s=1;s<n;s++)o=e.ap(o,t[s]);return o}}},9320:(e,t,i)=>{i.d(t,{oA:()=>Q,e5:()=>R,t9:()=>C,hX:()=>F,DZ:()=>z,Ew:()=>x,xH:()=>W,jV:()=>L,xb:()=>D,UI:()=>N,uK:()=>J,u4:()=>H,vP:()=>V,DY:()=>A,G0:()=>j,jj:()=>U});var n,r=i(3735),o=i(9384);i(4268),i(7209),n=void 0;o.Xl,o.Od;var s=o.ri,a=o.YM,c=(o.F4,a);o.Gb;var u=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},l=function(e){return e.length>0},p=function(e){return function(t){return u(u([],t,!0),[e],!1)}},d=p,_=function(e){return function(t){if(1===t.length)return h(t);for(var i=[y(t)],n=function(t){i.every((function(i){return!e.equals(i,t)}))&&i.push(t)},r=0,o=w(t);r<o.length;r++){n(o[r])}return i}},g=function(e){var t=_(e);return function(e){return function(i){return t((0,r.zG)(i,f(e)))}}},m=o.r1;function f(e,t){return t?e.concat(t):function(t){return t.concat(e)}}var h=m,v=function(e){return[e]};o.F4;var y=c,w=function(e){return e.slice(1)};i(4011);var b=i(4870);i(5605);function q(e){return function(t,i){if(void 0===i){var n=q(e);return function(e){return n(t,e)}}for(var r,o=0;o<i.length;o++)if(r=i[o],e.equals(r,t))return!0;return!1}}var k=s,E=function(e){return function(t){for(var i=[],n=0;n<t.length;n++){var r=e(n,t[n]);o.pC(r)&&i.push(r.value)}return i}},P=function(e){return E((function(t,i){return e(i)}))},S=(r.yR,function(e,t){return O(e,(function(e,i,n){return t(i,n)}))}),O=function(e,t){return function(i){for(var n=i.length,r=e,o=0;o<n;o++)r=t(o,r,i[o]);return r}};o.F4;var D=function(e){return 0===e.length},M=l,I=d;function x(e){return function(e){return function(t){for(var i=0;i<t.length;i++)if(e(t[i]))return o.G(t[i]);return o.YP}}(e)}var T=function(e){return e.slice()},A=function(e){return function(t){return t.length<=1?T(t):t.slice().sort(e.compare)}};var C=q,U=function(e){var t=_(e);return function(e){return M(e)?t(e):T(e)}};function j(e){var t=g(e);return function(i,n){if(void 0===n){var r=j(e);return function(e){return r(e,i)}}return M(i)&&M(n)?t(n)(i):M(i)?T(i):T(n)}}function L(e){var t=C(e);return function(i,n){if(void 0===n){var r=L(e);return function(e){return r(e,i)}}return i.filter((function(e){return t(e,n)}))}}function R(e){var t=C(e);return function(i,n){if(void 0===n){var r=R(e);return function(e){return r(e,i)}}return i.filter((function(e){return!t(e,n)}))}}var B=function(e,t,i){return(0,r.zG)(e,H(t,i))},G=v,N=function(e){return function(t){return t.map((function(t){return e(t)}))}},K=function(e){return function(t){return(0,r.zG)(t,function(e){return function(t){for(var i=[],n=0;n<t.length;n++)i.push.apply(i,e(n,t[n]));return i}}((function(t,i){return e(i)})))}},W=K(r.yR),$=function(e){return function(t){for(var i=[],n=0;n<t.length;n++){var r=e(n,t[n]);o.pC(r)&&i.push(r.value)}return i}},z=function(e){return $((function(t,i){return e(i)}))},Q=z(r.yR),F=function(e){return function(t){return t.filter(e)}},J=function(e){return Y((function(t,i){return e(i)}))},Y=function(e){return function(t){for(var i=[],n=[],r=0;r<t.length;r++){var o=t[r];e(r,o)?n.push(o):i.push(o)}return(0,b.s4)(i,n)}},H=S,V=function(e){return function(t){return B(t,e.of([]),(function(t,i){return e.ap(e.map(t,(function(e){return function(t){return(0,r.zG)(e,I(t))}})),i)}))}};o.F4},8198:(e,t,i)=>{i.d(t,{G5:()=>f,dO:()=>_,Pd:()=>y,tS:()=>v,g_:()=>D,ij:()=>x,Yo:()=>k,DT:()=>q,fS:()=>M,nM:()=>E,tO:()=>P,t$:()=>a,UI:()=>d,Vn:()=>w,EQ:()=>O,F2:()=>c,LF:()=>I,i$:()=>A,Y3:()=>T});var n=i(9384);function r(e){return function(t){return function(i){return e.fromEither(n.Wi(i)?n.t$(t()):n.F2(i.value))}}}function o(e){return function(t,i){return function(r){return e.fromEither(t(r)?n.F2(r):n.t$(i(r)))}}}var s=i(3735),a=n.t$,c=n.F2,u=function(e,t){return(0,s.zG)(e,d(t))},l=function(e,t){return(0,s.zG)(e,m(t))},p="Either",d=function(e){return function(t){return E(t)?t:c(e(t.right))}},_={URI:p,map:u},g=c,m=function(e){return function(t){return E(t)?t:E(e)?e:c(t.right(e.right))}},f={URI:p,map:u,ap:l},h=function(e){return function(t){return E(t)?t:e(t.right)}},v=h,y=function(e,t){return function(i){return E(i)?a(e(i.left)):c(t(i.right))}},w=function(e){return function(t){return E(t)?a(e(t.left)):t}},b={URI:p,fromEither:s.yR},q=o(b),k=r(b),E=n.nM,P=n.tO,S=function(e,t){return function(i){return E(i)?e(i.left):t(i.right)}},O=S,D=O,M=function(e){return function(t){return E(t)?e(t.left):t.right}},I=function(e){return E(e)?c(e.left):a(e.right)},x=function(e){return function(t){return null==t?a(e):c(t)}},T=function(e,t){try{return c(e())}catch(e){return a(t(e))}},A=S(s.yR,s.yR);n.F4,n.Xl},4268:(e,t,i)=>{i.d(t,{Uz:()=>r,f7:()=>n,w4:()=>o});i(3735);var n=function(e){return{equals:function(t,i){return t===i||e(t,i)}}},r=function(e){return function(t){return n((function(i,n){return t.equals(e(i),e(n))}))}},o={equals:function(e,t){return e===t}};o.equals},6567:(e,t,i)=>{i.d(t,{DT:()=>a,EQ:()=>f,G:()=>s,UI:()=>u,Uo:()=>d,Wi:()=>g,Y3:()=>w,YP:()=>o,fS:()=>v,g_:()=>h,ij:()=>y,pC:()=>_,tS:()=>p});var n=i(3735),r=i(9384),o=(i(6017),i(4870),i(5605),r.YP),s=r.G;function a(e){return function(t){return e(t)?s(t):o}}var c=function(e){return"Left"===e._tag?o:s(e.right)},u=function(e){return function(t){return g(t)?o:s(e(t.value))}},l=s,p=function(e){return function(t){return g(t)?o:e(t.value)}},d=(n.yR,c),_=r.pC,g=function(e){return"None"===e._tag},m=function(e,t){return function(i){return g(i)?e():t(i.value)}},f=m,h=f,v=function(e){return function(t){return g(t)?e():t.value}},y=function(e){return null==e?o:s(e)},w=function(e){try{return s(e())}catch(e){return o}};r.F4,r.Xl},7209:(e,t,i)=>{i.d(t,{Fp:()=>c,VV:()=>a,Zt:()=>s,uZ:()=>u});var n=i(4268),r=i(3735),o=function(e){return function(t,i){return t===i||0===e(t,i)}},s=function(e){return{equals:o(e),compare:function(t,i){return t===i?0:e(t,i)}}},a=(r.W8,function(e){return function(t,i){return t===i||e.compare(t,i)<1?t:i}}),c=function(e){return function(t,i){return t===i||e.compare(t,i)>-1?t:i}},u=function(e){var t=a(e),i=c(e);return function(e,n){return function(r){return i(t(r,n),e)}}};n.w4.equals},6017:(e,t,i)=>{i.d(t,{ff:()=>n});i(3735);var n=function(e){return function(t){return!e(t)}}},356:(e,t,i)=>{i.d(t,{hX:()=>Y,jV:()=>B,xb:()=>C,XP:()=>j,dx:()=>L});i(4268);var n=i(3735),r=i(9384),o=(i(4870),i(2751)),s=(i(5605),function(e){for(var t in e)if(r.e$.call(e,t))return!1;return!0}),a=function(e){return function(t){return Object.keys(t).sort(e.compare)}};o.Df;var c=function(e,t){return function(i){if(r.e$.call(i,e)&&i[e]===t)return i;var n=Object.assign({},i);return n[e]=t,n}},u=function(e,t){return r.e$.call(t,e)};var l={};function p(e){return function(t){var i={};for(var n in t)r.e$.call(t,n)&&(i[n]=e(n,t[n]));return i}}function d(e){return p((function(t,i){return e(i)}))}function _(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(2===e.length)return _(o.Df).apply(void 0,e);var i=a(e[0]);return function(e,t){return function(n){for(var r=e,o=i(n),s=o.length,a=0;a<s;a++){var c=o[a];r=t(c,r,n[c])}return r}}}function g(e){if("compare"in e){var t=a(e);return function(e){return function(i){return function(n){for(var r=e.empty,o=t(n),s=o.length,a=0;a<s;a++){var c=o[a];r=e.concat(r,i(c,n[c]))}return r}}}}return g(o.Df)(e)}function m(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(2===e.length)return m(o.Df).apply(void 0,e);var i=a(e[0]);return function(e,t){return function(n){for(var r=e,o=i(n),s=o.length-1;s>=0;s--){var a=o[s];r=t(a,n[a],r)}return r}}}function f(e){return O(o.Df)(e)}function h(e){return function(t){var i={},n=!1;for(var o in t)if(r.e$.call(t,o)){var s=t[o];e(o,s)?i[o]=s:n=!0}return n?i:t}}var v=function(e){return function(t){return function(i){if(s(i)||s(t))return l;var n={};for(var r in i)u(r,t)&&(n[r]=e.concat(i[r],t[r]));return n}}},y=function(e,t){return(0,n.zG)(e,d(t))},w=function(e){var t=I(e);return function(e,i,r){return(0,n.zG)(e,t(i,r))}},b=function(e){return function(t){var i=x(e)(t);return function(e,t){return(0,n.zG)(e,i(t))}}},q=function(e){var t=T(e);return function(e,i,r){return(0,n.zG)(e,t(i,r))}},k=function(e){var t=_(e);return function(e,i,r){return(0,n.zG)(e,t(i,r))}},E=function(e){var t=g(e);return function(e){var i=t(e);return function(e,t){return(0,n.zG)(e,i(t))}}},P=function(e){var t=m(e);return function(e,i,r){return(0,n.zG)(e,t(i,r))}},S=function(e){var t=D(e);return function(e){var i=t(e);return function(e,t){return i(e,(0,n.ls)(n.SK,t))}}},O=function(e){var t=S(e);return function(e){var i=t(e);return function(e){return i(e,n.yR)}}},D=function(e){return function(t){var i=a(e);return function(e,n){var r=i(e);if(0===r.length)return t.of(l);for(var o=t.of({}),s=function(i){o=t.ap(t.map(o,(function(e){return function(t){var n;return Object.assign({},e,((n={})[i]=t,n))}})),n(i,e[i]))},a=0,c=r;a<c.length;a++){s(c[a])}return o}}},M=function(e){return h((function(t,i){return e(i)}))};function I(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var i=_(e[0]);return function(e,t){return i(e,(function(e,i,n){return t(i,n)}))}}return I(o.Df).apply(void 0,e)}function x(e){if("compare"in e){var t=g(e);return function(e){var i=t(e);return function(e){return i((function(t,i){return e(i)}))}}}return x(o.Df)(e)}function T(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var i=m(e[0]);return function(e,t){return i(e,(function(e,i,n){return t(i,n)}))}}return T(o.Df).apply(void 0,e)}var A="ReadonlyRecord";o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df;o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df;var C=s,U=function(e){return function(t){return Object.keys(t).sort(e.compare)}},j=U(o.Df);var L=c;function R(e){return f(e)}var B=function(e){return function(t){return function(i){return C(i)||C(t)?{}:v(e)(t)(i)}}},G=y,N=w,K=b,W=q,$=k,z=E,Q=P,F=S,J=function(e){return function(t){var i=U(e);return function(e,n){var r=i(e);if(0===r.length)return t.of({});for(var o=t.of({}),s=function(i){o=t.ap(t.map(o,(function(e){return function(t){return e[i]=t,e}})),n(i,e[i]))},a=0,c=r;a<c.length;a++){s(c[a])}return o}}},Y=M;var H="Record";o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df,o.Df},4870:(e,t,i)=>{i.d(t,{s4:()=>n});i(3735);var n=function(e,t){return{left:e,right:t}}},5857:(e,t,i)=>{i.d(t,{e5:()=>d,Eh:()=>u,G0:()=>p});var n=i(4268),r=i(6017);new Set;var o=function(e){return function(t){for(var i,n=t.values(),r=!1;!r&&!(i=n.next()).done;)r=e(i.value);return r}};function s(e){return(0,r.ff)(o((0,r.ff)(e)))}function a(e){var t=c(e);return function(i,n){if(void 0===n){var r=a(e);return function(e){return r(e,i)}}return s((function(e){return t(e,n)}))(i)}}function c(e){return function(t,i){if(void 0===i){var n=c(e);return function(e){return n(t,e)}}for(var r,o=i.values(),s=!1;!s&&!(r=o.next()).done;)s=e.equals(t,r.value);return s}}var u=function(e){var t=a(e);return(0,n.f7)((function(e,i){return t(e,i)&&t(i,e)}))};function l(e){return function(t){for(var i,n=t.values(),r=new Set;!(i=n.next()).done;){var o=i.value;e(o)&&r.add(o)}return r}}function p(e){var t=g(e);return function(i,n){if(void 0===n){var r=p(e);return function(e){return r(i,e)}}if(_(i))return n;if(_(n))return i;var o=new Set(i);return n.forEach((function(e){t(e,o)||o.add(e)})),o}}function d(e){var t=g(e);return function(i,n){if(void 0===n){var r=d(e);return function(e){return r(e,i)}}return l((function(e){return!t(e,n)}))(i)}}new Set;var _=function(e){return 0===e.size},g=c},5151:(e,t,i)=>{i.d(t,{Hi:()=>f,PM:()=>m,RD:()=>q,UA:()=>h,UI:()=>u,dO:()=>g,oE:()=>E,of:()=>p,pE:()=>k,tD:()=>o,tS:()=>d});var n=i(3735),r=i(9384),o=function(e){return function(){return Promise.resolve().then(e)}};var s=function(e,t){return(0,n.zG)(e,u(t))},a=function(e,t){return(0,n.zG)(e,l(t))},c=function(e,t){return(0,n.zG)(e,d(t))},u=function(e){return function(t){return function(){return Promise.resolve().then(t).then(e)}}},l=function(e){return function(t){return function(){return Promise.all([Promise.resolve().then(t),Promise.resolve().then(e)]).then((function(e){return(0,e[0])(e[1])}))}}},p=function(e){return function(){return Promise.resolve(e)}},d=function(e){return function(t){return function(){return Promise.resolve().then(t).then((function(t){return e(t)()}))}}},_="Task";var g={URI:_,map:s},m={URI:_,of:p},f={URI:_,map:s,ap:a},h={URI:_,map:s,of:p,ap:a,chain:c},v=n.yR,y=(r.F4,p(r.Xl)),w=function(e){var t=function(e){return function(t){return function(){return Promise.all(t.map((function(t,i){return Promise.resolve().then((function(){return e(i,t)()}))})))}}}(e);return function(e){return r.Od(e)?t(e):y}},b=function(e){var t=function(e){return function(t){return function(){return r.Gb(t).reduce((function(t,i,n){return t.then((function(t){return Promise.resolve().then(e(n+1,i)).then((function(e){return t.push(e),t}))}))}),Promise.resolve().then(e(0,r.YM(t))).then(r.ri))}}}(e);return function(e){return r.Od(e)?t(e):y}},q=function(e){return w((function(t,i){return e(i)}))}(n.yR),k=function(e){return b((function(t,i){return e(i)}))},E={URI:_,map:s,of:p,ap:a,chain:c,fromIO:o,fromTask:v}},7112:(e,t,i)=>{function n(e){return function(t,i){return function(n){return e.chain(n,(function(n){return e.map(i(n),(function(e){var i;return Object.assign({},n,((i={})[t]=e,i))}))}))}}}i.d(t,{Do:()=>V,ak:()=>X,tS:()=>F,g_:()=>G,Uo:()=>R,fF:()=>L,t$:()=>A,UI:()=>z,F2:()=>C,Y3:()=>N});var r=i(1828),o=i(8198),s=i(3735);function a(e,t){return function(i){return function(n){return e.map(n,(function(e){return t.map(e,i)}))}}}function c(e){return(0,s.ls)(o.F2,e.of)}function u(e){return(0,s.ls)(o.t$,e.of)}function l(e){return function(t){return e.map(t,o.F2)}}function p(e){return function(t){return e.map(t,o.t$)}}function d(e){return function(t){return(0,s.ls)(o.ij(t),e.of)}}function _(e){var t=d(e);return function(e){var i=t(e);return function(e){return(0,s.ls)(e,i)}}}function g(e){var t=h(e),i=_(e);return function(e){var n=i(e);return function(e){return t(n(e))}}}function m(e){return a(e,o.dO)}function f(e){return(0,r.ap)(e,o.G5)}function h(e){return function(t){return function(i){return e.chain(i,(function(i){return o.nM(i)?e.of(i):t(i.right)}))}}}function v(e){return function(t){return function(i){return e.chain(i,(function(i){return o.nM(i)?t():e.of(i)}))}}}function y(e){return function(t,i){return function(n){return e.map(n,o.Pd(t,i))}}}function w(e){return function(t){return function(i){return e.map(i,o.Vn(t))}}}function b(e){return function(t,i){return function(n){return e.map(n,o.EQ(t,i))}}}function q(e){return function(t,i){return function(n){return e.chain(n,o.EQ(t,i))}}}function k(e){return function(t){return function(i){return e.chain(i,o.EQ(t,e.of))}}}function E(e){return function(t){return function(i){return e.chain(i,(function(i){return o.nM(i)?t(i.left):e.of(i)}))}}}function P(e){var t=E(e);return function(i){return t((function(t){return e.map(i(t),(function(e){return o.nM(e)?e:o.t$(t)}))}))}}function S(e){return function(t){return function(i){return e.chain(i,o.EQ((function(i){return e.map(t(i),o.t$)}),(function(t){return e.of(o.F2(t))})))}}}function O(e){return function(t){return e.map(t,o.LF)}}function D(e){return function(t){return e.map(t,o.i$)}}var M=i(9384),I=i(5151),x=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},T=function(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},A=u(I.PM),C=c(I.PM),U=l(I.dO),j=p(I.dO),L=(I.tD,I.tD,U),R=I.of,B=(I.tD,I.dO,q(I.UA)),G=B,N=(I.UA,function(e,t){return function(){return x(void 0,void 0,void 0,(function(){var i;return T(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e().then(M.F2)];case 1:return[2,n.sent()];case 2:return i=n.sent(),[2,M.t$(t(i))];case 3:return[2]}}))}))}}),K=(I.dO,I.PM,I.PM,I.UA,I.UA,I.UA,I.UA,I.dO,function(e,t){return(0,s.zG)(e,z(t))}),W=function(e,t){return(0,s.zG)(e,Q(t))},$=function(e,t){return(0,s.zG)(e,F(t))},z=m(I.dO),Q=(I.dO,I.dO,f(I.Hi)),F=h(I.UA),J=(I.UA,C),Y="TaskEither";var H={URI:Y,map:K,ap:W,chain:$};var V=J(M.F4),X=n(H);M.Xl},5605:(e,t,i)=>{function n(e,t){return function(i){var n=e.traverse(i);return function(e,r){return i.map(n(e,r),t.separate)}}}function r(e,t){return function(i){var n=e.traverse(i);return function(e,r){return i.map(n(e,r),t.compact)}}}i.d(t,{BL:()=>r,Fj:()=>n})},3735:(e,t,i)=>{i.d(t,{MZ:()=>r,Q1:()=>c,SK:()=>d,W8:()=>s,a9:()=>o,bc:()=>l,gn:()=>a,ls:()=>u,yR:()=>n,zG:()=>p});function n(e){return e}var r=n;function o(e){return function(){return e}}var s=o(!0),a=o(null),c=o(void 0);function u(e,t,i,n,r,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return i(t(e.apply(this,arguments)))};case 4:return function(){return n(i(t(e.apply(this,arguments))))};case 5:return function(){return r(n(i(t(e.apply(this,arguments)))))};case 6:return function(){return o(r(n(i(t(e.apply(this,arguments))))))};case 7:return function(){return s(o(r(n(i(t(e.apply(this,arguments)))))))};case 8:return function(){return a(s(o(r(n(i(t(e.apply(this,arguments))))))))};case 9:return function(){return c(a(s(o(r(n(i(t(e.apply(this,arguments)))))))))}}}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}function p(e,t,i,n,r,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return i(t(e));case 4:return n(i(t(e)));case 5:return r(n(i(t(e))));case 6:return o(r(n(i(t(e)))));case 7:return s(o(r(n(i(t(e))))));case 8:return a(s(o(r(n(i(t(e)))))));case 9:return c(a(s(o(r(n(i(t(e))))))));default:for(var u=arguments[0],l=1;l<arguments.length;l++)u=arguments[l](u);return u}}var d=function(e,t){return t}},9384:(e,t,i)=>{i.d(t,{F2:()=>p,F4:()=>h,G:()=>a,Gb:()=>m,Od:()=>_,Wi:()=>r,Xl:()=>f,YM:()=>g,YP:()=>s,e$:()=>v,nM:()=>c,pC:()=>o,r1:()=>y,ri:()=>d,t$:()=>l,tO:()=>u});var n=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},r=function(e){return"None"===e._tag},o=function(e){return"Some"===e._tag},s={_tag:"None"},a=function(e){return{_tag:"Some",value:e}},c=function(e){return"Left"===e._tag},u=function(e){return"Right"===e._tag},l=function(e){return{_tag:"Left",left:e}},p=function(e){return{_tag:"Right",right:e}},d=function(e){return[e]},_=function(e){return e.length>0},g=function(e){return e[0]},m=function(e){return e.slice(1)},f=[],h={},v=Object.prototype.hasOwnProperty,y=function(e){return n([e[0]],e.slice(1),!0)}},4011:(e,t,i)=>{i.d(t,{Df:()=>r,Eq:()=>n});var n={equals:function(e,t){return e===t}},r={equals:n.equals,compare:function(e,t){return e<t?-1:e>t?1:0}};n.equals,r.compare},2751:(e,t,i)=>{i.d(t,{Df:()=>r,Eq:()=>n,pn:()=>s,xb:()=>o});var n={equals:function(e,t){return e===t}},r={equals:n.equals,compare:function(e,t){return e<t?-1:e>t?1:0}},o=function(e){return 0===e.length},s=function(e,t){return function(i){return i.endsWith(e,t)}}},655:(e,t,i)=>{i.d(t,{_T:()=>n,mG:()=>r});function n(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}function r(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}Object.create;Object.create},477:e=>{e.exports=function(e,t,i,n){var r=self||window;try{try{var o;try{o=new r.Blob([e])}catch(t){(o=new(r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder)).append(e),o=o.getBlob()}var s=r.URL||r.webkitURL,a=s.createObjectURL(o),c=new r[t](a,i);return s.revokeObjectURL(a),c}catch(n){return new r[t]("data:application/javascript,".concat(encodeURIComponent(e)),i)}}catch(e){if(!n)throw Error("Inline worker is not supported");return new r[t](n,i)}}},5607:(e,t,i)=>{i.r(t),i.d(t,{CleanRoomAddon:()=>b,load:()=>v});var n=i(655),r=i(2688),o=i(9320),s=i(8198),a=i(3735),c=i(4011),u=i(6567),l=i(356),p=i(2751),d=i(7112),_=(i(64),i(6013));const g=()=>{const e={maxAttempts:200,waitTimeInMs:50};let t;return(0,_.a4)((()=>t),(()=>(t=(()=>{var e;const t=null===(e=window._pbjsGlobals)||void 0===e?void 0:e[0];return window.pbjs||window.vmpbjs||(t?window[t]:null)})(),!!(null==t?void 0:t.que)&&"function"==typeof(null==t?void 0:t.getEvents))),e)},m=e=>"function"==typeof e.readConfig?e.readConfig():e.getConfig();var f=i(7545),h=i(8863);const v=(e,t,i)=>{e.push({functionName:"addon",arguments:["clean_room",{}]})},y=(e,t)=>({direct_buy:(0,o.G0)(p.Eq)(e.direct_buy,t.direct_buy),programmatic:(0,o.G0)(p.Eq)(e.programmatic,t.programmatic)}),w=(0,l.hX)((e=>null!=e));class b{constructor(e){this.prefix="[clean_room]",this.stagedAuctions={},this.trackableAuctions={},this.trackAuctionsInterval=null,this.putOrResetUnprocessed=u.g_((()=>this.unprocessedPrebidAuctions.reset()),(e=>this.unprocessedPrebidAuctions.put(e))),this.options=e,this.permutive=e.permutive,this.api=e.api,this.logger=e.logger,this.namespace=e.namespace,this.queryManager=e.queryManager,this.messages=e.messages,this.network=e.network,this.unprocessedPrebidAuctions=e.unprocessedEvents.PrebidAuctions,this.userId=e.userId,this.sessionManager=e.sessionManager;const t=this.sessionManager.sessionHasChanged();this.makeRequest(t),this.startPrebidAuctions()}get allAuctions(){return Object.assign(Object.assign({},this.stagedAuctions),this.trackableAuctions)}makeRequest(e){this.getQueries(e).then((t=>{if(e){const e=this.getOrEmpty(t.queries);this.cacheLocally(e),this.emitUpdated(e)}else{const e=this.getOrEmpty(t.queries),i=this.getCache(),n=y(e,i);this.cacheLocally(n),this.emitUpdated(n)}}))}getQueries(e){const t=this.queryManager.userSegments.getStdAsList(),i=this.queryManager.userSegments.getAllAsList(),n=(0,o.e5)(c.Eq)(i,t);return this.api.cleanRoom(e,{stds:t,fps:n,userId:this.userId.get()})}getCache(){return{direct_buy:this.options.externalData.getExternalJsonData(h.P)||[],programmatic:this.options.externalData.getExternalJsonData(h.l)||[]}}cacheLocally(e){this.options.externalData.setExternalJsonData(h.P,e.direct_buy),this.options.externalData.setExternalJsonData(h.l,e.programmatic)}emitUpdated(e){this.messages.emit("permutive:cleanroom:db:updated",(0,o.G0)(p.Eq)(e.programmatic,e.direct_buy))}getOrEmpty(e){var t,i;return{direct_buy:null!==(t=e.direct_buy)&&void 0!==t?t:[],programmatic:null!==(i=e.programmatic)&&void 0!==i?i:[]}}startPrebidAuctions(){return(0,n.mG)(this,void 0,void 0,(function*(){yield this.trackUnprocessedPrebidAuctions();const e=yield g();if(u.Wi(e))return void this.logInfo("Tracking Prebid Auctions did not start. Missing pbjs.");const{value:t}=e;this.logDebug("Got prebid",t),this.setupUnprocessedPrebidAuctions(),t.onEvent("auctionEnd",(e=>{this.mapToStagedAuctions(t,e),this.storeAuctionsAsUnprocessed(this.allAuctions)})),t.onEvent("bidWon",(e=>{this.setBidToWon(t,e),this.storeAuctionsAsUnprocessed(this.allAuctions)}));const i=(e,i)=>{this.logDebug("Processing render event",{isRendered:e,props:i}),i.bid&&(e&&this.setBidToRendered(t,i.bid),this.promoteAuctionToTrackable(i.bid),this.storeAuctionsAsUnprocessed(this.allAuctions),this.trackEligibleAuctions())};t.onEvent("adRenderSucceeded",(e=>{i(!0,e)})),t.onEvent("adRenderFailed",(e=>{i(!1,e)})),t.getEvents().forEach((e=>"auctionEnd"===e.eventType?this.mapToStagedAuctions(t,e.args):("bidWon"===e.eventType&&this.setBidToWon(t,e.args),"adRenderSucceeded"===e.eventType?i(!0,e.args):"adRenderFailed"===e.eventType?i(!1,e.args):void 0))),this.storeAuctionsAsUnprocessed(this.allAuctions,{debounced:!1}),(0,_.aq)((()=>(0,n.mG)(this,void 0,void 0,(function*(){this.trackAuctionsInterval=null;const e=this.allAuctions;this.stagedAuctions={},this.trackableAuctions={},yield this.trackPrebidAuctions(e,{useBeacon:!0}),yield this.storeAuctionsAsUnprocessed(null,{debounced:!1})}))),navigator.userAgent)}))}trackUnprocessedPrebidAuctions(){return(0,a.zG)(d.Y3((()=>(0,n.mG)(this,void 0,void 0,(function*(){return(0,a.zG)(yield this.unprocessedPrebidAuctions.getIfPresent(),u.g_((()=>this.logDebug("No unprocessed PrebidAuctions found")),(e=>{var{props:t}=e,i=(0,n._T)(e,["props"]);return this.logDebug("Found unprocessed PrebidAuctions",{props:t,unprocessedData:i}),Promise.all([this.permutive.track("PrebidAuctions",t,{unprocessedData:i}),this.unprocessedPrebidAuctions.reset()])})))}))),(e=>{const t=`Failed to track unprocessed PrebidAuctions. Got ${(0,r.w)(e)}`;return this.reportError(t),(0,r.w)(t)})),(e=>e()))}setupUnprocessedPrebidAuctions(){const e=new f.b(1e3,2500),t=this.putOrResetUnprocessed.bind(this);this.debouncedPutOrResetUnprocessed=e.schedule(t)}storeAuctionsAsUnprocessed(e,{debounced:t=!0}={}){return(0,n.mG)(this,void 0,void 0,(function*(){const i=(0,_.qh)(null!=e?e:{}).map((([e,t])=>Object.assign(Object.assign({},t),{auction_id:e}))),r=yield this.options.clientContext.getClient();return(0,a.zG)(i,u.DT((e=>e.length>0)),u.UI((e=>({props:{isp_info:"$ip_isp_info",geo_info:"$ip_geo_info",aggregations:{auctions:e}},client:r,viewId:this.options.viewId.get(),sessionId:this.sessionManager.getSessionId()}))),(e=>(0,n.mG)(this,void 0,void 0,(function*(){yield this.debouncedPutOrResetUnprocessed(e),t||(yield this.putOrResetUnprocessed(e))}))))}))}mapBidsReceived(e,{bidsReceived:t}){const i=e=>{var t,i,n;const r=(null===(t=e.rubicon)||void 0===t?void 0:t.advertiserId)||(null===(i=e.meta)||void 0===i?void 0:i.buyerId)||(null===(n=e.meta)||void 0===n?void 0:n.advertiserId);return r?`${r}`:null},n=e=>{var t,i,n;const r=(null===(t=e.meta)||void 0===t?void 0:t.clickUrl)||(null===(i=e.adomain)||void 0===i?void 0:i[0])||(null===(n=e.meta)||void 0===n?void 0:n.advertiserName);return r?`${r}`:null},r=e=>{var t;const i=null===(t=e.meta)||void 0===t?void 0:t.advertiserDomains;if("string"==typeof i)return[i];if(Array.isArray(i)){const e=i.filter((e=>"string"==typeof e));return e.length>0?e:null}return null},o=e=>{var t;const i=null===(t=e.meta)||void 0===t?void 0:t.brandId;return i?`${i}`:null},s=e=>{var t;return null===(t=e.meta)||void 0===t?void 0:t.brandName},a=e=>{var t,i,n;const r=(null===(t=e.appnexus)||void 0===t?void 0:t.buyerMemberId)||(null===(i=e.rubicon)||void 0===i?void 0:i.networkId)||(null===(n=e.meta)||void 0===n?void 0:n.networkId);return r?`${r}`:null},c=e=>"rendered"===e.status||"targetingSet"===e.status;return t.map((t=>{var u;const l={advertiser_id:i(t),advertiser_name:n(t),advertiser_domains:r(t),brand_id:o(t),brand_name:s(t),deal_id:t.dealId,dsp_id:a(t),hb_pb:null===(u=t.adserverTargeting)||void 0===u?void 0:u.hb_pb,request_timestamp:t.requestTimestamp,response_timestamp:t.responseTimestamp},p={ad_id:t.adId,ad_unit_code:t.adUnitCode,bid_available:t.statusMessage&&t.statusMessage.indexOf("empty")<0,bidder:t.bidder,bidder_timeout:e.bidderTimeout,cpm:t.cpm,creative_id:`${t.creativeId}`,height:t.height,time_to_respond:t.timeToRespond,width:t.width,winning_bid:c(t)};return Object.assign(Object.assign({},w(l)),p)}))}mapToStagedAuctions(e,t){return s.Y3((()=>{const{auctionId:i}=t,n=m(e);return this.stagedAuctions[i]={bids:this.mapBidsReceived(n,t)},this.logDebug("Added auction",this.stagedAuctions[i]),this.stagedAuctions[i]}),(e=>{const t=`Failed to map auction. Got ${(0,r.w)(e)}`;return this.reportError(t),(0,r.w)(t)}))}setBidByOperation(e,t,i){const n=t=>{const i=this.getStagedAuction(t.auctionId);if((0,s.tO)(i))return i;const n=this.getTrackableAuction(t.auctionId);return(0,s.tO)(n)?n:this.mapToStagedAuctions(e,{auctionId:t.auctionId,bidderRequests:[],bidsReceived:[t],noBids:[]})};return(0,a.ls)((e=>(0,a.zG)(n(e),s.UI((n=>(0,a.zG)(n.bids,(0,o.Ew)((t=>e.adUnitCode===t.ad_unit_code&&e.adId===t.ad_id)),s.Yo((()=>new Error("Bid does not exist"))),s.UI(i),s.UI((e=>(this.logDebug(`Bid operation ${t} successful`,e),e)))))))),s.Vn((e=>{const i=`Failed bid operation ${t}. Got ${(0,r.w)(e)}`;return this.reportError(i),(0,r.w)(i)})))}setBidToWon(e,t){return this.setBidByOperation(e,"setWon",(e=>(e.winning_bid=!0,e)))(t)}setBidToRendered(e,t){return this.setBidByOperation(e,"setRendered",(e=>(e.is_rendered=!0,e.rendered_timestamp=(new Date).getTime(),e)))(t)}promoteAuctionToTrackable({auctionId:e}){const t=this.stagedAuctions[e];if(t){if(this.trackableAuctions[e])return this.logError("Auction is already promoted to trackable",{auction:this.trackableAuctions[e]});this.trackableAuctions[e]=t,delete this.stagedAuctions[e],this.logDebug("Auction promoted to trackable",{auctionId:e,trackableAuctions:this.trackableAuctions})}}trackEligibleAuctions(){if(this.trackAuctionsInterval)return;this.trackAuctionsInterval=(0,_.PQ)((()=>(0,n.mG)(this,void 0,void 0,(function*(){if(!this.trackAuctionsInterval)return;this.trackAuctionsInterval=null;const e=this.trackableAuctions;this.trackableAuctions={},yield this.trackPrebidAuctions(e),yield this.storeAuctionsAsUnprocessed(this.stagedAuctions,{debounced:!1})}))),{timeout:5e3})}trackPrebidAuctions(e,t){return(0,n.mG)(this,void 0,void 0,(function*(){const i=(0,_.qh)(e).map((([e,t])=>Object.assign(Object.assign({},t),{auction_id:e})));i.length&&(yield this.permutive.track("PrebidAuctions",{isp_info:"$ip_isp_info",geo_info:"$ip_geo_info",aggregations:{auctions:i}},t),this.logDebug("Tracked auctions",{auctions:i}))}))}getStagedAuction(e){return(0,a.zG)(this.stagedAuctions[e],s.DT(Boolean,(()=>new Error("Staged auction not found"))),s.Vn((t=>(this.logError(t,{auctionId:e}),t))))}getTrackableAuction(e){return(0,a.zG)(this.trackableAuctions[e],s.DT(Boolean,(()=>new Error("Trackable auction not found"))),s.Vn((t=>(this.logError(t,{auctionId:e}),t))))}reportError(e){return this.network.error(`${this.prefix} ${e}`)}logInfo(...e){this.logger.log(this.prefix,...e)}logDebug(...e){this.logger.debug(this.prefix,...e)}logError(...e){this.logger.error(this.prefix,...e)}}},8863:(e,t,i)=>{i.d(t,{P:()=>n,l:()=>r});const n="_pcrdbs",r="_pcrprs"},9417:(e,t,i)=>{i(1057),i(3351)},8206:(e,t,i)=>{i.d(t,{lg:()=>g,Bt:()=>m});var n=i(9320),r=i(3735),o=i(6567),s=i(6017),a=i(356),c=i(2751),u=i(6013);class l{constructor(e,t,i,n){this.userId=e,this.network=t,this.api=i,this.logger=n,this.tag="appnexus",this.ttlInSeconds=86400,this.usedForThirdPartyData=!0,this.url="https://ib.adnxs.com/getuidj",this.invalidAliases=["","0","-1"]}getId(){return this.logger.debug("identities[appnexus]: start HTTP request"),(0,u.G6)(navigator.userAgent)?Promise.resolve({type:"skipped"}):this.api.appnexus(this.url).then((e=>(this.logger.debug("identities[appnexus]: end HTTP request"),{type:"attempted",result:(0,r.zG)((0,o.DT)((e=>this.isValidAlias(e.uid)))(e),(0,o.UI)((e=>e.uid)))})),(e=>({type:"attempted",result:o.YP})))}reset(){return Promise.resolve()}isValidAlias(e){return!!e&&-1===this.invalidAliases.indexOf(e)}}class p{constructor(e,t,i,n,r){this.config=e,this.network=t,this.api=i,this.userId=n,this.logger=r,this.tag="pxid",this.ttlInSeconds=86400,this.usedForThirdPartyData=!1,this.url=`https://7c6db7ee-7cf2-4f9a-853a-78875d37e2bb.${this.config.pxidHost}/${this.config.apiVersion}/pxid`,this.resetUrl=this.url+"/reset"}getId(){return this.logger.debug("identities[pxid]: start HTTP request"),(0,u.G6)(navigator.userAgent)?Promise.resolve({type:"skipped"}):this.api.pxid(this.url).then((e=>(this.logger.debug("identities[pxid]: end HTTP request"),{type:"attempted",result:(0,o.ij)(e.uid)})),(e=>({type:"attempted",result:o.YP})))}reset(){return(0,u.G6)(navigator.userAgent)?Promise.resolve():this.api.pxidReset(this.resetUrl)}}const d=new Set(["public","email","email_md5","email_sha256"]),_=(e,t)=>!!e.id&&!(0,n.t9)(c.Eq)(e.tag,t);class g{constructor(e,t,i,n,r){this.metrics=e,this.trace=t,this.permutiveData=i,this.identityProviderEnv=n,this.logger=r,this.identities={},this.providers={},this.identitiesLastModified=new Date,this.identities=this.getCachedIdentitiesAndMigrateIfRequired()}get getIdentitiesLastModified(){return this.identitiesLastModified}prepareThirdPartyIdentities(){this.logger.debug("Identities: starting to load identities");const e=this.metrics.startTimer("sdk_get_third_party_identities_task_duration_seconds",{}),t=this.trace.startSpan("load_tpd_ids"),i=[{load:e=>{return t=e.config,i=e.network,n=e.api,r=e.userId,s=e.logger,(0,o.G)(new p(t,i,n,r,s));var t,i,n,r,s}},{load:e=>{return t=e.userId,i=e.network,n=e.api,r=e.logger,(0,o.G)(new l(t,i,n,r));var t,i,n,r}},{load:e=>(e.cookies,o.YP)},{load:e=>(e.cookies,o.YP)},{load:e=>(e.metrics,e.permutiveData,e.permutive,e.messages,o.YP)}],s=(0,n.oA)(i.map((e=>e.load(this.identityProviderEnv)))).map((e=>this.shouldAskForNewIdentity(e)?this.retrieveIdentity(e):Promise.resolve((0,r.bc)(e,this.getCachedTPDIdentity(e.tag)))));return Promise.all(s).then((e=>e.map((([e,t])=>(this.providers[e.tag]=e,this.setTPDIdentityIfPresent(e.tag,t,e.ttlInSeconds)))))).then((()=>{this.metrics.stopTimer("sdk_get_third_party_identities_task_duration_seconds",e),t.finish()}))}getPrioritizedIdentities(e){const t={default:0,appnexus:1,pxid:1},i=Object.entries(e).map((([e,{id:t,expiry:i,priority:n}])=>Object.assign(Object.assign(Object.assign({tag:e},t?{id:t}:{}),i?{expiry:i}:{}),void 0!==n?{priority:n}:{}))),r=i.filter((e=>_(e,Object.values(this.providers).map((e=>e.tag))))),s=i.filter((e=>((e,t)=>!!e.id&&!!(0,n.t9)(c.Eq)(e.tag,t))(e,Object.values(this.providers).map((e=>e.tag))))),a=(0,n.DZ)((e=>(0,o.ij)(e.priority)))(r),u=a.length>0?Math.max(...a):0,l=r.map((e=>void 0!==e.priority?Object.assign(Object.assign({},e),{priority:e.priority}):Object.assign(Object.assign({},e),{priority:u+1}))),p=s.map((e=>void 0===t[e.tag]?{tag:e.tag,id:e.id,priority:u+f}:{tag:e.tag,id:e.id,priority:u+h}));return l.concat(p)}getIdentitiesMap(){return this.getFilteredIdentities(((e,t)=>!!t.value))}getCustomerDefinedIdentitiesMap(){return this.getFilteredIdentities(((e,t)=>_({tag:e,id:t.value,expiry:t.expiry,priority:t.priority},Object.values(this.providers).map((e=>e.tag)))))}getTPDIdentitiesMap(){return this.getFilteredIdentities(((e,t)=>{var i,n;return!!t.value&&!!(null===(n=null===(i=this.providers)||void 0===i?void 0:i[e])||void 0===n?void 0:n.usedForThirdPartyData)}))}parseCustomerDefinedIdentities(e){const t=`Identify must be passed a non-empty string or list of { tag, id, priority? } tuples, value passed was '${JSON.stringify(e)}'`,i=e=>{throw new Error(e)},n=e=>(e.forEach((e=>{(e=>"string"==typeof e.id&&"string"==typeof e.tag)(e)||i(t),(e=>"email_sha256"!==e.tag||g.emailSHA256Regex.test(e.id))(e)||i("Identify called with unsupported format of email_sha256 ID. The support format is hex-encoded 64 character long lowercase string.")})),e);return"string"==typeof e?(r=e).length>0?[{id:r,tag:"default"}]:i(t):Array.isArray(e)?n(e):i(t);var r}extractIdentifyFromQueue({global:e},t=[]){const i=()=>e.q.findIndex((e=>"identify"===e.functionName)),n=(t,r)=>{if(t<0)return r;const o=e.q.splice(t,1)[0],s=this.parseCustomerDefinedIdentities(o.arguments[0]);return n(i(),r.concat(s))};return n(i(),t)}checkIdentitiesHaveBeenModified(e){const t={concat:(e,t)=>c.Eq.equals(e.value,t.value)?{}:(0,r.bc)(e,t)};return(0,r.zG)((0,a.jV)(t)(this.identities)(e),u.hk,(e=>{const t=(0,s.ff)(a.xb)(e);return this.logger.debug("[identities] is modified",t,e),t}))}setIdentities(e){let t=!1;const i=e.filter((e=>!d.has(e.tag))).reduce(((e,{tag:i,id:n,expiry:r,priority:o})=>(void 0===this.identities[i]&&(t=!0,this.logger.debug(`identities[${i}]: added`)),e[i]=Object.assign(Object.assign(Object.assign({},n?{value:n}:{}),r?{expiry:r}:{}),void 0!==o?{priority:o}:{}),e)),{});(t||this.checkIdentitiesHaveBeenModified(i))&&(this.identitiesLastModified=new Date),this.identities=Object.assign(Object.assign({},this.identities),i),this.logger.debug("[identities] Updating to",this.identities),this.permutiveData.setData("identities",this.identities)}reset(){return(0,r.zG)(this.identities={},(e=>Promise.all(Object.values(this.providers).map((e=>e.reset()))).then(r.Q1)))}getFilteredIdentities(e){return(0,u.m8)(...Object.entries(this.identities).filter((([t,i])=>e(t,i))).map((([e,{value:t,expiry:i,priority:n}])=>(0,r.bc)(e,Object.assign(Object.assign({id:t},i?{expiry:i}:{}),void 0!==n?{priority:n}:{})))))}shouldAskForNewIdentity(e){var t;const i=(0,o.ij)(null===(t=this.identities)||void 0===t?void 0:t[e.tag]);return(0,o.g_)((()=>!0),this.isIdentityExpired)(i)}getCachedTPDIdentity(e){return this.identities[e]?(0,o.ij)(this.identities[e].value):o.YP}setTPDIdentityIfPresent(e,t,i=86400){const n=()=>Date.now()+Math.floor(1e3*i);return(0,o.g_)((()=>this.setIdentities([{tag:e,expiry:n()}])),(t=>this.setIdentities([{tag:e,id:t,expiry:n()}])))(t)}retrieveIdentity(e){return e.getId().then((t=>"skipped"===t.type?(0,r.bc)(e,o.YP):(0,r.zG)(t.result,(t=>this.metrics.track({name:(0,o.pC)(t)?"sdk_third_party_identity_present_count":"sdk_third_party_identity_missing_count",value:1,labels:{identity_tag:e.tag}})),(i=>(0,r.bc)(e,t.result)))))}isIdentityExpired(e){return e.expiry&&Date.now()>=e.expiry}getCachedIdentitiesAndMigrateIfRequired(){return(e=>(0,u.m8)(...Object.entries(e).filter((([e,t])=>!this.isIdentityExpired(t)&&!d.has(e)))))(this.permutiveData.getData("identities")||{})}}g.emailSHA256Regex=/^[a-f0-9]{64}$/;const m=(e,t,i,r,o)=>{const s=(e,t)=>{const i=["(null)"];return i.indexOf(e)>-1||!!y[e]||(0,n.jV)(c.Eq)(t,i).length>0},a=e=>"721d6d85-35f0-4e35-bb38-13eb0d465158"===e,u={"be668577-07f5-444d-98e0-222b990951b1":s,"e43c8a90-d17b-4790-bfda-81b069b3b8c2":(e,t,i)=>["thestudentroom.co.uk"].some((e=>i.indexOf(e)>-1))&&(0,n.jV)(c.Eq)(t,["tsr-"]).length>0,"5d79bce7-5d2b-427e-a6c4-b89b6c7bf048":s,"366ab8da-5efa-4355-ab00-84db3b68ded2":e=>"96539955-4d7e-40df-882b-7e2fbacedb1c"===e||"345600e7-fb5f-48b1-9aa6-cde5396419b0"===e,"f3a06674-ebb9-4b9d-ba8f-0052018c0687":a,"38dadd0d-257a-4641-b332-b8b0fd20a6cb":a,"10453011-272d-49cd-9043-1964fdb36fd8":e=>"936ba6ac-9a8b-454d-ba98-facebd7553fe"===e},l={"fe68d1f7-c9f4-45b3-8905-7cda73d3fd74":e=>!!v[e]},p=u[e]||l[t];return!!p&&p(o,i,r)},f=2,h=3,v={},y={}},6815:(e,t,i)=>{i.d(t,{z:()=>n});class n{ingestIfEligible(e){return Promise.resolve()}}},64:(e,t,i)=>{i.d(t,{CL:()=>p,D0:()=>r,ED:()=>o,EW:()=>d,MU:()=>f,PH:()=>l,UW:()=>m,Uy:()=>c,eV:()=>s,jH:()=>_,mL:()=>g,qr:()=>a,t2:()=>u});var n=i(5506);const r=(0,n.MU)("engagement_edge_only",!0),o=(0,n.MU)("segment_transition_edge_only",!0),s=(0,n.MU)("track_form_submission",!0),a=(0,n.MU)("track_link_click",!0),c=(0,n.MU)("track_pageview_complete",!0),u=(0,n.MU)("track_pageview_engagement",!0),l=((0,n.$S)("sync_segments_cookie",!1),(0,n.$S)("track_slot_clicked",!0)),p=(0,n.$S)("track_slot_rendered",!0),d=(0,n.$S)("track_slot_viewable",!1),_=(0,n.$S)("track_targeting_keys",!1),g=((0,n.p1)("revenue_insights_enabled",!1),(0,n.p1)("data_provider_config",{ac_bidders:[]}),"_psegs"),m=!0,f=6e5},274:(e,t,i)=>{i.d(t,{U:()=>n});const n={$ip_address:"$ip_address",$ip_address_hash:"$ip_address_hash",$ip_geo_info_city:"$ip_geo_info_city",$ip_geo_info_continent:"$ip_geo_info_continent",$ip_geo_info_country:"$ip_geo_info_country",$ip_geo_info_postal_code:"$ip_geo_info_postal_code",$ip_geo_info_province:"$ip_geo_info_province",$ip_isp_info_autonomous_system_organization:"$ip_isp_info_autonomous_system_organization",$ip_isp_info_isp:"$ip_isp_info_isp",$ip_isp_info_organization:"$ip_isp_info_organization"}},8764:(e,t,i)=>{i.d(t,{v:()=>o});class n{constructor(e,t,i,n,r,o,s){this.logger=e,this.permutive=t,this.id=i,this.segmentCode=n,this.triggerType=r,this.config=o,this.workspaceLevelConfig=s}getSegmentCode(){return this.segmentCode}getTriggerType(){return this.triggerType}getConfig(){return this.config}getWorkspaceLevelConfig(){return this.workspaceLevelConfig}trackImpression(e){return this.trackActivation("impression",e)}trackConversion(e){return this.trackActivation("conversion",e)}trackActivation(e,t){const i={reaction_id:this.id,type:e};this.permutive.track("Reaction",i,t),this.logger.log(i.type,i)}}var r=i(5506);class o{constructor(e,t,i){this.logger=e,this.permutive=t,this.clientContext=i,this.optimisedActivationsConfig={dfp:{dfp:[62400,52010,50563,47945,24996,24040,50438,49089,50432,50442,50443,50444,50445,50635,47749,47750,47751,47752,47753,50692,47755,50702,50712,47917,47918,50713,47919,47920,47921,47922,47923,47924,47925,47926,47929,47937,47930,47934,47931,47932,47933,47935,47936,47938,47939,47281,47282,47651,47652,47292,47654,48309,47862,49050,46274,49048,49052,47864,47865,47174,52096,52097,52388,51619,51645,52396,52397,52398,52461,52464,52465,52466,52483,66937,84411,84410,84409,84408,84407,84284,84406,47944,47943,83115,83512],dfp_legacy:{}},eyeota_pixel:[],dbm:{omitted:0},appnexus:{},appnexus_adserver:[],nativo:[],rubicon_ssp:[],smart:[]}}getSpecializedActivations(e){return this.optimisedActivationsConfig[e]}getActivations(e){return(0,r.Hn)(e)("activationConfigs",[]).filter((e=>this.areContextCriteriaSatisfied(e))).map((e=>new n(this.logger,this.permutive,e.id,e.sc,e.tt,e.c,e.wc)))}areContextCriteriaSatisfied(e){const t=e.cc,i=e=>{const t=this.clientContext.getContext()[e.key];switch(e.comparison){case"EQUALS":return t===e.value;case"NOT_EQUALS":return t!==e.value;case"CONTAINS":return"string"==typeof t&&t.indexOf(e.value)>=0;case"NOT_CONTAINS":return"string"==typeof t&&t.indexOf(e.value)<0}};return!t||("AND"===(n=t).operator?n.criteria.every(i):n.criteria.some(i));var n}}},5506:(e,t,i)=>{i.d(t,{$S:()=>s,Hn:()=>r,MU:()=>o,p1:()=>a});const n={standard_cohorts:{auto_init:!0,activationConfigs:[]},facebook_pixel_v2:{auto_init:!0,activationConfigs:[{id:"ab8c78d1-3765-4a8f-97d9-c741eb06a51a",tt:"EveryTime",sc:70364,c:{},wc:{}},{id:"cb42e647-bff6-45a5-8976-43fce8feaa30",tt:"EveryTime",sc:83115,c:{},wc:{}}]},overlays:{auto_init:!0,activationConfigs:[]},web:{auto_init:!1,add_alchemy_taxonomy:!1,add_alchemy_entities:!1,engagement_edge_only:!0,segment_transition_edge_only:!0,activationConfigs:[]},scriptrunner:{auto_init:!0,activationConfigs:[]},clean_room:{auto_init:!0,publisher_permissions:{"0c661761-e35e-436d-acdb-4ba2ec5fffd0":["allow_insights","allow_targeting_modelled_audiences","allow_custom_insights","allow_targeting_core_audiences","allow_targeting_known_audiences"]},activationConfigs:[]},dfp:{auto_init:!0,networks:[{network_code:"9885583",name:"Lonely Planet Global Inc [Operative]"}],track_slot_rendered:!1,track_slot_viewable:!0,track_slot_clicked:!0,track_targeting_keys:!1,activationConfigs:[]}},r=e=>{const t=n[e];return(e,i)=>{var n;return null!==(n=null==t?void 0:t[e])&&void 0!==n?n:i}},o=r("web"),s=r("dfp"),a=r("prebid");r("facebook_pixel_v2"),r("socio_demo_cohorts"),r("ctv")},427:(e,t,i)=>{i.d(t,{z:()=>r});var n=i(3629);class r extends class{constructor(e){this.context=e}getContext(){return this.context}updateContext(...e){e.forEach((([e,t])=>{this.context[e]=t}))}}{constructor(e){super(e)}getClient(){var e;const t=null!==(e=document.title)&&void 0!==e?e:"";return Promise.resolve({type:"web",user_agent:navigator.userAgent||"",url:(0,n.bk)(window.location.href),domain:window.location.hostname||"",title:t,referrer:(0,n.bk)(document.referrer)})}}},4572:(e,t,i)=>{i(6013)},449:(e,t,i)=>{i.d(t,{M:()=>h,m:()=>f});var n=i(655),r=i(2688),o=i(9320),s=i(8198),a=i(3735),c=i(6567),u=i(5151),l=i(7112),p=i(550),d=i(6013),_=i(5595);const g="permutive-events-cache",m="permutive-events-for-page",f="historical";class h{constructor(e,t,i,n,r,o,s){this.config=e,this.namespace=t,this.logger=i,this.network=n,this.trace=r,this.metrics=o,this.makeEventsStore=s,this.eventPutQueue=Promise.resolve(),this.eventsCache=this.makeEventsRepository(g),this.eventsForPage=this.makeEventsRepository(m),this.eventStore=s(),this.eventsTTLInMilliseconds=(0,a.zG)((0,c.ij)(this.config.eventsTTLInDays),(0,c.tS)((e=>"number"==typeof e&&e>0?(0,c.G)(24*e*3600):c.YP))),this.eventsCache.events=(0,d.PQ)((()=>{const e=this.trace.startSpan("load_event_cache");return this.loadFromDisk().then((t=>(e.finish(),this.logger.debug("Event cache loaded, #e",t.length),t)))})),this.readiness=this.eventsCache.events.then((()=>this.migratePreviousPagesEvents()))}migratePreviousPagesEvents(){return(0,n.mG)(this,void 0,void 0,(function*(){const e=this.trace.startSpan("migrate_previous_for_page_events"),t=(0,u.pE)((e=>(0,l.Y3)((()=>e.flush()),r.w)));return(0,a.zG)([this.eventsForPage,this.eventsCache],t,(0,u.UI)((t=>{const i=t.reduce(((e,t)=>(0,s.g_)((t=>[...e,t]),(()=>e))(t)),[]);return i.length>0&&this.network.error(`Migrate previous events failed. Got:\n${i.join("\n ")}`),e.finish()})),(e=>e()))}))}get eventsForCurrentPage(){return this.eventsForPage.events}all(){return Promise.all([this.eventsCache.events,this.eventsForPage.events]).then(o.xH)}resetIfNeeded(){return Promise.resolve(!1)}add(e,{persistOnDisk:t}){return(0,n.mG)(this,void 0,void 0,(function*(){this.logger.debug("Adding to cache",e);return(yield this.eventsForPage.events).push(e),t&&this.readiness.then((()=>this.eventsForPage.flush())),e}))}filterEventsByWorkspace(e){return e}pruneEventsToSizeLimit(e){const t=this.config.eventsCacheLimitBytes;let i=2*JSON.stringify(e).length,n=1;for(;i>t;)e.splice(0,n),n*=2,i=2*JSON.stringify(e).length;return{events:e,sizeInBytes:i}}loadFromDisk(){this.logger.log("Loading event cache...");const e=this.metrics.startTimer("sdk_load_events_cache_task_duration_seconds",{}),t=e=>{this.metrics.track({name:"sdk_events_cache_byte_total",value:e.sizeInBytes,labels:{}}),this.metrics.track({name:"sdk_events_cache_size_total",value:e.events.length,labels:{}})},i=(0,a.zG)(this.eventsTTLInMilliseconds,(0,c.g_)((0,a.a9)(a.yR),(e=>(0,o.hX)((t=>e>Date.now()-t.time.getTime()))))),r=(0,a.ls)((0,c.fS)((()=>[])),u.of),s=(0,l.g_)((e=>{const t=(0,u.of)([]);return e instanceof _.m?t:(this.network.error(`Error fetching data from store. Got ${e}`),()=>(0,n.mG)(this,void 0,void 0,(function*(){return yield this.reset("historical"),t()})))}),r);return(0,a.zG)([this.eventStore.get(g),this.eventStore.get(m)],(0,o.UI)(s),(0,o.vP)(u.oE),(0,u.UI)((t=>(this.logger.debug("Read events from store",t),this.metrics.stopTimer("sdk_load_events_cache_task_duration_seconds",e),t))),(0,u.UI)((0,a.ls)(o.xH,this.filterEventsByWorkspace,this.pruneEventsToSizeLimit.bind(this),(e=>(this.eventsCache.sizeInBytes=e.sizeInBytes,e.events.length>0&&t(e),e.events)),(0,o.UI)(p.kJ),i)),(e=>e()))}reset(e){return(0,n.mG)(this,void 0,void 0,(function*(){return this.logger.debug("Resetting Events Cache"),(0,a.zG)(this.eventStore.deleteStore(),(0,l.UI)((()=>(this.eventStore=this.makeEventsStore(),e===f?Promise.all([this.eventsCache.reset(),this.eventsForPage.flush()]):Promise.all([this.eventsCache.reset(),this.eventsForPage.reset()])))),(0,l.UI)((()=>this.all())),(0,l.g_)((()=>(0,u.of)([])),(e=>(0,a.a9)(e))),(e=>e()))}))}getStateSizeInBytes(){return this.eventsForPage.sizeInBytes+this.eventsCache.sizeInBytes}makeEventsRepository(e){const t={key:e,events:Promise.resolve([]),sizeInBytes:0,flush:()=>(0,n.mG)(this,void 0,void 0,(function*(){const e=yield t.events;this.logger.debug("Writing",e.length,"events to",t.key);const i=this.trace.startSpan(`write_${t.key}`),n=JSON.stringify(e);return t.sizeInBytes=2*n.length,this.eventPutQueue=this.eventPutQueue.then((n=>this.eventStore.put(e.map(p.XO),t.key)().then((e=>{if((0,s.nM)(e)){(e=>{const i=`Events cache failed to put ${t.key}. Got ${e}`;return e instanceof _.m?this.logger.error(i):this.network.error(i)})(e.left)}i.finish()}))))})),reset:()=>(t.events=Promise.resolve([]),t.sizeInBytes=0,t.flush())};return t}}},8231:(e,t,i)=>{i.d(t,{K:()=>L});class n{constructor(){this.crypto=window.crypto||window.msCrypto,this.ALG_NAME="AES-GCM"}isAvailable(){var e;return!!(null===(e=this.crypto)||void 0===e?void 0:e.subtle)}generateKey(e=!1){return this.crypto.subtle.generateKey({name:this.ALG_NAME,length:256},e,["encrypt","decrypt"])}encrypt(e,t){const[i,n]=this._encrypt(e,this.str2bytes(t));return i.then((e=>{const t=new Uint8Array(16+e.byteLength);return t.set(n,0),t.set(new Uint8Array(Uint32Array.of(e.byteLength).buffer),12),t.set(new Uint8Array(e),16),t.buffer}))}decrypt(e,t){const i=new Uint8Array(t,0,12),n=new Uint32Array(t,12,1)[0],r=t.slice(16,16+n);return this._decrypt(e,i,r).then(this.bytes2str)}_encrypt(e,t){const i=this.crypto.getRandomValues(new Uint8Array(12));return[this.crypto.subtle.encrypt({name:this.ALG_NAME,iv:i},e,t),i]}_decrypt(e,t,i){return this.crypto.subtle.decrypt({name:this.ALG_NAME,iv:t},e,i)}str2bytes(e){return(new TextEncoder).encode(e).buffer}bytes2str(e){return(new TextDecoder).decode(e)}}var r=i(2688),o=i(8198),s=i(6567),a=i(7112);var c=i(3735),u=i(2485),l=i(655);let p,d;const _=new WeakMap,g=new WeakMap,m=new WeakMap,f=new WeakMap,h=new WeakMap;let v={get(e,t,i){if(e instanceof IDBTransaction){if("done"===t)return g.get(e);if("objectStoreNames"===t)return e.objectStoreNames||m.get(e);if("store"===t)return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return b(e[t])},set:(e,t,i)=>(e[t]=i,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function y(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(d||(d=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(q(this),t),b(_.get(this))}:function(...t){return b(e.apply(q(this),t))}:function(t,...i){const n=e.call(q(this),t,...i);return m.set(n,t.sort?t.sort():[t]),b(n)}}function w(e){return"function"==typeof e?y(e):(e instanceof IDBTransaction&&function(e){if(g.has(e))return;const t=new Promise(((t,i)=>{const n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{t(),n()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)}));g.set(e,t)}(e),t=e,(p||(p=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,v):e);var t}function b(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,i)=>{const n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{t(b(e.result)),n()},o=()=>{i(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&_.set(t,e)})).catch((()=>{})),h.set(t,e),t}(e);if(f.has(e))return f.get(e);const t=w(e);return t!==e&&(f.set(e,t),h.set(t,e)),t}const q=e=>h.get(e);function k(e,t,{blocked:i,upgrade:n,blocking:r,terminated:o}={}){const s=indexedDB.open(e,t),a=b(s);return n&&s.addEventListener("upgradeneeded",(e=>{n(b(s.result),e.oldVersion,e.newVersion,b(s.transaction))})),i&&s.addEventListener("blocked",(()=>i())),a.then((e=>{o&&e.addEventListener("close",(()=>o())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}function E(e,{blocked:t}={}){const i=indexedDB.deleteDatabase(e);return t&&i.addEventListener("blocked",(()=>t())),b(i).then((()=>{}))}const P=["get","getKey","getAll","getAllKeys","count"],S=["put","add","delete","clear"],O=new Map;function D(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(O.get(t))return O.get(t);const i=t.replace(/FromIndex$/,""),n=t!==i,r=S.includes(i);if(!(i in(n?IDBIndex:IDBObjectStore).prototype)||!r&&!P.includes(i))return;const o=async function(e,...t){const o=this.transaction(e,r?"readwrite":"readonly");let s=o.store;return n&&(s=s.index(t.shift())),(await Promise.all([s[i](...t),r&&o.done]))[0]};return O.set(t,o),o}v=(e=>({...e,get:(t,i,n)=>D(t,i)||e.get(t,i,n),has:(t,i)=>!!D(t,i)||e.has(t,i)}))(v);var M=i(5151),I=i(6013);function x(e){return"development"===e.environment?window.isSecureContext:"https:"===window.location.protocol}class T{constructor(e,t,i,n,r,o,s){this.namespace=e,this.logger=t,this.cryptoAlg=i,this.idb=n,this.mainObjectStore=r,this.keyObjectStore=o,this.keyObjectKey=s,this.MAX_CONSECUTIVE_PUTS=30,this.puts=1,this.hasForcedCompaction=!1,this.logger.debug("IDB: Created",this.idb),this.cryptoKey=this.getOrGenerateKey()}static initialise(e,t,i,n,r,s,u,l,p,d){const _=(0,I.G6)(navigator.userAgent)&&!1,g=[x(e),r.isAvailable(),!_].every((e=>!0===e)),m=(e,t,i)=>t.includes(i)?(0,c.Q1)():e.createObjectStore(i),f=g?(0,o.Y3)((()=>function(e){if(!(0,I.G6)(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let t,i=0;return new Promise((e=>{const n=()=>(i++,indexedDB.databases().finally(e));t=window.setInterval(n,100),n()})).finally((()=>{clearInterval(t),e.track({name:"sdk_idb_conn_attempt_safari_count",value:i,labels:{}})}))}(i).then((()=>k(s,d,{upgrade:e=>{const t=[...e.objectStoreNames];m(e,t,u),m(e,t,l)}})))),(e=>String(e))):(0,o.t$)("Connection not attempted. Default to localStorage");return(0,o.g_)((e=>(0,a.t$)(e)),(e=>(0,a.Y3)((()=>e.then((e=>new T(t,n,r,e,u,l,p)))),(e=>String(e)))))(f)}put(e,t){return(0,l.mG)(this,void 0,void 0,(function*(){return(0,c.zG)((()=>(0,l.mG)(this,void 0,void 0,(function*(){return(0,c.bc)(JSON.stringify(e),yield this.cryptoKey)}))),(0,M.tS)((([e,t])=>(0,M.of)(this.cryptoAlg.encrypt(t,e)))),(0,M.tS)((e=>()=>(0,l.mG)(this,void 0,void 0,(function*(){return yield this.resetIfRequired(this.puts++),e})))),(0,M.tS)((e=>(0,a.Y3)((()=>this.idb.put(this.mainObjectStore,e,this.namespace.getNamespacedStorageKey(String(t)))),r.w))),(0,M.UI)((0,o.g_)((i=>{throw this.logger.error(`IDB: Failed to put "${t.toString()}" value`,e,". Got \n",i),"QuotaExceededError"===i.name&&this.forceCompaction(),i}),(()=>t))),(e=>e()))}))}get(e){return this.cryptoKey.then((t=>(0,c.zG)(this.namespace.getNamespacedStorageKey(String(e)),(i=>this.idb.get(this.mainObjectStore,i).then((e=>e?this.cryptoAlg.decrypt(t,e):null)).then(JSON.parse).catch((t=>{const i=(0,r.w)(t);throw this.logger.error(`IDB: Get ${e.toString()} failed. Got`,i),i}))))))}delete(e){return(0,c.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>this.idb.delete(this.mainObjectStore,e)))}deleteStore(){return this.logger.debug("IDB: Deleting",this.idb),this.idb.close(),E(this.idb.name)}getOrGenerateKey(){return(0,c.zG)(this.namespace.getNamespacedStorageKey(this.keyObjectKey),(e=>this.idb.get(this.keyObjectStore,e).then((e=>e||this.storeGivenOrGeneratedKey())).catch((e=>{const t=(0,r.w)(e);return this.logger.error("IDB: Get or generate key failed. Got\n",t),this.cryptoAlg.generateKey(!1)}))))}storeGivenOrGeneratedKey(e=this.cryptoAlg.generateKey(!1)){return(0,c.zG)((0,M.of)(this.namespace.getNamespacedStorageKey(this.keyObjectKey)),(0,M.tS)((t=>(0,a.Y3)((()=>(0,l.mG)(this,void 0,void 0,(function*(){return this.idb.put(this.keyObjectStore,yield e,t)}))),r.w))),(0,M.UI)((0,o.g_)((e=>{throw this.logger.error(`IDB: Failed to store crypto key to ${this.keyObjectStore} due to unexpected error,\n`,e),e}),(()=>e))),(e=>e()))}forceCompaction(){if(this.hasForcedCompaction)return null;this.hasForcedCompaction=!0,this.logger.debug("Attempting to force compaction");const e=`__${this.mainObjectStore}`;return k(e).then((t=>(t.close(),E(e))))}resetIfRequired(e){return(0,I.G6)(navigator.userAgent)&&e%this.MAX_CONSECUTIVE_PUTS==0?this.reset():Promise.resolve()}reset(){return(0,l.mG)(this,void 0,void 0,(function*(){const e=this.idb.name,t=this.idb.version;yield this.deleteStore(),this.idb=yield k(e,t),this.idb.createObjectStore(this.mainObjectStore),this.idb.createObjectStore(this.keyObjectStore),yield this.storeGivenOrGeneratedKey(this.cryptoKey),this.logger.debug("IDB: Reset to",this.idb)}))}}var A=i(3195),C=i(5595);class U{constructor(e,t,i,n,r,s,a,l,p,d){this.version=3,this.db=((e,t,i,n,r,o,s,a,l,p,d)=>(0,c.zG)(T,(0,u._)({logger:p,consentTracking:d})).initialise(e,t,i,p,n,r,o,s,a,l))(e,t,i,n,r,s,a,l,this.version,p,d)().then((0,o.fS)((e=>(0,A.S)(t,p,d))))}shouldThrowStoreClosingError(e){return"NotFoundError"===e.name||"InvalidStateError"===e.name}makeStoreClosingDuringOpertationError(e){return new C.m(`Attempted ${e} when the current store is closing.`)}put(e,t){return(0,a.Y3)((()=>this.db.then((i=>i.put(e,t)))),(e=>{const t=(0,r.w)(e);return this.shouldThrowStoreClosingError(t)?this.makeStoreClosingDuringOpertationError("put"):t}))}get(e){return(0,a.Y3)((()=>this.db.then((t=>t.get(e))).then(s.ij)),(e=>{const t=(0,r.w)(e);return this.shouldThrowStoreClosingError(t)?this.makeStoreClosingDuringOpertationError("get"):t}))}delete(e){return(0,a.Y3)((()=>this.db.then((t=>t.delete(e)))),(e=>String(e)))}deleteStore(){return(0,a.Y3)((()=>this.db.then((e=>e.deleteStore()))),(e=>String(e)))}}var j=i(449);class L extends j.M{constructor(e,t,i,r,o,s,a,c){super(e,t,i,r,o,s,(()=>new U(e,t,s,new n,"7c6db7ee-7cf2-4f9a-853a-78875d37e2bb",`events_${a.get()}`,`keys_${a.get()}`,"events",i,c)))}}},2923:(e,t,i)=>{i.d(t,{X:()=>n});class n{constructor(){this.properties={}}overrideCustomProps(e){this.properties=e}getCustomProps(){return this.properties}}},4314:(e,t,i)=>{i.d(t,{c:()=>a});var n=i(2688),r=i(3735),o=i(550),s=i(7545);class a{constructor(e,t,i,n,r,o){this.eventHandler=e,this.api=t,this.metrics=i,this.userId=n,this.network=r,this.eventsCache=o,this.DEBOUNCE_TIME=500,this.MAX_DEBOUNCE_TIME=5e3,this.batch={requestData:[],requestOptions:[],processingStrategies:[]},this.scheduler=new s.b(this.DEBOUNCE_TIME,this.MAX_DEBOUNCE_TIME),this.debouncedFlushIfNotEmpty=this.scheduler.schedule(this.flush.bind(this)),this.scheduler.scheduleForPageUnload((()=>this.flushWithBeacon.bind(this)(this.batch)))}add(e,t,i){return this.batch.requestData.push(e),this.batch.requestOptions.push(t),this.batch.processingStrategies.push(i),this.debouncedFlushIfNotEmpty(this.batch),Promise.resolve()}flush(e){return this.flushIfNotEmpty(e,!1)}flushWithBeacon(e){return this.flushIfNotEmpty(e,!0)}flushIfNotEmpty(e,t){const{requestData:i,requestOptions:o,processingStrategies:s}=e,a=e=>this.network.error(`Error sending events batch. Got ${(0,n.w)(e)}`,this.userId.get()),c=t?(0,r.ls)((e=>this.api.trackBatchBeacon(e)),(e=>Promise.resolve())):e=>this.api.trackBatch(this.metrics,e);return i.length>0?(0,r.zG)(this.resetBatch(),(e=>this.trackMetrics(i)),(e=>c(i).then((e=>this.isBatchResponse(e)?this.onBatchResponseSuccess(e,i,o,s):(0,r.Q1)())).catch(a))):Promise.resolve()}onBatchResponseSuccess(e,t,i,n){const s=(e,t)=>"never"!==t?(0,r.ls)((()=>this.eventHandler.newEvent((0,o.XO)(e),null)),(()=>this.eventsCache.add(e,{persistOnDisk:!0}))):r.Q1,a=(e,t,i)=>{const n={name:t.name,session_id:t.session_id,view_id:t.view_id,properties:t.properties,id:null,time:(new Date).toISOString()};return(0,r.zG)(i(e.error.message),(t=>console.error(e)),(t=>this.eventHandler.newEvent(n,e)))};return e.forEach((({body:e},c)=>{const u=t[c],l=i[c],p=n[c];return(0,o.bk)(e)?a(e,u,l.error):((e,t,i,n)=>{const a=(0,o.mh)(e,t);return(0,r.zG)(i(a),s(a,n))})(e,u,l.success,p)}))}resetBatch(){this.batch={requestData:[],requestOptions:[],processingStrategies:[]}}trackMetrics(e){this.metrics.track({name:"sdk_events_batch_size_total",value:e.length,labels:{}}),this.metrics.track({name:"sdk_events_batch_size_bytes",value:2*JSON.stringify(e).length,labels:{}})}isBatchResponse(e){return!!e}}},6515:(e,t,i)=>{i.d(t,{p:()=>o});var n=i(2899);const r="permutive-pvc";class o extends((0,n.h)(r)){constructor(e){super(e)}}},3937:(e,t,i)=>{i.d(t,{J:()=>r});var n=i(2899);class r extends((0,n.h)("permutive-unprocessed-pba")){constructor(e){super(e)}}},2899:(e,t,i)=>{i.d(t,{h:()=>a});var n=i(3735),r=i(6567),o=i(3195);const s=e=>t=>class extends t{constructor(){super(...arguments),this.key=e}put(e){return this.db.then((t=>t.put(e,this.key))).then(n.Q1)}getIfPresent(){return this.db.then((e=>e.get(this.key))).then(r.ij)}reset(){return this.db.then((e=>e.delete(this.key)))}},a=e=>(0,n.zG)(class{constructor(e){this.db=Promise.resolve((0,o.S)(e.namespace,e.logger,e.consentTracking))}},s(e))},9678:(e,t,i)=>{i.d(t,{LP:()=>o,dG:()=>n,eP:()=>r});const n=4096,r=`Cookie exceeds maximum supported size of ${n} bytes for most browsers.`,o="Cookie is missing required parameters."},9175:(e,t,i)=>{i.d(t,{S:()=>c});var n=i(3735),r=i(9678);class o{constructor(e,t,i){this.namespace=e,this.config=t,this.logger=i}setCookie(e,t,i=!1){var n;if(!(t&&e&&this.config.cookieExpiry&&this.config.cookieDomain)){const{cookieExpiry:i,cookieDomain:o}=null!==(n=this.config)&&void 0!==n?n:{};throw this.logger.warn(`Unable to set cookie. ${r.LP}`,{value:t,cookieName:e,cookieExpiry:i,cookieDomain:o}),new Error(r.LP)}const o=this.namespace.getNamespacedStorageKey(e),s=[encodeURIComponent(o),"=",encodeURIComponent(t),"; expires=",this.config.cookieExpiry,"; domain=",this.config.cookieDomain,"; path=/",i?"; samesite=none; secure":""].join("");if(s.length>r.dG)throw this.logger.warn(`Unable to set cookie ${o}. ${r.eP}`),new Error(r.eP);return this.logger.debug(`Setting cookie ${s}`),document.cookie=s,!0}getCookie(e,t=!1){const i=t?e:this.namespace.getNamespacedStorageKey(e),n=new RegExp("\\b"+encodeURIComponent(i)+"=([^;]+)").exec(document.cookie);return null!==n?decodeURIComponent(n[1]):null}deleteCookie(e){if(!e||!this.config.cookieDomain)return!1;const t=this.namespace.getNamespacedStorageKey(e);return document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; domain="+this.config.cookieDomain+"; path=/",!0}}var s=i(5097);const a=e=>{const{logger:t,consentTracking:i}=e,n=e=>(t.debug(`Cookie: Failed to set cookie ${e} as consent is revoked`),!1);return e=>class extends e{constructor(){super(...arguments),this.setCookie=(0,s.v)(super.setCookie.bind(this),n,i.isRevoked)}}},c=(e,t,i,r)=>new((0,n.zG)(o,a({consentTracking:r,logger:i})))(e,t,i)},3319:(e,t,i)=>{i.d(t,{S:()=>l});var n=i(3735),r=i(2688),o=i(787),s=i(8198);class a{constructor(e){this.namespace=e}getExternalData(e){const t=this.namespace.getNamespacedStorageKey(e);return window.localStorage.getItem(t)}getExternalJsonData(e){return(0,n.zG)(this.getExternalData(e),o.A)}setExternalData(e,t){const i=this.namespace.getNamespacedStorageKey(e);try{window.localStorage.setItem(i,t)}catch(e){}}setExternalJsonData(e,t){return(0,n.zG)((i=t,(0,s.Y3)((function(){var e=JSON.stringify(i);if("string"!=typeof e)throw new Error("Converting unsupported structure to JSON");return e}),n.yR)),(0,s.UI)((t=>this.setExternalData(e,t))),(0,s.g_)((e=>{throw(0,r.w)(e)}),n.Q1));var i}removeExternalData(e){const t=this.namespace.getNamespacedStorageKey(e);window.localStorage.removeItem(t)}}var c=i(5097);const u=e=>{const{logger:t,consentTracking:i}=e,n=e=>{t.debug(`External Data: Failed to set key ${e} as consent is revoked`)},r=n,o=n;return e=>class extends e{constructor(){super(...arguments),this.setExternalData=(0,c.v)(super.setExternalData.bind(this),r,i.isRevoked),this.setExternalJsonData=(0,c.v)(super.setExternalJsonData.bind(this),o,i.isRevoked)}}},l=(e,t,i)=>new((0,n.zG)(a,u({consentTracking:i,logger:t})))(e)},6715:(e,t,i)=>{i.d(t,{P:()=>n});class n{constructor(e,t,i,n,r,o,s,a,c=[],u={}){this.logger=e,this.network=t,this.userId=i,this.viewId=n,this.messages=r,this.sessionManager=o,this.cookies=s,this.externalData=a,this.blockers=c,this.addons=u,this.listenForBlockers=!0}makeSafe(e){return(...t)=>{try{return e(...t)}catch(e){this.network.error(e,this.userId.get())}}}utcNow(){const e=new Date;return new Date(e.toUTCString())}addBlocker(e){this.blockers.push(e),this.logger.log("<blockers> added blocker "+e),this.messages.on(e,(()=>{if(this.listenForBlockers){const t=this.blockers.indexOf(e);t>=0&&(this.blockers.splice(t,1),this.logger.log("<blockers> removed blocker "+e)),0===this.blockers.length&&(this.listenForBlockers=!1,this.messages.emit("permutive:blockers:empty"),this.logger.log("<blockers> complete"))}}))}}},4828:(e,t,i)=>{i.d(t,{SX:()=>o});class n{constructor(){this.prefix="[Permutive]",this.debugStyle=["color: blue"].join(";")}log(...e){return console.log.bind(window.console,this.prefix)(...e)}debug(...e){return console.debug.bind(window.console,"%c%s",this.debugStyle,this.prefix)(...e)}warn(...e){return console.warn.bind(window.console,this.prefix)(...e)}error(...e){return console.error.bind(window.console,this.prefix)(...e)}}class r{log(){}debug(){}warn(){}error(){}}const o=e=>{var t;return e.loggingEnabled&&void 0!==(null===(t=window.console)||void 0===t?void 0:t.log)?new n:new r}},8167:(e,t,i)=>{i.d(t,{Q:()=>n});class n{constructor(){this.messageListenerMap={},this.replayQueue={}}on(e,t,i={withReplay:!1}){var n,r;null!==(n=(r=this.messageListenerMap)[e])&&void 0!==n||(r[e]=[]),i.withReplay&&this.processReplayQueue(e,t),this.messageListenerMap[e].push(t)}once(e,t){const i=n=>{t(n),this.off(e,i)};this.on(e,i)}off(e,t){var i;if(!t)return this.messageListenerMap[e]=[],void(this.replayQueue[e]=[]);const n=(null!==(i=this.messageListenerMap[e])&&void 0!==i?i:[]).indexOf(t);n>=0&&this.messageListenerMap[e].splice(n,1)}emit(e,t,i={withReplay:!1}){var n;(null===(n=this.messageListenerMap[e])||void 0===n?void 0:n.length)>0?this.emitMessageWithPayload(e,t):i.withReplay&&this.addToReplayQueue(e,t)}addToReplayQueue(e,t){var i,n;null!==(i=(n=this.replayQueue)[e])&&void 0!==i||(n[e]=[]),this.replayQueue[e].push(t)}processReplayQueue(e,t){var i;null===(i=this.replayQueue[e])||void 0===i||i.forEach((e=>t(e)))}emitMessageWithPayload(e,t){var i;null===(i=this.messageListenerMap[e])||void 0===i||i.forEach((e=>e(t)))}}},7121:(e,t,i)=>{i.d(t,{AG:()=>a,UC:()=>o,Yh:()=>s});var n=i(6567),r=i(6013);const o=(e,t,i)=>e in t||(()=>{const t="number"==typeof e?e:parseInt(e);return!1===isNaN(t)&&i.has(t)})(),s=e=>(0,r.b0)(e,((e,t)=>t.state?(0,n.G)({[t.checksum]:t.state}):n.YP));function a(e){var t;return["SegmentEntry","SegmentExit"].includes(e.name)&&void 0!==(null===(t=e.properties)||void 0===t?void 0:t.segment_number)}},4938:(e,t,i)=>{i.d(t,{c:()=>ui,e:()=>ai});var n=i(7183),r=i(3735),o=i(477),s=i.n(o);function a(){return s()('/*! permutive-javascript-sdk v19.31.0 (web) (built 2022-10-07T13:53:03.574Z) */(()=>{"use strict";const e=()=>({kind:"null",value:null}),t=e=>({kind:"string",value:e}),n=e=>({kind:"number",value:e}),r=e=>({kind:"array",value:e}),i=e=>({kind:"object",value:e}),o=e=>e,a=()=>({kind:"bottom"}),c=e=>({kind:"inner",a:e}),p=e=>({kind:"top",error:e}),u=e=>({kind:"unbounded",group:e}),s=(e,t)=>({kind:"windowed",key:t,group:e}),l=(e,t,n)=>({kind:"countLimit",n,limit:t,group:e}),f=(e,t,n)=>({kind:"uniqueLimit",n,limit:t,group:e}),m=e=>({kind:"numberGroup",group:e}),_=e=>({kind:"stringGroup",group:e}),q=e=>({kind:"tuple",tuple:e}),d=e=>({state:e}),v=(e,t)=>({commands:e,payload:t});function g(e){return e}function w(e,t,n,r,i,o,a,c,p){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return o(i(r(n(t(e)))));case 7:return a(o(i(r(n(t(e))))));case 8:return c(a(o(i(r(n(t(e)))))));case 9:return p(c(a(o(i(r(n(t(e))))))));default:for(var u=arguments[0],s=1;s<arguments.length;s++)u=arguments[s](u);return u}}var y=function(e){return{equals:function(t,n){return t===n||e(t,n)}}},h=function(e){return y((function(t,n){for(var r in e)if(!e[r].equals(t[r],n[r]))return!1;return!0}))},b=function(e){return function(t,n){return t===n||0===e(t,n)}},x=function(e){return{equals:b(e),compare:function(t,n){return t===n?0:e(t,n)}}},k=function(e){return function(t){return x((function(n,r){return t.compare(e(n),e(r))}))}},S=function(e){return function(t,n){return-1===e.compare(t,n)}},E=function(e){return function(t,n){return 1===e.compare(t,n)}},A=function(e){return function(t,n){return t===n||e.compare(t,n)>-1?t:n}};var I={equals:function(e,t){return e===t}},P={equals:I.equals,compare:function(e,t){return e<t?-1:e>t?1:0}};const O=(e,t)=>{switch(e.kind){case"bottom":return{kind:"bottom"};case"inner":return c(t(e.a));case"top":return p(e.error)}},j=e=>x(((t,n)=>{if("bottom"===t.kind&&"bottom"===n.kind)return 0;if("bottom"===t.kind)return-1;if("bottom"===n.kind)return 1;if("top"===t.kind&&"top"===n.kind)return P.compare(t.error,n.error);if("top"===t.kind)return 1;if("top"===n.kind)return-1;if("inner"===t.kind&&"inner"===n.kind)return e.compare(t.a,n.a);throw new Error("Non exhaustive match in extendedAlgebraOrd")}));var Q=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},M=function(e){return"Some"===e._tag},T={_tag:"None"},z=function(e){return{_tag:"Some",value:e}},N=function(e){return"Left"===e._tag},L=(Object.prototype.hasOwnProperty,function(e){return Q([e[0]],e.slice(1))});var B=T,U=z;function C(e){return function(t){return e(t)?U(t):B}}var D=function(e){return"Left"===e._tag?B:U(e.right)},G=function(e){return{equals:function(t,n){return t===n||(V(t)?V(n):!V(n)&&e.equals(t.value,n.value))}}},R=function(e){return{equals:G(e).equals,compare:function(t,n){return t===n?0:Y(t)?Y(n)?e.compare(t.value,n.value):1:-1}}},K=function(e){return function(t){return V(t)?B:U(e(t.value))}},F=D,Y=M,V=function(e){return"None"===e._tag},$=function(e){return function(t){return V(t)?e():t.value}};var X;X=void 0;var J=function(e){return e[0]},W=J;var H=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},Z=function(e){return e.length>0},ee=function(e,t){return e<0||e>=t.length},te=function(e){return function(t){return H([e],t)}},ne=te,re=function(e){return function(t){return H(H([],t),[e])}},ie=re,oe=L,ae=function(e){return Z(e)?z(e):T},ce=function(e){return function(t){for(var n=Math.max(0,Math.floor(t)),r=[e(0)],i=1;i<n;i++)r.push(e(i));return r}};var pe=oe;var ue=function(e){return function(t){var n=Math.max(1,e);return n>=t.length?[pe(t),[]]:[w(t.slice(1,n),ne(le(t))),t.slice(n)]}},se=function(e){return y((function(t,n){return t.length===n.length&&t.every((function(t,r){return e.equals(t,n[r])}))}))},le=W;var fe={equals:function(e,t){return e===t}},me={equals:fe.equals,compare:function(e,t){return e<t?-1:e>t?1:0}};var _e=function(e,t){return function(n){for(var r=n.length,i=e,o=0;o<r;o++)i=t(o,i,n[o]);return i}};var qe=function(e){return 0===e.length},de=Z,ve=ne,ge=ie,we=function(e,t){return e<=0?[]:ce(t)(e)};var ye=ee,he=function(e){return function(t){return ye(e,t)?ke(t):t.slice(0,e)}};var be=function(e,t){for(var n=e.length,r=0;r<n&&t(e[r]);r++);return r};var xe=function(e){return function(t){return e<=0||qe(t)?ke(t):e>=t.length?[]:t.slice(e,t.length)}};var ke=function(e){return e.slice()},Se=function(e){return qe(e)?[]:e.slice().reverse()},Ee=function(e){return function(t){return t.length<=1?ke(t):t.slice().sort(e.compare)}},Ae=function(e,t,n){for(var r=[],i=Math.min(e.length,t.length),o=0;o<i;o++)r[o]=n(e[o],t[o]);return r};var Ie=function(e){return function(t){return e>=1&&de(t)?ue(e)(t):qe(t)?[ke(t),[]]:[[],ke(t)]}};var Pe=function(e){return function(t){return w(t,function(e){return function(t){for(var n=[],r=0;r<t.length;r++)n.push.apply(n,e(r,t[r]));return n}}((function(t,n){return e(n)})))}},Oe=function(e){return function(t){for(var n=[],r=0;r<t.length;r++){var i=e(r,t[r]);M(i)&&n.push(i.value)}return n}},je=function(e){return Oe((function(t,n){return e(n)}))},Qe=je(g),Me=_e,Te=function(e){var t=ze(e);return function(e){return t((function(t,n){return e(n)}))}},ze=function(e){return function(t){return Me(e.of([]),(function(n,r,i){return e.ap(e.map(r,(function(e){return function(t){return w(e,ge(t))}})),t(n,i))}))}},Ne=function(e){return x((function(t,n){for(var r=t.length,i=n.length,o=Math.min(r,i),a=0;a<o;a++){var c=e.compare(t[a],n[a]);if(0!==c)return c}return me.compare(r,i)}))},Le=function(e){return{_tag:"Left",left:e}},Be=function(e){return{_tag:"Right",right:e}},Ue=function(e,t){return w(e,Ge(t))},Ce=function(e,t){return w(e,Ke(t))},De="Either",Ge=function(e){return function(t){return Ye(t)?t:Be(e(t.right))}},Re=Be,Ke=function(e){return function(t){return Ye(t)?t:Ye(e)?e:Be(t.right(e.right))}},Fe={URI:De,map:Ue,ap:Ce,of:Re},Ye=N;var Ve=function(e){return-1===e?1:1===e?-1:0};function $e(e,t){return Qe(e.map(t))}function Xe(e,t,n,r){const i=(e,t)=>{if(0===e.length)return Qe(t.map((e=>U({1:e[1],2:n(B,U(e[2]))}))));if(0===t.length)return Qe(e.map((e=>U({1:e[1],2:n(U(e[2]),B)}))));if(e.length>0&&t.length>0&&S(r)(e[0][1],t[0][1])){const[r,...o]=e,a=r[1],c=r[2];return ve({1:a,2:n(U(c),B)})(i(o,t))}if(e.length>0&&t.length>0&&E(r)(e[0][1],t[0][1])){const[r,...o]=t,a=r[1],c=r[2];return ve({1:a,2:n(B,U(c))})(i(e,o))}if(e.length>0&&t.length>0){const[r,...o]=e,[a,...c]=t,p=r[1],u=r[2],s=a[2];return ve({1:p,2:n(U(u),U(s))})(i(o,c))}throw new Error("Non exhaustive match in mapOption2")},o=k((e=>e[1]))(r),a=(e=>{const t=$e(e,(e=>Y(e[2])?U({1:e[1],2:e[2].value}):B));return 0===t.length?B:U(t)})(i(Ee(o)([...e].map((e=>({1:e[0],2:e[1]})))),Ee(o)([...t].map((e=>({1:e[0],2:e[1]}))))));return K((e=>new Map(e.map((e=>[e[1],e[2]])))))(a)}function Je(e,t,n,r){const i=k((e=>e[0]))(r),o=Ee(i)([...t]).reduceRight(((e,t)=>{if(Ye(e)){const r=n(t[1],e.left);return Y(r)?Le(r.value):Be(t[0])}return e}),Le(e));return F(o)}function We(e,t){return new Map([...e].map(t))}function He(e,t){return new Map([...e].filter(t))}function Ze(e){return JSON.stringify(et(e))}function et(e){switch(e.kind){case"null":return rt.encode(e);case"string":return it.encode(e);case"number":return ot.encode(e);case"array":return at.encode(e);case"object":return ct.encode(e)}}function tt(e){return null===e?rt.decode(e):"number"==typeof e?ot.decode(e):"string"==typeof e?it.decode(e):Array.isArray(e)?at.decode(e):ct.decode(e)}const nt=(e,t)=>Le(`Failed to decode. Input was ${JSON.stringify(e)}. Codec type was ${t}`),rt={encode:e=>null,decode:e=>null===e?Be({kind:"null",value:null}):nt(e,"SimpleNull")},it={encode:e=>e.value,decode:e=>"string"==typeof e?Be(t(e)):nt(e,"SimpleString")},ot={encode:e=>e.value,decode:e=>"number"==typeof e?Be(n(e)):nt(e,"SimpleNumber")},at={encode:e=>e.value.map(et),decode:e=>{if(Array.isArray(e)){const t=Te(Fe)(tt)(e);return Ge(r)(t)}return nt(e,"SimpleArray")}},ct={encode:e=>{const t=[...e.value.entries()];return Object.assign({},...Array.from(t,(([e,t])=>({[e]:et(t)}))))},decode:e=>{if(e&&e.constructor===Object){const t=Te(Fe)((([e,t])=>w(tt(t),Ge((t=>function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}(e,t))))))(Object.entries(e));return Ge((e=>i(new Map([...e]))))(t)}return nt(e,"SimpleObject")}};function pt(e){return w(e,st,K(Ze),$((()=>"<encode error>")))}function ut(e){return K(dt)(function(e){switch(e.state.kind){case"top":return U(t(e.state.error));case"bottom":return B;case"inner":return st(e.state.a)}}(e))}function st(e){return function(e){switch(e.kind){case"numberGroup":case"stringGroup":return lt(e.group);case"tuple":return e.tuple.length>0}}(e.payload)?U(r(function(e,t){const n=K((e=>ve(e)(t)))(e);return $((()=>t))(n)}(K((e=>t(function(e){const t=e=>{switch(e){case"add":return"p";case"mul":return"m";case"max":return"v";case"min":return"n"}},n=e=>1===e[2]?t(e[1]):t(e[1])+JSON.stringify(e[2]);return e.map(n).join("")}(e))))(e.commands),function(e){const r=e=>{switch(e.kind){case"bottom":return{kind:"null",value:null};case"top":return t(e.error);case"inner":return n(e.a)}},o=e=>$e([ft,mt,e=>w(e,qt,i,U)],(t=>t(e))),a=e=>$e([ft,_t,e=>w(e,qt,(e=>We(e,(([e,t])=>[JSON.stringify(e),t]))),i,U)],(t=>t(e)));switch(e.kind){case"tuple":return e.tuple.map(r);case"stringGroup":return o(e.group);case"numberGroup":return a(e.group)}}(e.payload)))):B}function lt(e){switch(e.kind){case"unbounded":return e.group.size>0;case"windowed":return e.group.size>0||Y(e.key);case"countLimit":case"uniqueLimit":return e.group.size>0||Y(e.limit)}}function ft(e){switch(e.kind){case"unbounded":return B;case"windowed":return U(t("w"));case"countLimit":return U(t(1===e.n?"x":`x${e.n}`));case"uniqueLimit":return U(t(1===e.n?"u":`u${e.n}`))}}function mt(e){switch(e.kind){case"unbounded":return B;case"windowed":return U(t(Y(e.key)?e.key.value:""));case"countLimit":case"uniqueLimit":return U(t(Y(e.limit)?e.limit.value:""))}}function _t(e){switch(e.kind){case"unbounded":return B;case"windowed":return Y(e.key)?U(n(e.key.value)):U({kind:"null",value:null});case"countLimit":case"uniqueLimit":return Y(e.limit)?U(n(e.limit.value)):U({kind:"null",value:null})}}function qt(e){switch(e.kind){case"unbounded":case"windowed":case"countLimit":case"uniqueLimit":return e.group}}function dt(e){switch(e.kind){case"array":return 0===e.value.length?{kind:"null",value:null}:1===e.value.length?dt(e.value[0]):r(e.value.map(dt));case"object":return w(He(e.value,(([e,t])=>"null"!==t.kind)),(e=>We(e,(e=>[e[0],dt(e[1])]))),i);default:return e}}function vt(e){const t=e=>{if(0===e.length)return{kind:"bottom"};const t=(e=>{if(4!==e.length)return B;const[t,n,r,i]=e;if("string"===t.kind&&"string"===n.kind&&"object"===i.kind){const e=C((e=>gt(e[1].value)&&wt(e[2].value)))({1:t,2:n});return K((e=>({prim:e[1].value,grp:e[2].value,cutoff:r,m:i.value})))(e)}return B})(e);if(Y(t)){const{prim:e,grp:n,cutoff:r,m:i}=t.value,o=yt(r,i,ht(n));return"string"==typeof o?p(o):c(v(bt(e),o))}const n=(e=>{if(3!==e.length)return B;const[t,n,r]=e;if("string"===t.kind&&"object"===r.kind){const e=C((e=>wt(e.value)))(t);return K((e=>({grp:e.value,cutoff:n,m:r.value})))(e)}return B})(e);if(Y(n)){const{grp:e,cutoff:t,m:r}=n.value,i=yt(t,r,ht(e));return"string"==typeof i?p(i):c(v(B,i))}const r=(e=>{if(2!==e.length)return B;const[t,n]=e;if("string"===t.kind&&"object"===n.kind){const e=C((e=>gt(e.value)))(t);return K((e=>({prim:e.value,m:n.value})))(e)}return B})(e);if(Y(r)){const{prim:e,m:t}=r.value;return c(v(bt(e),_(u(t))))}const i=(e=>{if(1!==e.length)return B;const[t]=e;return"object"===t.kind?U({m:t.value}):B})(e);if(Y(i)){const{m:e}=i.value;return c(v(B,_(u(e))))}const o=(e=>{if(e.length<1)return B;const[t,...n]=e;if("string"===t.kind){const e=C((e=>gt(e.value)))(t);return K((e=>({prim:e.value,rest:n})))(e)}return B})(e);if(Y(o)){const{prim:e,rest:t}=o.value;return c(v(bt(e),kt(t)))}return c(v(B,kt(e)))},n=e=>"array"===e.kind?Pe(n)(e.value):[e];return"null"===e.kind?d({kind:"bottom"}):d(t(n(e)))}function gt(e){const t=e.split("");if(!0==(0===t.length))return!1;{const[e,...n]=t;return-1!=="pmvn".indexOf(e)&&n.every((e=>-1!=="pmvn0123456789".indexOf(e)))}}function wt(e){const t=e.split("");switch(!0){case 0===t.length:return!1;case"w"===t[0]&&void 0===t[1]:return!0;default:{const[e,...n]=t;return-1!=="ux".indexOf(e)&&-1===n.map((e=>!isNaN(parseInt(e)))).indexOf(!1)}}}function yt(e,t,n){switch(e.kind){case"string":return _(n({1:U(e.value),2:t}));case"number":case"null":return m(n({1:"null"===e.kind?B:U(e.value),2:He(We(t,(([e,t])=>[Number(e),t])),(e=>!isNaN(e[0])))}));default:return"{bad cutoff}"}}function ht(e){const t=e=>t=>f(t[2],t[1],e),n=e=>t=>l(t[2],t[1],e),r=e.split("");switch(!0){case"w"===r[0]&&void 0===r[1]:return e=>s(e[2],e[1]);case"u"===r[0]&&void 0===r[1]:return t(1);case"u"===r[0]&&void 0!==r[1]:return t(parseInt(r.slice(1).join("")));case"x"===r[0]&&void 0===r[1]:return n(1);case"x"===r[0]&&void 0!==r[1]:return n(parseInt(r.slice(1).join("")));default:throw new Error("This should never happen if you use isGroupCommand")}}function bt(e){return K(o)(ae(xt(e,(e=>{const t=e.split("");if(0===t.length)return B;const[n,...r]=t,i=(e=>{switch(e){case"p":return U("add");case"m":return U("mul");case"v":return U("max");case"n":return U("min");default:return B}})(n);return K((e=>{const{init:t,rest:n}=(i=e=>{return"number"==typeof(t=parseInt(e))&&isFinite(t)&&Math.floor(t)===t;var t},function(e){var t=Ie(be(e,i))(e);return{init:t[0],rest:t[1]}})(r);var i;return{1:{1:e,2:0===t.length?1:parseInt(t.join(""))},2:n.join("")}}))(i)}))))}function xt(e,t){const n=t(e);return $((()=>[]))(K((e=>[e[1]].concat(xt(e[2],t))))(n))}function kt(e){return q(e.map(St))}function St(e){switch(e.kind){case"number":return c(e.value);case"string":return p(e.value);case"null":return{kind:"bottom"};case"object":return p("{object}");case"array":return p("{array}")}}const Et={strategy:(e,t,n)=>r=>{if(V(n))return t;if("delta"===e&&V(t))return B;if(V(t))return n;if(Y(t)&&Y(n))return r(t.value,n.value);throw new Error("Non exhaustive match in combineCommand.strategy")},operation:(e,t,n,r,i,o)=>{const c=Ne(j(o));if("append"===e&&"add"===t)return Ae(n,r,Tt("append",i.plus));if("append"===e&&"mul"===t)return Ae(n,r,Tt("append",i.times));if("append"===e&&"max"===t)return A(c)(n,r);if("join"===e&&"add"===t)return Ae(n,r,Tt("join",A(o)));if("join"===e&&"mul"===t)return Ae(n,r,Tt("join",A(o)));if("join"===e&&"max"===t)return A(c)(n,r);if("min"===t)return Et.operation(e,"max",n,r,i,function(e){return x(((t,n)=>Ve(e.compare(t,n))))}(o));if("delta"===e&&"max"===t)return E(c)(n,r)?n:r.map(a);if("delta"===e)return Ae(n,r,((e,t)=>E(j(o))(e,t)?e:{kind:"bottom"}));throw new Error("Non exhaustive match in combineCommand.operation")},extend:(e,t,n,r)=>{if("delta"===e&&"top"===n.kind&&"top"===r.kind)return E(P)(n.error,r.error)?p(n.error):{kind:"bottom"};if("delta"===e&&"bottom"===r.kind)return n;if("delta"===e&&"bottom"===n.kind)return{kind:"bottom"};if("top"===n.kind&&"top"===r.kind)return p(A(P)(n.error,r.error));if("top"===n.kind)return n;if("top"===r.kind)return r;if("inner"===n.kind&&"inner"===r.kind)return t(n.a,r.a);if("bottom"===n.kind)return r;if("bottom"===r.kind)return n;throw new Error("Non exhaustive match in extend")}},At={plus:(e,t)=>e+t,times:(e,t)=>e*t};function It(e,t,n,r){if("unbounded"===e.kind&&"unbounded"===t.kind){const i=e.group,o=t.group;return $(a)(K((e=>c(u(e))))(Xe(i,o,n,r)))}if("windowed"===e.kind&&"windowed"===t.kind){const i=e.key,o=e.group,p=t.key,u=t.group,l=A(R(r))(i,p);return $(a)(K((e=>c(s(e,l))))(Xe(o,u,n,r)))}if("countLimit"===e.kind&&"countLimit"===t.kind){const i=e.n,o=t.n;if(i===o){const o=e.limit,p=e.group,u=t.limit,s=t.group,f=A(R(r))(o,u);return $(a)(K((e=>c(l(e,f,i))))(Xe(p,s,n,r)))}return p("Non matching counts")}if("uniqueLimit"===e.kind&&"uniqueLimit"===t.kind){const i=e.n,o=t.n;if(i===o){const o=e.limit,p=e.group,u=t.limit,s=t.group,l=A(R(r))(o,u);return $(a)(K((e=>c(f(e,l,i))))(Xe(p,s,n,r)))}return p("Non matching counts")}return p("Non matching group types")}function Pt(e,t,n,r,i,o){const c=(e,t)=>({1:he(e)(t).concat(we(Math.max(0,e-t.length),a)),2:xe(e)(t)}),p=(t,n,r)=>{if(0===t.length)return Et.operation(e,"max",n,r,i,o);if(t.length>0){const[a,...u]=t,s=c(a[2],n),l=s[1],f=s[2],m=c(a[2],r),_=m[1],q=m[2];return Et.operation(e,a[1],l,_,i,o).concat(p(u,f,q))}throw new Error("Non exhaustive match in recurse")};return Se((u=e=>"bottom"===e.kind,function(e){return e.slice(be(e,u))})(Se(p(t,n,r))));var u}function Ot(t,n,r){return $(e)(jt(t,B)(n,r))}function jt(e,t){const n=t=>(n,r)=>Et.strategy(e,n,r)(jt(e,t)),r=(r,i)=>{if(G(se(h({1:I,2:fe}))).equals(r.commands,i.commands)){const o=((t,r,i)=>{if("stringGroup"===r.kind&&"stringGroup"===i.kind){const e=It(r.group,i.group,n(t),P);return O(e,(e=>_(Mt(e,P))))}if("numberGroup"===r.kind&&"numberGroup"===i.kind){const e=It(r.group,i.group,n(t),me);return O(e,(e=>m(Mt(e,me))))}if("tuple"===r.kind&&"tuple"===i.kind){const n=Y(t)?t.value:[];return c(q(Pt(e,n,r.tuple,i.tuple,At,me)))}throw new Error(`Non matching payload. Got ${r.kind} and ${i.kind}`)})(V(r.commands)?t:r.commands,r.payload,i.payload);return O(o,(e=>v(r.commands,e)))}throw new Error(`Non matching primitive strings. Got ${pt(r)} and ${pt(i)}`)};return(t,n)=>ut(d(Et.extend(e,r,vt(t).state,vt(n).state)))}function Qt(e,t,n){const r=K((t=>He(e,(([e,r])=>{return(i=n,function(e,t){return-1!==i.compare(e,t)})(e,t);var i}))))(t);return $((()=>e))(r)}function Mt(e,t){switch(e.kind){case"unbounded":return e;case"windowed":return V(e.key)?e:s(Qt(e.group,e.key,t),e.key);case"countLimit":{const n=e.limit,r=e.n,i=e.group,o=(e,t)=>t<=1?B:U(t-1),a=Je(r,i,o,t),c=A(R(t))(n,a);return l(Qt(i,c,t),c,r)}case"uniqueLimit":{const n=e.limit,r=e.n,i=e.group,o=(e,t)=>{if("object"===e.kind){const n=[...e.value.keys(),...t.keys()],i=new Set(n);return i.size>=r?B:U(i)}return B},a=Je(new Set,i,o,t),c=A(R(t))(n,a);return f(Qt(i,c,t),c,r)}}}function Tt(e,t){return(n,r)=>Et.extend(e,((e,n)=>c(t(e,n))),n,r)}function zt(e,t){return Ot("append",e,t)}function Nt(e,t,n,r,i,o,a,c,p){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return o(i(r(n(t(e)))));case 7:return a(o(i(r(n(t(e))))));case 8:return c(a(o(i(r(n(t(e)))))));case 9:return p(c(a(o(i(r(n(t(e))))))));default:for(var u=arguments[0],s=1;s<arguments.length;s++)u=arguments[s](u);return u}}var Lt=function(e){return"Some"===e._tag},Bt={_tag:"None"},Ut=function(e){return{_tag:"Some",value:e}},Ct=function(e){return"Left"===e._tag},Dt=Object.prototype.hasOwnProperty;function Gt(e){return function(t,n){if(void 0===n){var r=Gt(e);return function(e){return r(t,e)}}for(var i,o=0;o<n.length;o++)if(i=n[o],e.equals(i,t))return!0;return!1}}var Rt=Gt;function Kt(e){var t=Rt(e);return function(n,r){if(void 0===r){var i=Kt(e);return function(e){return i(e,n)}}return n.filter((function(e){return!t(e,r)}))}}var Ft=Ct,Yt=function(e){return function(t){return Ft(t)?e(t.left):t.right}};var Vt=function(e){return function(t){return!e(t)}},$t=Bt,Xt=Ut;var Jt=Lt;var Wt={equals:function(e,t){return e===t}},Ht=function(e){for(var t in e)if(Dt.call(e,t))return!1;return!0};function Zt(e){return function(t){var n={},r=!1;for(var i in t)if(Dt.call(t,i)){var o=t[i];e(i,o)?n[i]=o:r=!0}return r?n:t}}var en=function(e){return Zt((function(t,n){return e(n)}))};var tn=Ht;var nn=en;nn(Vt(tn));function rn(...e){return e.reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})}Vt((function(e){return 0===e.length}));function on(e,t){const n=Object.keys(e),r=n.length,i={};for(let o=0;o<r;o++){const r=n[o],a=t(r,e[r]);Jt(a)&&(i[r]=a.value)}return i}function an(e){var t;return["SegmentEntry","SegmentExit"].includes(e.name)&&void 0!==(null===(t=e.properties)||void 0===t?void 0:t.segment_number)}const cn="process";let pn=!1,un=[],sn=!1;const ln={};let fn={getCurrentTime:()=>new Date,getCurrentSession:()=>"",getCurrentView:()=>"",getSegments:()=>({}),get1PSegments:()=>({}),get3PSegments:()=>({}),getSegmentsArray:()=>({}),getLookalikeModels:()=>({}),setSegmentActivation:()=>{}};const mn=e=>{const t=fn.get1PSegments(),n={"1p":Object.assign(Object.assign({},t["1p"]),e["1p"])};fn.get1PSegments=()=>n},_n=e=>{const t=Object.assign({},e);delete t["1p"],fn.get3PSegments=()=>t},qn=()=>{const e=hn.concat(fn.get1PSegments(),fn.get3PSegments()),t=yn(e);fn.getSegments=()=>e,fn.getSegmentsArray=()=>t};function dn(e,t,n,r,i,o,a){pn=!1,un=[],sn=!1;const c=yn(r.segments);fn={getCurrentTime:()=>new Date,getCurrentSession:()=>r.sessionId,getCurrentView:()=>r.viewId,get1PSegments:()=>r.segments,get3PSegments:()=>({}),getSegments:()=>hn.concat(fn.get1PSegments(),fn.get3PSegments()),getSegmentsArray:()=>c,getLookalikeModels:()=>r.lookalikeModels,setSegmentActivation:(e,t)=>{}};const p=on(t,((t,n)=>{var r;return(null===(r=e[t])||void 0===r?void 0:r.checksum)===n?$t:Xt(((e,t)=>{const n=o[e].interpret(null,fn);return Object.assign({checksum:t},!1===n.result?{}:{result:n})})(t,n))}));if(0===i.length)return{diff:Object.assign(Object.assign({},e),p),errors:[]};if(0===Object.keys(p).length)return{diff:e,errors:[]};{const r=vn(p,t,n,i,"bootstrap",o,a);return{diff:Object.assign(Object.assign({},e),r.diff),errors:r.errors}}}function vn(e,t,n,r,i,o,a){let c={diff:{},errors:[]};const p=r.length,u=()=>r.filter((e=>{return t=a["!UpdateLookalikeModels"]||[],an(n=e)&&t.includes(n.properties.segment_number.toString());var t,n})).length===r.length?"lookalikeTransition":"transition",s=(e,t,n)=>"transition"===e?n===t-1?u():"event":e;for(let u=0;u<p;u++){const l=r[u],f=s(i,p,u),m=gn(Object.assign(Object.assign({},e),c.diff),t,n,l,f,o,a);c={diff:Object.assign(Object.assign({},c.diff),m.diff),errors:c.errors.concat(m.errors)}}return c}function gn(t,n,r,i,o,a,c){"bootstrap"!==o&&(fn.setSegmentActivation=wn(t,n));const p=e,u=(e,t)=>{const n=a[e],o=n.lift(i,fn),c=Nt(tt(t.state||null),Yt(p)),u=Nt(tt(o),Yt(p),(e=>zt(c,e))),s=r[e],l=s?Nt(tt(s),Yt(p),(e=>zt(u,e))):u,f=et(u),m=n.interpret(et(l),fn),_=t.activations||{};return Object.assign(Object.assign(Object.assign({checksum:t.checksum},null===f?{}:{state:f}),!1===m.result?{}:{result:m}),0===Object.keys(_).length?{}:{activations:_})},s=[],l={},f=function(e,t,n,r,i){switch(e){case"event":const e=(null==i?void 0:i[r.name])||[];if(pn)return e;{un.push(r);const t=[...i["!UpdateSecondPartyData"]||[],...i["!UpdateThirdPartyData"]||[]];return Kt(Wt)(e,t)}case"lookalikeTransition":return(null==i?void 0:i[r.name])||[];case"transition":const o=(null==i?void 0:i[r.name])||[];if(sn){const e=i["!UpdateLookalikeModels"]||[];return o.concat(e)}return o;case"bootstrap":const a=((null==i?void 0:i[r.name])||[]).filter((e=>void 0!==t[e]));return Kt(Wt)(a,[...pn?[]:(i["!UpdateSecondPartyData"]||[]).concat(i["!UpdateThirdPartyData"]||[]),...sn?[]:i["!UpdateLookalikeModels"]||[]]);case"updateExternalState":return Object.keys(n);case"updateEnvironment":return[...i["!UpdateLookalikeModels"]||[],...i["!UpdateSecondPartyData"]||[],...i["!UpdateThirdPartyData"]||[]];case"updateLAL":return i["!UpdateLookalikeModels"]||[];case"updateTPD":return[...i["!UpdateSecondPartyData"]||[],...i["!UpdateThirdPartyData"]||[]]}}(o,t,r,i,c),m=f.length;!function(e){an(e)&&(mn({"1p":{[e.properties.segment_number]:"SegmentEntry"===e.name}}),qn())}(i);for(let e=0;e<m;e++){const r=f[e],i=t[r]||{checksum:n[r]};let o=i;try{o=u(r,i)}catch(e){s.push(`Failed to interpret query ${r}. Got ${e}`)}l[r]=o}return{diff:l,errors:s}}function wn(e,t){return(n,r,i)=>{if(!(i in e)){const n=t[i];if(void 0===n)throw new Error("Checksum not in internalStateMap");e[i]={checksum:n}}"activations"in e[i]||(e[i].activations={});n in e[i].activations||(e[i].activations[n]=[]),e[i].activations[n]=[...e[i].activations[n],r]}}function yn(e){return Object.keys(e).reduce(((t,n)=>{const r=Object.keys(e[n]),i=[];return r.forEach((t=>{!0===e[n][t]&&i.push(t)})),t[n]=i,t}),{})}const hn={empty:{},concat:(e,t)=>{const n=Object.assign({},e);for(const[e,r]of Object.entries(t))n[e]?n[e]=rn(n[e],r):n[e]=r;return n}};const bn=(e,t)=>{if("noop"===e.type)return{diff:{},errors:[]};const n=(e,...n)=>[e.stateMap,...e.payload,...n,t.rawQueries,t.queriesByEvent];return"bootstrap"===e.type?dn(...n(e)):"updateEnvironment"===e.type?function(e,t,n,r,i,o){return r.segments&&(mn(r.segments),_n(r.segments),qn(),fn.setSegmentActivation=wn(e,t)),r.lookalikeModels&&(sn=!0),r.segments&&(e=>{const t=Object.keys(e).length,n="1p"in e;return n&&t>1||!n&&t>0})(r.segments)&&(pn=!0),fn=Object.assign(Object.assign(Object.assign(Object.assign({},fn),r.viewId?{getCurrentView:()=>r.viewId}:{}),r.sessionId?{getCurrentSession:()=>r.sessionId}:{}),r.lookalikeModels?{getLookalikeModels:()=>r.lookalikeModels}:{}),vn(e,t,n,un.length>0?un:[ln],"updateEnvironment",i,o)}(...n(e)):"updateLAL"===e.type?function(e,t,n,r,i,o){return fn.getLookalikeModels=()=>r,sn=!0,gn(e,t,n,ln,"updateLAL",i,o)}(...n(e)):"updateTPD"===e.type?function(e,t,n,r,i,o){_n(r),qn(),fn.setSegmentActivation=wn(e,t),pn=!0;const a=vn(e,t,n,un.length>0?un:[ln],"updateTPD",i,o);return un=[],a}(...n(e)):"updateExternalState"===e.type?function(e,t,n,r,i){return gn(e,t,n,ln,"updateExternalState",r,i)}(...n(e)):e.type===cn?vn(...n(e,"event")):"processTransitions"===e.type?function(e,t,n,r,i,o){return vn(e,t,n,r,"transition",i,o)}(...n(e)):void 0};const xn=function(){var e=this&&this.__assign||function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},e.apply(this,arguments)},t=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},i=function(){function i(e){return"number"==typeof e?o[e]:e}function s(e){return"number"==typeof e?a[e]:e}function l(e){return"number"==typeof e?c[e]:e}function f(e){switch(e.length){case 0:return null;case 1:return e[0];default:return e}}function m(e,t,n){void 0===n&&(n=d);var r=l(t).reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e);return null===r?null:n(r)}function _(e,t){var n=l(t).slice();return n.unshift(e),n}function q(e,t,n){return void 0===n&&(n=d),m(e,_("properties",t),n)}var d=function(e){return e},v=function(e){return!0};function g(e,t){return function(n){for(var r=0;r<e.length;r++){if((e[r](n)||!1)===t)return t}return!t}}var w=function(e){return function(t){return!e(t)}},y=function(e,t){return function(n){return n>=e&&n<=t}},h=function(e){return new Date(e).getTime()},b=function(e){return m(e,["time"],h)},x=function(e,t){return m(t,e,h)},k=function(e,t,n,r,i,o){return function(a){var c=m(a,e,(function(e){return e.filter(r).map((function(e){return m(e,t)})).reduce(i,o)}));return n(null===c?o:c)}};function S(e,n,r,i){var o,a;try{for(var c=t(e),p=c.next();!p.done;p=c.next()){var u=p.value;if(r(u)&&n(u)===i)return i}}catch(e){o={error:e}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return!i}var E=function(e){return function(t){return("string"==typeof e||"number"==typeof e)&&"string"==typeof t&&t.toLowerCase().indexOf(s(e).toLowerCase())>-1}},A=function(e){return function(t){return null!=t&&Array.isArray(t)&&t.indexOf(e)>=0}};function I(e,t,n,r,i){var o=m(e.getSegments(),[t,n])||!1;return i&&(r||o)&&e.setSegmentActivation(t,n,i),o}function P(e,t,n){return m(e.getSegments(),[t,n])||!1}function O(e,t,r){return void 0===r&&(r=18e5),function(i){return{a:{m:function(e,t){return[t[0],i.a.m(null!=e[0]&&e[0][0]===t[0][0]?e[1]:i.a.z,t[1])]},z:[[],i.a.z]},p:function(n,r){return[[e(n)],m(r,t)===e(n)?i.p(n,r):i.a.z]},r:function(t,n){return i.r(t,n[0]!=[]&&n[0][0]===e(t)?n[1]:i.a.z)},d:i.d.sq||{l:function(o,a){var c=m(o,t),p=e(a);if(c!==p)return null;var u=i.d.l(o,a);if(!(Array.isArray(u)&&u.length>1))return null;var s=n(u),l=s[0],f=s.slice(1),_=+(b(o)||a.getCurrentTime()),q=Math.floor(_/r),d={};return d[q]={},d[q][p]=1===f.length?f[0]:f,[l,"u",null,d]},i:function(t,n){if(!Array.isArray(t)||"object"!=typeof t[3])return[[],i.a.z];var r=e(n),o=t[3];return[[r],Object.keys(o).map((function(e){return o[e][r]})).filter((function(e){return e})).map((function(e){return i.d.i([t[0]].concat(e))})).reduce(i.a.m,i.a.z)]}}}}}var j=O((function(e){return e.getCurrentSession()}),["session_id"],18e5),Q=O((function(e){return e.getCurrentView()}),["view_id"],3e5);function M(e,t,o,a){return void 0===a&&(a=1),{a:{m:function(e,t){return e.concat(t).slice(-o)},z:[]},p:function(n,r){return m(r,["name"])===i(t)?[e.p(n,r)]:[]},r:function(t,n){return e.r(t,n.reduce((function(t,n){return e.a.m(t,n)}),e.a.z))},d:e.d.ftn||{l:function(t,n){var r,i=e.d.l(t,n),c=m(t,["time"],h)*a;return i&&[i[0],"x"+o,null,(r={},r[c]=2==i.length?i[1]:i.slice(1),r)]},i:function(t,i){return t?Object.keys(t[3]||{}).sort().reverse().map((function(e){return Array.isArray(e)?r([t[0]],n(t[3][e]),!1):[t[0],t[3][e]]})).map((function(t){return e.d.i(t,i)})):[]}}}}var T=function(e,t){return null===e?null==t?null:{b:t}:null==t?{a:e}:{a:e,b:t}},z=function(e,t){return e&&t?e(t):null},N=function(e,t,n){if(n&&n.result&&Array.isArray(n.result)){var r=z(e.d&&e.d.m,{result:n.result[0]}),i=z(t.d&&t.d.m,{result:n.result[1]});return T(r,i)}return null};function L(e,t){var n=p[e];if(!t||!n)return!1;if(!n.length)return!0;for(var r=0,i=!1,o=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);if(r>=55296&&r<=56319){var i=e.charCodeAt(n+1);if(i>=56320&&i<=57343){t.push(e.slice(n,n+2)),++n;continue}}t.push(e.charAt(n))}return t}(t.toLowerCase()),a=0;a<o.length;a++){for(var c=o[a];r>0&&!n[r][c];)r=n[r].su?n[r].su:0;if(n[r][c]&&(i=!!n[r=n[r][c]].te))break}return i}return{q:function(e){return{lift:function(t,n){return e.d.l(t,n)},interpret:function(t,n){return function(t,n){return{result:e.r(t,n)}}(n,e.d.i(t,n))},migrate:function(t){return t&&e.d.m?e.d.m(t):null},m:e.a.m,z:e.a.z,p:e.p,r:e.r,i:e.d.i}},a:function(e){return g(e,!1)},acq:function(e,t){return{p:function(n,r){return[e.p(n,r),t.p(n,r)]},r:function(n,r){return e.r(n,r[0])&&t.r(n,r[1])},a:{z:[e.a.z,t.a.z],m:function(n,r){return[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]}},d:{l:function(n,r){return T(e.d.l(n,r),t.d.l(n,r))},i:function(n,r){return n?[e.d.i(n.a||null,r),t.d.i(n.b||null,r)]:[e.a.z,t.a.z]},m:function(n){return N(e,t,n)}}}},acs:L,acs_:function(e,t){return function(n){return L(t,m(n,e))}},af_i:function(e,t,n){return void 0===n&&(n=v),function(r){return m(r,e,(function(e){return S(e,t,n,!1)}))&&!0}},af_l:function(e,t,n){return void 0===n&&(n=v),function(r){var i=m(r,e,(function(e){return e.filter(n).length}));return t(null===i?0:i)}},af_m:function(e,t,n,r){return void 0===r&&(r=v),function(i){var o=m(i,e,(function(e){return e.filter(r)}));return null===o||0===o.length?n(0):n(o.map((function(e){return m(e,t)})).reduce((function(e,t){return e+t}),0)/o.length)}},af_n:function(e,t,n,r){return void 0===r&&(r=v),k(e,t,n,r,(function(e,t){return Math.min(e,t)}),Number.POSITIVE_INFINITY)},af_p:function(e,t,n,r){return void 0===r&&(r=v),k(e,t,n,r,(function(e,t){return e*t}),1)},af_s:function(e,t,n,r){return void 0===r&&(r=v),k(e,t,n,r,(function(e,t){return e+t}),0)},af_u:function(e,t,n){return void 0===n&&(n=v),function(r){return m(r,e,(function(e){return S(e,t,n,!0)}))||!1}},af_x:function(e,t,n,r){return void 0===r&&(r=v),k(e,t,n,r,(function(e,t){return Math.max(e,t)}),Number.NEGATIVE_INFINITY)},as:function(e,t,n){var r=_("properties",t);return function(t){for(var i=m(t,r),o=n.length,a=!0,c=0;c<o;c++){var p=n[c];if(!(a=e(p)(i)))break}return a}},c:A,c_:function(e,t){return function(n){return A(t)(m(n,e))}},cl_:function(e,t){return function(n){return A(s(t))(m(n,e))}},cx:function(e){return function(t){return A(s(e))(t)}},ctu:function(e,t,n,r){return{a:r?{m:function(e,t){return e.filter((function(e){return-1===t.indexOf(e)})).concat(t).slice(-r)},z:[]}:{m:function(e,t){return e.filter((function(e){return-1===t.indexOf(e)})).concat(t)},z:[]},p:function(r,o){return m(o,["name"])===i(e)&&t(o)?m(o,n):[]},r:function(e,t){return t},d:{l:function(){return null},i:function(){return[]}}}},ctv:function(t,n,r,o){function a(e,t){var n,r=function(e){return{k:e.k,c:1+e.c}},i={arr:[],add:{k:t,c:1}};return t?(n=e.reduce((function(e,t){return e.add.k===t.k?{arr:e.arr,add:r(t)}:{arr:e.arr.concat(t),add:e.add}}),i)).arr.concat(n.add):e}return{a:o?{m:function(e,t){return a(e,t).slice(-o)},z:[]}:{m:function(e,t){return a(e,t)},z:[]},p:function(e,o){return m(o,["name"])===i(t)&&n(o)?m(o,r):null},r:function(t,n){return n.reduce((function(t,n){var r;return e(e({},t),((r={})[n.k]=n.c,r))}),{})},d:{l:function(e){return null},i:function(e){return[]}}}},ctw:function(e,t,n,r){return{a:r?{m:function(e,t){return e.concat(t).slice(-r)},z:[]}:{m:function(e,t){return e.concat(t)},z:[]},p:function(r,o){return m(o,["name"])===i(e)&&t(o)?m(o,n):[]},r:function(e,t){return t},d:{l:function(){return null},i:function(){return[]}}}},cw:function(e,t,n){return void 0===n&&(n=d),{a:{m:function(e,t){return e+t},z:0},p:function(n,r){return m(r,["name"])===i(e)&&t(r)?1:0},r:function(e,t){return n(t)},d:{l:function(n){return m(n,["name"])===i(e)&&t(n)?["p",1]:null},i:function(e){return e?Array.isArray(e)?e.slice(-1)[0]:e:0},m:function(e){return e&&e.result?["p",e.result]:null}}}},e:function(e){return function(t){return t===e}},e_:function(e,t){return function(n){return m(n,e)===t}},fm:function(e,t){return{p:t.p,r:function(n,r){return e(t.r(n,r))},a:t.a,d:t.d}},ftn:function(e,t,n){return{a:{m:function(e,t){return e.concat(t.slice(0,n-e.length))},z:[]},p:function(n,r){return m(r,["name"])===i(t)?[e.p(n,r)]:[]},r:function(t,n){return e.r(t,n.reduce((function(t,n){return e.a.m(t,n)}),e.a.z))},d:M(e,t,n,-1).d}},fw:function(e,t,n,r){return void 0===r&&(r=d),{a:{m:function(e,t){return null===e?t:e},z:null},p:function(r,o){return m(o,["name"])===i(e)&&t(o)?m(o,n):null},r:function(e,t){return t},d:{l:function(n){return m(n,["name"])===i(e)&&t(n)?["p",1]:null},i:function(e){return e?Array.isArray(e)?e.slice(-1)[0]:e:0},m:function(e){return e&&e.result?["p",e.result]:null}}}},g:function(e){return function(t){return t>e}},g_:function(e,t){return function(n){return m(n,e)>t}},gb:function(e,t,n){return{a:{m:function(n,r){var i=Object.keys(n).concat(Object.keys(r)).filter((function(e,t,n){return n.indexOf(e)===t})).sort((function(e,t){return Math.max(m(n,[t,1]),m(r,[t,1]))-Math.max(m(n,[e,1]),m(r,[e,1]))})).slice(0,t).reduce((function(t,i){var o=e.a.m(m(n,[i,0])||e.a.z,m(r,[i,0])||e.a.z);return t[i]=[o,Math.max(m(n,[i,1]),m(r,[i,1]))],t}),{});return i},z:{}},p:function(t,r){var i,o,a=m(r,_("properties",n)),c=e.p(t,r);return null==a||(null==(o=c)||"object"==typeof o&&0===Object.keys(o).length||o===e.a.z)?{}:((i={})[a]=[c,m(r,["time"],h)],i)},r:function(t,n){var r={};return Object.keys(n).forEach((function(i){return r[i]=e.r(t,n[i][0])})),r},d:{l:function(){return null},i:function(){return{}}}}},ge:function(e){return function(t){return t>=e}},ge_:function(e,t){return function(n){return m(n,e)>=t}},i_:d,ifp:function(e){return{a:{m:function(e,t){return t},z:null},p:function(e){return null},r:function(t,n){return function(t){return P(t,"1p",e)}(t)},d:{l:function(e,t){return null},i:function(e){return null}}}},isp:function(e,t,n,r){return{a:{m:function(e,t){return t},z:!1},p:function(n,r){return P(n,e,t)},r:function(i,o){return I(i,e,t,n,r)},d:{l:function(e,t){return null},i:function(e){return Array.isArray(e)&&(!!+e[2]||!1)}}}},itp:function(e,t,n,r){return{a:{m:function(e,t){return t},z:!1},p:function(n,r){return P(n,e,t)},r:function(i,o){return I(i,e,t,n,r)},d:{l:function(e,t){return null},i:function(e){return Array.isArray(e)&&(!!+e[2]||!1)}}}},k:m,l:function(e){return function(t){return t<e}},l_:function(e,t){return function(n){var r=m(n,e);return null!==r&&r<t}},le:function(e){return function(t){return t<=e}},le_:function(e,t){return function(n){var r=m(n,e);return null!==r&&r<=t}},lm:function(e,t){var n=function(t){return function(e,t,n){var r,i=e||{},o=t[n]||{},a=(o["1p"]||{}).const||0;return Object.keys(i).forEach((function(e){i[e].forEach((function(t){var n=(o[e]||{})[t]||0;a+=n}))})),r=a,1/(1+Math.pow(Math.E,-r))}(t.getSegmentsArray(),t.getLookalikeModels(),e)};return{a:{m:function(e,t){return t},z:null},p:function(e){return null},r:function(e,r){return t(n(e))},d:{l:function(e,t){return null},i:function(e){return null}}}},ltn:M,mnw:function(e,t,n,r){void 0===r&&(r=d);var o=Number.POSITIVE_INFINITY;return{a:{m:function(e,t){return e<t?e:t},z:o},p:function(r,a){return m(a,["name"])===i(e)&&t(a)?m(a,n):o},r:function(e,t){return r(t)},d:{l:function(r){return m(r,["name"])===i(e)&&t(r)?["n",m(r,n)]:null},i:function(e){return e?Array.isArray(e)?e.slice(-1)[0]:e:o}}}},mxw:function(e,t,n,r){void 0===r&&(r=d);var o=Number.NEGATIVE_INFINITY;return{a:{m:function(e,t){return e>t?e:t},z:o},p:function(r,a){return m(a,["name"])===i(e)&&t(a)?m(a,n):o},r:function(e,t){return r(t)},d:{l:function(r){return m(r,["name"])===i(e)&&t(r)?["v",m(r,n)]:null},i:function(e){return e?Array.isArray(e)?e.slice(-1)[0]:e:o}}}},n0:w(d),n:function(e){return function(t){return t!==e}},nt:w,n_:function(e,t){return function(n){return m(n,e)!==t}},o:function(e){return g(e,!0)},ocq:function(e,t){return{p:function(n,r){return[e.p(n,r),t.p(n,r)]},r:function(n,r){return e.r(n,r[0])||t.r(n,r[1])},a:{z:[e.a.z,t.a.z],m:function(n,r){return[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]}},d:{l:function(n,r){return T(e.d.l(n,r),t.d.l(n,r))},i:function(n,r){return n?[e.d.i(n.a||null,r),t.d.i(n.b||null,r)]:[e.a.z,t.a.z]},m:function(n){return N(e,t,n)}}}},oe:function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r},os:function(e,t,n){var r=_("properties",t);return function(t){for(var i=m(t,r),o=n.length,a=!1,c=0;c<o;c++){var p=n[c];if(a=e(p)(i))break}return a}},pacs:function(e,t){return function(n){return L(t,q(n,e))}},pb:function(e,t,n){return function(r){return y(t,n)(q(r,e))}},pc:function(e,t){return function(n){var r=q(n,e);return null!=r&&Array.isArray(r)&&r.indexOf(t)>=0}},pc_:function(e,t){return function(n){var r=q(n,e),i=s(t);return null!=r&&Array.isArray(r)&&r.indexOf(i)>=0}},pe:function(e,t){return function(n){return q(n,e)===t}},pg:function(e,t){return function(n){return q(n,e)>t}},pge:function(e,t){return function(n){return q(n,e)>=t}},pl:function(e,t){return function(n){var r=q(n,e);return null!==r&&r<t}},ple:function(e,t){return function(n){var r=q(n,e);return null!==r&&r<=t}},pn:function(e,t){return function(n){return q(n,e)!==t}},ps:function(e,t){return function(n){return E(t)(q(n,e))}},pw:function(e,t,n,r){return void 0===r&&(r=d),{a:{m:function(e,t){return e*t},z:1},p:function(r,o){return m(o,["name"])===i(e)&&t(o)?m(o,n):1},r:function(e,t){return r(t)},d:{l:function(r){return m(r,["name"])===i(e)&&t(r)?(o=m(r,n))>=1?["m2p",o]:o>0?["m2p",null,1/o]:0==o?["m2p",0]:o>-1?["m2p",null,1/o,1]:["m2p",o,null,1]:null;var o},i:function(e){return e?Array.isArray(e)?0===(t=e.slice(1))[0]?0:Math.pow(-1,t[2]||0)*(t[0]||1)/(t[1]||1):e:1;var t}}}},ref:function(e){return function(t){return u[e](t)}},s:E,s_:function(e,t){return function(n){return E(t)(m(n,e))}},scq:function(e,t,n){return void 0===n&&(n=d),{p:function(n,r){return[e.p(n,r),t.p(n,r)]},r:function(r,i){return n(e.r(r,i[0])+t.r(r,i[1]))},a:{z:[e.a.z,t.a.z],m:function(n,r){return[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]}},d:{l:function(n,r){return T(e.d.l(n,r),t.d.l(n,r))},i:function(n,r){return n?[e.d.i(n.a||null,r),t.d.i(n.b||null,r)]:[e.a.z,t.a.z]},m:function(n){return N(e,t,n)}}}},sq:j,sw:function(e,t,n,r){return void 0===r&&(r=d),{a:{m:function(e,t){return e+t},z:0},p:function(r,o){return m(o,["name"])===i(e)&&t(o)?m(o,n):0},r:function(e,t){return r(t)},d:{l:function(r){return function(n){return m(n,["name"])===i(e)&&t(n)}(r)?(o=m(r,n))<0?["p2",null,-o]:["p2",o]:null;var o},i:function(e){return e?Array.isArray(e)?((t="p2"===e[0]?e.slice(1):e)[0]||0)-(t[1]||0):e:0;var t}}}},t:v,tb:function(e,t){return function(n){return y(e,t)(b(n))}},te:function(e){return function(t){return b(t)===e}},te_:function(e,t){return function(n){return x(e,n)===t}},tg:function(e){return function(t){return b(t)>e}},tg_:function(e,t){return function(n){return x(e,n)>t}},tge:function(e){return function(t){return b(t)>=e}},tge_:function(e,t){return function(n){return x(e,n)>=t}},ti:h,tl:function(e){return function(t){return b(t)<e}},tl_:function(e,t){return function(n){return x(e,n)<t}},tle:function(e){return function(t){return b(t)<e}},tle_:function(e,t){return function(n){return x(e,n)<t}},tn:function(e){return function(t){return b(t)!==e}},tn_:function(e,t){return function(n){return x(e,n)!==t}},tw:function(e,t,i){var o=i||100,a=Math.ceil(t/o),c=function(e){return Math.floor(e/a)},p=function(e,n,r){var i;return[c(e-t),(i={},i[c(n)]=r,i)]},u=function(t,n){var r=Math.max(t[0],n[0]),i=Object.keys(t[1]).filter((function(e){return e>=r})).concat(Object.keys(n[1]).filter((function(e){return e>=r}))).filter((function(e,t,n){return n.indexOf(e)===t})).reduce((function(r,i){var o=e.a.m(t[1][i]||e.a.z,n[1][i]||e.a.z);return o!==e.a.z&&(r[i]=o),r}),{});return[r,i]},s=[Number.NEGATIVE_INFINITY,{}],l=function(e){var t=function(t){return t.map((function(t){var r=n(t,3),i=r[0],o=(r[1],r[2]);return p(e.t,o,i)})).reduce(u,s)};return u(t(e.in),t(e.out))},_=function(t){if(void 0!==t.result)return _(t.result);if(void 0!==t.w)return _(l(t));var r=n(t,2),i=(r[0],r[1]),o=null,a={};for(var c in i){var p=e.d.m({result:i[c]});p&&Array.isArray(p)&&(o=p[0],a[c]=f(p.slice(1)))}return o&&[o,"w",t[0],a]};return{a:{m:function(e,t){var n=e.w?l(e):e;return u(n,t)},z:s},p:function(t,n){return p(t.getCurrentTime(),m(n,["time"],h),e.p(t,n))},r:function(t,n){var r=(n.w?l(n):n)[1];return e.r(t,Object.keys(r).reduce((function(t,n){return e.a.m(t,r[n])}),e.a.z))},d:e.d.tw||{l:function(t,i){var o=e.d.l(t,i);return o&&r([o[0],"w"],n(p(i.getCurrentTime(),m(t,["time"],h),o.slice(1))),!1)},i:function(n,r){var i=Array.isArray(n)?n:[],o=r.getCurrentTime(),a=c(o-t);return[i[2]||null,Object.keys(i[3]||{}).map((function(t){var n;return(n={})[t]=e.d.i(i[3][t],r),n})).reduce((function(e,t){return Object.keys(t).filter((function(e){return parseInt(e)>=a})).forEach((function(n){return e[n]=t[n]})),e}),{})]},m:e.d.m&&_}}},vgw:function(e,t,n,r){void 0===r&&(r=d);var o={v:0,k:0};return{a:{m:function(e,t){var n=e.k+t.k;return{v:n?e.v+t.k*(t.v-e.v)/n:0,k:n}},z:o},p:function(r,a){return m(a,["name"])===i(e)&&t(a)?{v:m(a,n),k:1}:o},r:function(e,t){return r(t.v)},d:{l:function(r){return m(r,["name"])===i(e)&&t(r)?0==(o=m(r,n))?["p3",1]:o<0?["p3",1,null,-o]:["p3",1,o]:null;var o},i:function(e){return e?Array.isArray(e)?{v:(((t=e.slice(1))[1]||0)-(t[2]||0))/(t[0]||1),k:t[0]||0}:void 0:o;var t}}}},vq:Q,w:function(e){return function(t){return t===s(e)}},x:function(e){return function(t){return t!==s(e)}},y:function(e,t){return function(n){return q(n,e)===a[t]}},y_:function(e,t){return function(n){return m(n,e)===a[t]}},z:function(e,t){return function(n){return q(n,e)!==a[t]}},z_:function(e,t){return function(n){return m(n,e)!==a[t]}}}}(),o=["Pageview"],a=["Food","Wine","","Art and Culture","Architecture","Family Travel","History","Adventure travel","Beaches","Health & Wellness","Luxury","Romance","orlando","Art and culture","Explore","Family holidays","Honeymoon and romance","Luxury travel","wanderlove","asia","south-america","explore","food-and-drink","art","art-and-culture","bar","cambodia","china","gallery","gastronomy","india","indonesia","japan","malaysia","new-zealand","philippines","singapore","thailand","vietnam","winery","Ecuador","Guyana","Paraguay","Suriname","Uruguay","Venezuela","argentina","bangkok","bolivia","brazil","chile","colombia","delhi","donegal","dubai","hanoi","hoi-an","hong-kong","kyoto","nanjing","peru","seoul","south america","southamerica","taipei","tokyo","adventure-travel","africa","cabo","pacific","australia","shopping","ski","Activities","Food and Drink","Local\'s Guide","National Parks","Outdoors","Sports and fitness","Sustainable Travel","United Kingdom","attractions","disney","familyfriendly","honeymoon-and-romance","museum","nightlife","restaurants","texas","theme park","South America","SouthAmerica","United States","canada","epcot","health-safety","hotels","luxury-travel","magic kingdom","mexico","north-america","usa","/art and entertainment/comics and animation","/art and entertainment/dance","/art and entertainment/movies and tv/television","/business and industrial","/family and parenting","/finance/financial news","/food and drink/healthy eating","/health and fitness","/society/crime","/society/dating","antarctica","backpacking","beaches","boston","covid-19","family-holidays","gift guide","gift-guide","los angeles","miami","new york city","universal studios"],c=[["classifications_watson","taxonomy_labels"],["city"],["categorySlug"],["pageSlug"],["content","city"],["country"],["place","destination"],["place","dest"],["slug"],["type"],["place","country"],["categories"],["tags"],["content","country"],["geo_info","country"],["region"],["continent"],["subtype"],["place","continent"],["article","name"],["attributes"],["content","continent"],["place","region"],["article","title"],["place","ctt"],["client","url"],["content","region"],["geo_info","city"],["place","slug"],["siteSection"]],p=[],u=[i.o([i.ref(3),i.ref(5)]),i.o([i.ref(19),i.ref(28)]),i.o([i.ref(16),i.ref(22)]),i.o([i.cl_(11,1),i.cl_(11,0),i.cl_(11,13),i.cl_(11,11),i.cl_(11,16),i.cl_(11,17),i.cl_(11,3),i.cl_(11,14),i.cl_(11,8),i.cl_(11,5),i.cl_(11,15)]),i.af_u(["properties","pois"],i.ref(14)),i.o([i.cl_(12,4),i.cl_(12,6),i.cl_(12,1),i.cl_(12,0),i.cl_(12,11),i.cl_(12,18),i.cl_(12,10),i.cl_(12,9),i.cl_(12,8),i.cl_(12,3),i.cl_(12,5)]),i.o([i.ref(18),i.ref(8)]),i.o([i.cl_(12,4),i.cl_(12,6),i.cl_(12,9),i.cl_(12,8),i.cl_(12,10)]),i.o([i.cl_(12,1),i.cl_(12,74),i.cl_(12,0),i.cl_(12,10),i.cl_(12,11),i.cl_(12,18)]),i.af_u(["properties","pois"],i.s_(9,96)),i.o([i.os(i.s,2,[66,24,113,21,22]),i.ref(12),i.ref(4),i.af_u(["properties","articles"],i.ref(29),i.ref(2)),i.af_u(["properties","articles"],i.ref(30),i.ref(2))]),i.o([i.os(i.s,2,[24,21,22]),i.ref(12),i.af_u(["properties","articles"],i.ref(29),i.ref(1)),i.af_u(["properties","articles"],i.ref(30),i.ref(1))]),i.af_u(["properties","pois"],i.ref(27)),i.o([i.os(i.s,2,[66,24,114,21,117,22,84,97]),i.af_u(["properties","articles"],i.ref(29),i.ref(0)),i.af_u(["properties","articles"],i.ref(30),i.ref(0))]),i.o([i.s_(9,81),i.s_(9,85),i.s_(9,86),i.s_(9,87),i.s_(9,71)]),i.o([i.cl_(11,79),i.cl_(12,79)]),i.o([i.cl_(11,4),i.cl_(11,6),i.cl_(11,1),i.cl_(11,0),i.cl_(11,13),i.cl_(11,7),i.cl_(11,3),i.cl_(11,14)]),i.af_u(["properties","destinations"],i.s_(1,12)),i.o([i.cl_(11,1),i.cl_(11,0),i.cl_(11,3),i.cl_(11,7),i.cl_(11,16)]),i.o([i.cl_(11,1),i.cl_(11,0),i.cl_(11,16),i.cl_(11,9),i.cl_(11,15),i.cl_(11,17),i.cl_(11,5)]),i.o([i.os(i.s,2,[24,21,22,84]),i.ref(12),i.af_u(["properties","articles"],i.ref(29),i.ref(6)),i.af_u(["properties","articles"],i.ref(30),i.ref(6))]),i.o([i.af_u(["properties","articles"],i.ref(29),i.o([i.ref(26),i.o([i.cl_(12,75),i.cl_(12,77),i.cl_(12,76),i.cl_(12,73),i.cl_(12,5)])])),i.af_u(["properties","articles"],i.ref(30),i.o([i.ref(26),i.o([i.cl_(12,75),i.cl_(12,77),i.cl_(12,73),i.cl_(12,76),i.cl_(12,5)])])),i.af_u(["properties","pois"],i.ref(29),i.cl_(20,83)),i.af_u(["properties","pois"],i.ref(30),i.cl_(20,83))]),i.o([i.cl_(12,4),i.cl_(12,6),i.cl_(12,1),i.cl_(12,0),i.cl_(12,3)]),i.o([i.cl_(11,4),i.cl_(11,6),i.cl_(11,9),i.cl_(11,13),i.cl_(11,17),i.cl_(11,7),i.cl_(11,14),i.cl_(11,3),i.cl_(11,8)]),i.o([i.ref(23),i.ref(7)]),i.o([i.ref(4),i.ref(12),i.af_u(["properties","articles"],i.ref(29),i.ref(24)),i.af_u(["properties","articles"],i.ref(30),i.ref(24))]),i.o([i.cl_(11,15),i.cl_(11,78),i.cl_(11,5),i.cl_(11,7)]),i.o([i.s_(17,23),i.s_(17,25),i.s_(17,28),i.s_(17,29),i.s_(17,39)]),i.o([i.cl_(12,1),i.cl_(12,0),i.cl_(12,10),i.cl_(12,11),i.cl_(12,18)]),i.o([i.e_(9,null),i.y_(9,2)]),i.a([i.n_(9,null),i.z_(9,2)]),i.os(i.s,27,[115,120,121,122,12])];return{rawQueries:{1e7:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/education/graduate school"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/science"),i.ge(3)),2592e6))),10000001:i.q(i.tw(i.cw(0,i.pc_(0,"/automotive and vehicles"),i.ge(3)),2592e6)),10000002:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/books and literature"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,102),i.ge(3)),2592e6))),10000003:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,105),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/finance"),i.ge(3)),2592e6))),10000004:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/careers"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/education/adult education"),i.ge(3)),2592e6))),10000005:i.q(i.tw(i.cw(0,i.pc_(0,"/education"),i.ge(3)),2592e6)),10000006:i.q(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,106),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,111),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/society/social institution/marriage"),i.ge(3)),2592e6))),10000007:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/books and literature/poetry"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,103),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/music/music genres/classical music"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/music/music genres/opera"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/shows and events/classical concert"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/theatre"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/visual art and design/art museums and galleries"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/visual art and design/arts education"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/visual art and design/performance art"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/visual art and design/restoration"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/visual art and design/sculpture"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/education/art history"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/hobbies and interests/arts and crafts/photography"),i.ge(3)),2592e6))),10000008:i.q(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/business and industrial/food industry"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/food and drink"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/food and drink/food and grocery retailers"),i.ge(3)),2592e6))),10000010:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,108),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,109),i.ge(3)),2592e6))),10000011:i.q(i.tw(i.cw(0,i.pc_(0,"/hobbies and interests"),i.ge(3)),2592e6)),10000012:i.q(i.tw(i.cw(0,i.pc_(0,"/home and garden"),i.ge(3)),2592e6)),10000013:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies and tv"),i.ge(3)),2592e6))),10000014:i.q(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/music"),i.ge(3)),2592e6)),10000015:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/business and industrial/business news"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,107),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/law, govt and politics"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/news"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,110),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/sports/sports news"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/technology and computing/tech news"),i.ge(3)),2592e6))),10000016:i.q(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/finance/bank"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,107),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/finance/personal finance"),i.ge(3)),2592e6))),10000017:i.q(i.tw(i.cw(0,i.pc_(0,"/pets"),i.ge(3)),2592e6)),10000018:i.q(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/celebrity fan and gossip"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies and tv/reality"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,104),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/music/music genres/pop music"),i.ge(3)),2592e6))),10000019:i.q(i.tw(i.cw(0,i.pc_(0,"/real estate"),i.ge(3)),2592e6)),10000020:i.q(i.tw(i.cw(0,i.pc_(0,"/shopping"),i.ge(3)),2592e6)),10000021:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,109),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/sports"),i.ge(3)),2592e6))),10000022:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/business and industrial/fashion industry"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/style and fashion"),i.ge(3)),2592e6))),10000023:i.q(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/business and industrial/automation"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/science/computer science"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/technology and computing"),i.ge(3)),2592e6))),10000024:i.q(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies and tv/movies/reviews"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,104),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/tv"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/technology and computing/consumer electronics/tv and video equipment"),i.ge(3)),2592e6))),10000025:i.q(i.tw(i.cw(0,i.pc_(0,"/travel"),i.ge(3)),2592e6)),10000026:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/hobbies and interests/games/video and computer games"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/technology and computing/consumer electronics/game systems and consoles"),i.ge(3)),2592e6))),10000035:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/science/engineering"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/science/physics"),i.ge(3)),2592e6))),10000036:i.q(i.tw(i.cw(0,i.pc_(0,"/automotive and vehicles/buying and selling cars"),i.ge(3)),2592e6)),10000037:i.q(i.tw(i.cw(0,i.pc_(0,"/automotive and vehicles/motor shows"),i.ge(3)),2592e6)),10000038:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/automotive and vehicles/cars/hybrid"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/automotive and vehicles/electric vehicles"),i.ge(3)),2592e6))),10000039:i.q(i.tw(i.cw(0,i.pc_(0,"/automotive and vehicles/motorcycles"),i.ge(3)),2592e6)),10000040:i.q(i.tw(i.cw(0,i.pc_(0,"/automotive and vehicles/cars/performance vehicles"),i.ge(3)),2592e6)),10000041:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,102),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/art and entertainment/comics and animation/comics"),i.ge(3)),2592e6))),10000042:i.q(i.tw(i.cw(0,i.pc_(0,"/business and industrial/business operations"),i.ge(3)),2592e6)),10000043:i.q(i.tw(i.cw(0,i.pc_(0,111),i.ge(3)),2592e6)),10000044:i.q(i.tw(i.cw(0,i.pc_(0,106),i.ge(3)),2592e6)),10000045:i.q(i.tw(i.cw(0,i.pc_(0,103),i.ge(3)),2592e6)),10000046:i.q(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/visual art and design"),i.ge(3)),2592e6)),10000047:i.q(i.tw(i.cw(0,i.pc_(0,"/food and drink/beverages/alcoholic beverages"),i.ge(3)),2592e6)),10000048:i.q(i.tw(i.cw(0,i.pc_(0,"/food and drink/barbecues and grilling"),i.ge(3)),2592e6)),10000049:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/food and drink/desserts and baking"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/food and drink/food and grocery retailers/bakeries"),i.ge(3)),2592e6))),10000050:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/food and drink/dining out"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/food and drink/food/fast food"),i.ge(3)),2592e6))),10000051:i.q(i.tw(i.cw(0,i.pc_(0,"/food and drink/food allergies"),i.ge(3)),2592e6)),10000052:i.q(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/food and drink/food/fruits and vegetables"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/food and drink/food/salads"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/food and drink/health and lowfat cooking"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,108),i.ge(3)),2592e6))),10000053:i.q(i.tw(i.cw(0,i.pc_(0,"/food and drink/vegetarian"),i.ge(3)),2592e6)),10000054:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/health and fitness/exercise"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/health and fitness/sports medicine"),i.ge(3)),2592e6))),10000055:i.q(i.tw(i.cw(0,i.pc_(0,"/health and fitness/men\'s health"),i.ge(3)),2592e6)),10000056:i.q(i.tw(i.cw(0,i.pc_(0,"/health and fitness/nutrition"),i.ge(3)),2592e6)),10000057:i.q(i.tw(i.cw(0,i.pc_(0,"/health and fitness/women\'s health"),i.ge(3)),2592e6)),10000058:i.q(i.tw(i.cw(0,i.pc_(0,"/home and garden/gardening and landscaping"),i.ge(3)),2592e6)),10000059:i.q(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies and tv/action"),i.ge(3)),2592e6)),10000060:i.q(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies and tv/animated"),i.ge(3)),2592e6)),10000061:i.q(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies and tv/children\'s"),i.ge(3)),2592e6)),10000062:i.q(i.tw(i.cw(0,i.pc_(0,"/art and entertainment/movies and tv/horror"),i.ge(3)),2592e6)),10000063:i.q(i.tw(i.cw(0,i.pc_(0,110),i.ge(3)),2592e6)),10000064:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/law, govt and politics/law enforcement"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/law, govt and politics/legal issues"),i.ge(3)),2592e6))),10000065:i.q(i.tw(i.cw(0,i.pc_(0,"/news/national news"),i.ge(3)),2592e6)),10000066:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/law, govt and politics/government"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/law, govt and politics/politics"),i.ge(3)),2592e6))),10000067:i.q(i.tw(i.cw(0,i.pc_(0,"/science/weather"),i.ge(3)),2592e6)),10000068:i.q(i.tw(i.cw(0,i.pc_(0,"/pets/birds"),i.ge(3)),2592e6)),10000069:i.q(i.tw(i.cw(0,i.pc_(0,"/pets/cats"),i.ge(3)),2592e6)),10000070:i.q(i.tw(i.cw(0,i.pc_(0,"/pets/dogs"),i.ge(3)),2592e6)),10000071:i.q(i.tw(i.cw(0,i.pc_(0,"/pets/large animals"),i.ge(3)),2592e6)),10000072:i.q(i.tw(i.cw(0,i.pc_(0,"/pets/reptiles"),i.ge(3)),2592e6)),10000073:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/football"),i.ge(3)),2592e6)),10000074:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/baseball"),i.ge(3)),2592e6)),10000075:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/basketball"),i.ge(3)),2592e6)),10000076:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/bodybuilding"),i.ge(3)),2592e6)),10000077:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/bowling"),i.ge(3)),2592e6)),10000078:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/boxing"),i.ge(3)),2592e6)),10000079:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/bicycling"),i.ge(3)),2592e6)),10000080:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/fishing"),i.ge(3)),2592e6)),10000081:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/golf"),i.ge(3)),2592e6)),10000082:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/hunting and shooting"),i.ge(3)),2592e6)),10000083:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/rugby"),i.ge(3)),2592e6)),10000084:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/skiing"),i.ge(3)),2592e6)),10000085:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/tennis"),i.ge(3)),2592e6)),10000086:i.q(i.tw(i.cw(0,i.pc_(0,"/sports/walking"),i.ge(3)),2592e6)),10000087:i.q(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/business and industrial/tanning"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/style and fashion/beauty"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/style and fashion/beauty/cosmetics"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/style and fashion/beauty/cosmetology and beauty professionals"),i.ge(3)),2592e6))),10000088:i.q(i.ocq(i.tw(i.cw(0,i.pc_(0,"/style and fashion/beauty/tattoos"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/style and fashion/body art"),i.ge(3)),2592e6))),10000089:i.q(i.tw(i.cw(0,i.pc_(0,"/style and fashion/men \'s fashion"),i.ge(3)),2592e6)),10000090:i.q(i.tw(i.cw(0,i.pc_(0,"/technology and computing/consumer electronics"),i.ge(3)),2592e6)),10000324:i.q(i.tw(i.cw(0,i.pc_(0,105),i.ge(3)),2592e6)),10000325:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/business and industrial/company/annual report"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/business and industrial/company/bankruptcy"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/business and industrial/company/earnings"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/business and industrial/company/joint venture"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/business and industrial/company/merger and acquisition"),i.ge(3)),2592e6))),10000327:i.q(i.tw(i.cw(0,i.pc_(0,"/finance/personal finance/debt management"),i.ge(3)),2592e6)),10000328:i.q(i.tw(i.cw(0,i.pc_(0,"/finance/personal finance/insurance"),i.ge(3)),2592e6)),10000329:i.q(i.ocq(i.ocq(i.tw(i.cw(0,i.pc_(0,"/finance/accounting and auditing/billing and invoicing"),i.ge(3)),2592e6),i.tw(i.cw(0,i.pc_(0,"/finance/accounting and auditing/bookkeeping"),i.ge(3)),2592e6)),i.tw(i.cw(0,i.pc_(0,"/finance/accounting and auditing/tax preparation and planning"),i.ge(3)),2592e6))),10000330:i.q(i.tw(i.cw(0,i.pc_(0,"/finance/investing"),i.ge(3)),2592e6)),122660:i.q(i.ocq(i.ocq(i.ocq(i.cw(0,i.y(7,88),i.ge(1)),i.cw(0,i.y(22,88),i.ge(1))),i.cw(0,i.ps(8,88),i.ge(1))),i.cw(0,i.y(6,88),i.ge(1)))),23918:i.q(i.cw(0,i.t,i.ge(1))),24040:i.q(i.cw(0,i.y(14,92),i.ge(1))),24996:i.q(i.cw("LinkClick",i.ps(["dest_url"],"thorntree"),i.ge(1))),46274:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","1662",!1,"46274"),i.itp("eyeota","324",!1,"46274")),i.itp("eyeota","35799",!1,"46274")),i.itp("eyeota","35804",!1,"46274")),i.itp("eyeota","1664",!1,"46274")),i.itp("liveramp_IPSOS","1002008356",!1,"46274")),i.itp("liveramp_OnAudience","1002860936",!1,"46274")),i.itp("eyeota","35797",!1,"46274")),i.itp("eyeota","35423",!1,"46274")),i.itp("eyeota","35801",!1,"46274")),i.itp("liveramp_Experian","1004258969",!1,"46274")),i.itp("liveramp_OnAudience","1002860976",!1,"46274")),i.itp("liveramp_OnAudience","1002860966",!1,"46274")),i.itp("liveramp_Stirista","1003668279",!1,"46274")),i.itp("liveramp_OnAudience","1002860966",!1,"46274")),i.itp("liveramp_Experian","1004268069",!1,"46274")),i.itp("liveramp_Experian","1004268309",!1,"46274")),i.itp("liveramp_Experian","1004268109",!1,"46274")),i.itp("liveramp_Experian","1004268079",!1,"46274")),i.itp("liveramp_Experian","1004268119",!1,"46274")),i.itp("liveramp_Experian","1004268079",!1,"46274")),i.itp("liveramp_Experian","1004264619",!1,"46274")),i.itp("eyeota","35803",!1,"46274")),i.itp("eyeota","35804",!1,"46274")),i.itp("eyeota","35799",!1,"46274")),i.itp("eyeota","35798",!1,"46274")),i.itp("liveramp_Experian","1004268069",!1,"46274")),i.itp("liveramp_Experian","1004268109",!1,"46274")),i.itp("liveramp_Experian","1004268309",!1,"46274")),i.itp("eyeota","13038",!1,"46274")),i.itp("liveramp_Stirista","1003716309",!1,"46274")),i.itp("eyeota","1662",!1,"46274")),i.itp("eyeota","322",!1,"46274"))),47174:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.o([i.os(i.s,19,[82,94,98,12,89,123]),i.os(i.s,23,[82,94,98,12,89,123]),i.os(i.s,2,[82,12,89]),i.ps(4,12),i.os(i.s,3,[82,94,98,12,89]),i.ps(["place","city"],12),i.ps(6,12),i.ref(17)]),i.ge(1)),145152e5),i.itp("liveramp_Stirista","1004070619",!1,"47174")),i.itp("liveramp_PlaceIQ","1002440486",!1,"47174")),i.itp("liveramp_PlaceIQ","1002440476",!1,"47174")),i.itp("liveramp_PlaceIQ","1002440496",!1,"47174")),i.itp("eyeota","1541",!1,"47174"))),47281:i.q(i.tw(i.cw(0,i.os(i.s,2,["digital","tech"]),i.ge(1)),7776e6)),47282:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_OnAudience","1002860456",!1,"47282"),i.itp("liveramp_Experian","1004269059",!1,"47282")),i.itp("liveramp_OnAudience","1002861356",!1,"47282")),i.itp("liveramp_Experian","1004601959",!1,"47282")),i.itp("liveramp_OnAudience","1002861486",!1,"47282")),i.itp("eyeota_mastercard","41904",!1,"47282")),i.itp("liveramp_Experian","1004269039",!1,"47282")),i.itp("liveramp_IPSOS","1002977076",!1,"47282")),i.itp("liveramp_Experian","1004269029",!1,"47282")),i.itp("liveramp_Experian","1004269059",!1,"47282")),i.itp("liveramp_Experian","1004269039",!1,"47282")),i.itp("liveramp_StatSocial","1006914541",!1,"47282")),i.itp("liveramp_Bombora","1000094044",!1,"47282")),i.itp("liveramp_Bombora","1000884389",!1,"47282")),i.itp("liveramp_OnAudience","1002861486",!1,"47282")),i.itp("liveramp_Stirista","1004343449",!1,"47282")),i.itp("eyeota","1504",!1,"47282")),i.itp("eyeota","37",!1,"47282")),i.itp("eyeota","6591",!1,"47282")),i.itp("eyeota","35282",!1,"47282")),i.itp("eyeota","12932",!1,"47282")),i.itp("eyeota","35300",!1,"47282")),i.itp("liveramp_Experian","1004261389",!1,"47282")),i.itp("liveramp_Experian","1004261389",!1,"47282")),i.itp("liveramp_IPSOS","1003133196",!1,"47282")),i.itp("eyeota","50",!1,"47282")),i.itp("liveramp_Mastercard","1005908671",!1,"47282")),i.itp("liveramp_IPSOS","1003133026",!1,"47282")),i.itp("liveramp_Bombora","1000884619",!1,"47282")),i.itp("liveramp_PlaceIQ","1002437646",!1,"47282")),i.itp("liveramp_IPSOS","1002976936",!1,"47282"))),47292:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.cw(0,i.o([i.os(i.w,2,["romance-travel","beaches-and-islands",71,97]),i.pe(29,"bookings")]),i.ge(1)),i.itp("eyeota","35944",!1,"47292")),i.itp("eyeota","35796",!1,"47292")),i.itp("eyeota","35848",!1,"47292")),i.itp("eyeota","36003",!1,"47292")),i.itp("liveramp_Stirista","1001320519",!1,"47292")),i.itp("eyeota","13438",!1,"47292")),i.itp("eyeota","1659",!1,"47292")),i.itp("eyeota","1574",!1,"47292")),i.itp("liveramp_Mastercard","1005907021",!1,"47292")),i.itp("liveramp_IPSOS","1004367559",!1,"47292")),i.itp("liveramp_Stirista","1003670399",!1,"47292")),i.itp("liveramp_PlaceIQ","1002445206",!1,"47292")),i.itp("liveramp_PlaceIQ","1002445196",!1,"47292")),i.itp("liveramp_PlaceIQ","1002445216",!1,"47292")),i.itp("eyeota","36020",!1,"47292")),i.itp("eyeota","36001",!1,"47292")),i.itp("eyeota","13443",!1,"47292")),i.itp("liveramp_Experian","1004268919",!1,"47292")),i.itp("liveramp_PlaceIQ","1002444916",!1,"47292")),i.itp("liveramp_PlaceIQ","1002445666",!1,"47292")),i.itp("liveramp_PlaceIQ","1002444506",!1,"47292")),i.itp("liveramp_PlaceIQ","1002444596",!1,"47292")),i.itp("liveramp_PlaceIQ","1002445376",!1,"47292")),i.itp("liveramp_PlaceIQ","1002445206",!1,"47292")),i.itp("liveramp_PlaceIQ","1002444316",!1,"47292")),i.itp("liveramp_PlaceIQ","1002445786",!1,"47292")),i.itp("liveramp_PlaceIQ","1002444656",!1,"47292")),i.itp("liveramp_StatSocial","1006914631",!1,"47292")),i.itp("liveramp_Experian","1004268919",!1,"47292")),i.itp("liveramp_Mastercard","1005063239",!1,"47292")),i.itp("liveramp_Mastercard","1005907281",!1,"47292")),i.itp("liveramp_OnAudience","1002862306",!1,"47292")),i.itp("liveramp_OnAudience","1002862306",!1,"47292"))),47296:i.q(i.tw(i.cw(0,i.o([i.y(3,100),i.y(18,100),i.af_u(["properties","destinations"],i.y_(16,100))]),i.ge(1)),2592e6)),47297:i.q(i.itp("eyeota","331",!1,"47297")),47628:i.q(i.tw(i.cw(0,i.o([i.ps(21,112),i.af_u(["properties","destinations"],i.y_(16,112))]),i.ge(1)),2592e6)),47650:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1005797661",!1,"47650"),i.itp("liveramp_PlaceIQ","1002615626",!1,"47650")),i.itp("liveramp_PlaceIQ","1002437036",!1,"47650")),i.itp("eyeota_mastercard","41789",!1,"47650")),i.itp("comscore","318246US",!1,"47650")))),47651:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004256489",!1,"47651"),i.itp("liveramp_Stirista","1000307626",!1,"47651")),i.itp("eyeota","35436",!1,"47651")),i.itp("eyeota","6681",!1,"47651")),i.itp("eyeota","301",!1,"47651")),i.itp("eyeota","243",!1,"47651")),i.itp("liveramp_MeritDirect","1002713866",!1,"47651")),i.itp("liveramp_Experian","1004256489",!1,"47651")),i.itp("liveramp_MeritDirect","1002713866",!1,"47651")),i.itp("eyeota_onaudience","14931",!1,"47651")),i.itp("eyeota_onaudience","14933",!1,"47651")),i.itp("eyeota_onaudience","14934",!1,"47651")),i.itp("eyeota_onaudience","14932",!1,"47651"))),47652:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004256479",!1,"47652"),i.itp("liveramp_Stirista","1000308346",!1,"47652")),i.itp("eyeota","35435",!1,"47652")),i.itp("eyeota","300",!1,"47652")),i.itp("eyeota","6680",!1,"47652")),i.itp("eyeota","242",!1,"47652")),i.itp("liveramp_MeritDirect","1002713876",!1,"47652")),i.itp("liveramp_Experian","1004256479",!1,"47652")),i.itp("liveramp_Stirista","1000308346",!1,"47652")),i.itp("liveramp_Stirista","1000308346",!1,"47652")),i.itp("eyeota_onaudience","14929",!1,"47652")),i.itp("eyeota_onaudience","14927",!1,"47652")),i.itp("eyeota_onaudience","14925",!1,"47652")),i.itp("eyeota_onaudience","14926",!1,"47652")),i.itp("eyeota_onaudience","14928",!1,"47652"))),47653:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.e_(16,"europe")),i.ge(1)),2592e6)),47654:i.q(i.tw(i.cw(0,i.o([i.os(i.w,21,["Asia",19]),i.y(18,19),i.os(i.w,24,[69,19]),i.os(i.s,2,[19,69]),i.os(i.s,26,[19]),i.os(i.s,3,[19,69]),i.os(i.s,22,[19,69]),i.os(i.s,28,[19,69]),i.os(i.s,8,[19,69]),i.af_u(["properties","destinations"],i.o([i.s_(16,19)]))]),i.ge(1)),2592e6)),47721:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.o([i.s_(5,"england"),i.s_(5,"united kingdom"),i.s_(5,"united-kingdom")])),i.ge(1)),2592e6)),47723:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"italy")),i.ge(1)),2592e6)),47730:i.q(i.itp("eyeota","332",!1,"47730")),47733:i.q(i.tw(i.cw(0,i.o([i.y(3,93),i.y(10,93),i.af_u(["properties","destinations"],i.y_(5,93))]),i.ge(1)),2592e6)),47734:i.q(i.tw(i.cw(0,i.o([i.y(3,101),i.y(10,101),i.af_u(["properties","destinations"],i.y_(5,101))]),i.ge(1)),2592e6)),47736:i.q(i.tw(i.cw(0,i.o([i.y(3,99),i.y(10,99),i.af_u(["properties","destinations"],i.y_(5,99))]),i.ge(1)),2592e6)),47749:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_PlaceIQ","1002437046",!1,"47749"),i.itp("eyeota_mastercard","41790",!1,"47749")),i.itp("liveramp_ShareThis","1003555929",!1,"47749")),i.itp("comscore","225346US",!1,"47749")),i.itp("comscore","325346US",!1,"47749")),i.itp("comscore","125346US",!1,"47749")))),47750:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.itp("liveramp_PlaceIQ","1002437056",!1,"47750"),i.itp("eyeota_mastercard","41791",!1,"47750")),i.itp("liveramp_ShareThis","1003555999",!1,"47750")))),47751:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.itp("liveramp_PlaceIQ","1002437066",!1,"47751"),i.itp("eyeota_mastercard","41792",!1,"47751")),i.itp("liveramp_ShareThis","1003555809",!1,"47751")))),47752:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.itp("liveramp_PlaceIQ","1002437076",!1,"47752"),i.itp("liveramp_ShareThis","1003556099",!1,"47752")))),47753:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004256419",!1,"47753"),i.itp("liveramp_Experian","1004256419",!1,"47753")),i.itp("liveramp_Experian","1004256419",!1,"47753")),i.itp("liveramp_PlaceIQ","1002437086",!1,"47753")),i.itp("liveramp_Stirista","1000303586",!1,"47753")),i.itp("liveramp_CACI","1004179109",!1,"47753")))),47755:i.q(i.tw(i.cw(0,i.a([i.ref(31),i.os(i.w,2,[66,22])]),i.ge(1)),7776e6)),47756:i.q(i.acq(i.tw(i.cw(0,i.ref(31),i.ge(1)),7776e6),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_OnAudience","1002861556",!1,"47756"),i.itp("liveramp_Stirista","1003670419",!1,"47756")),i.itp("liveramp_StatSocial","1006914581",!1,"47756")),i.itp("liveramp_StatSocial","1006917231",!1,"47756")),i.itp("liveramp_OnAudience","1002860376",!1,"47756")),i.itp("eyeota","1635",!1,"47756")),i.itp("eyeota","35397",!1,"47756")),i.itp("liveramp_Experian","1004258359",!1,"47756")),i.itp("liveramp_StatSocial","1006911641",!1,"47756")))),47846:i.q(i.acq(i.tw(i.cw(0,i.y(14,92),i.ge(1)),7776e6),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","324",!1,"47846"),i.itp("liveramp_OnAudience","1002862166",!1,"47846")),i.itp("eyeota","324",!1,"47846")),i.itp("eyeota","1664",!1,"47846")),i.itp("liveramp_Experian","1004268109",!1,"47846")),i.itp("liveramp_Experian","1004268109",!1,"47846")),i.itp("liveramp_Experian","1004268109",!1,"47846")),i.itp("liveramp_Experian","1004268119",!1,"47846")))),47862:i.q(i.tw(i.cw(0,i.o([i.ps(21,67),i.ps(18,67),i.ps(24,67),i.ps(7,67),i.ps(6,67),i.af_u(["properties","destinations"],i.s_(16,67))]),i.ge(1)),2592e6)),47863:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Stirista","1000308146",!1,"47863"),i.itp("eyeota","35466",!1,"47863")),i.itp("eyeota","35463",!1,"47863")),i.itp("eyeota","35468",!1,"47863")),i.itp("liveramp_Experian","1004256429",!1,"47863")),i.itp("liveramp_PlaceIQ","1002615596",!1,"47863"))),47864:i.q(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004256439",!1,"47864"),i.itp("liveramp_Experian","1004256439",!1,"47864")),i.itp("liveramp_Experian","1004256439",!1,"47864")),i.itp("eyeota","35471",!1,"47864"))),47865:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004256449",!1,"47865"),i.itp("eyeota","35470",!1,"47865")),i.itp("liveramp_Experian","1004256449",!1,"47865")),i.itp("liveramp_Experian","1004256449",!1,"47865")),i.itp("liveramp_Experian","1004256449",!1,"47865"))),47894:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"wales")),i.ge(1)),2592e6)),47895:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"ireland")),i.ge(1)),2592e6)),47896:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"spain")),i.ge(1)),2592e6)),47897:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"greece")),i.ge(1)),2592e6)),47898:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"germany")),i.ge(1)),2592e6)),47899:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"scotland")),i.ge(1)),2592e6)),47900:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"france")),i.ge(1)),2592e6)),47901:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"portugal")),i.ge(1)),2592e6)),47903:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"turkey")),i.ge(1)),2592e6)),47917:i.q(i.tw(i.cw(0,i.o([i.y(13,30),i.y(10,30),i.ps(2,30),i.ps(3,30),i.ps(7,30),i.ps(6,30),i.ps(8,30),i.af_u(["properties","destinations"],i.y_(5,30))]),i.ge(1)),2592e6)),47918:i.q(i.tw(i.cw(0,i.o([i.y(2,38),i.y(13,38),i.y(10,38),i.y(7,38),i.y(6,38),i.ps(3,38),i.ps(8,38),i.af_u(["properties","destinations"],i.y_(5,38))]),i.ge(1)),2592e6)),47919:i.q(i.tw(i.cw(0,i.o([i.y(13,32),i.y(10,32),i.ps(2,32),i.ps(3,32),i.ps(7,32),i.ps(6,32),i.ps(8,32),i.af_u(["properties","destinations"],i.y_(5,32))]),i.ge(1)),2592e6)),47920:i.q(i.tw(i.cw(0,i.o([i.y(13,37),i.y(10,37),i.ps(2,37),i.ps(3,37),i.ps(7,37),i.ps(6,37),i.ps(8,37),i.af_u(["properties","destinations"],i.y_(5,37))]),i.ge(1)),2592e6)),47921:i.q(i.tw(i.cw(0,i.o([i.y(13,27),i.y(10,27),i.ps(2,27),i.ps(3,27),i.ps(7,27),i.ps(6,27),i.ps(8,27),i.af_u(["properties","destinations"],i.o([i.e_(5,"China"),i.y_(5,27)]))]),i.ge(1)),2592e6)),47922:i.q(i.tw(i.cw(0,i.o([i.y(13,31),i.y(10,31),i.ps(2,31),i.ps(3,31),i.ps(7,31),i.ps(6,31),i.ps(8,31),i.af_u(["properties","destinations"],i.y_(5,31))]),i.ge(1)),2592e6)),47923:i.q(i.tw(i.cw(0,i.o([i.y(13,35),i.y(10,35),i.ps(2,35),i.ps(3,35),i.ps(7,35),i.ps(6,35),i.ps(8,35),i.af_u(["properties","destinations"],i.y_(5,35))]),i.ge(1)),2592e6)),47924:i.q(i.tw(i.cw(0,i.o([i.y(13,26),i.y(10,26),i.ps(2,26),i.ps(3,26),i.ps(7,26),i.ps(6,26),i.ps(8,26),i.af_u(["properties","destinations"],i.y_(5,26))]),i.ge(1)),2592e6)),47925:i.q(i.tw(i.cw(0,i.o([i.y(13,33),i.y(10,33),i.ps(2,33),i.ps(3,33),i.ps(7,33),i.ps(6,33),i.ps(8,33),i.af_u(["properties","destinations"],i.y_(5,33))]),i.ge(1)),2592e6)),47926:i.q(i.tw(i.cw(0,i.o([i.y(13,34),i.y(10,34),i.ps(2,34),i.ps(3,34),i.ps(7,34),i.ps(6,34),i.ps(8,34),i.af_u(["properties","destinations"],i.y_(5,34))]),i.ge(1)),2592e6)),47929:i.q(i.tw(i.cw(0,i.o([i.y(4,65),i.ps(2,65),i.ps(3,65),i.ps(7,65),i.ps(6,65),i.ps(8,65),i.af_u(["properties","destinations"],i.y_(1,65))]),i.ge(1)),2592e6)),47930:i.q(i.tw(i.cw(0,i.o([i.y(4,47),i.ps(2,47),i.ps(3,47),i.ps(7,47),i.ps(6,47),i.ps(8,47),i.af_u(["properties","destinations"],i.y_(1,47))]),i.ge(1)),2592e6)),47931:i.q(i.tw(i.cw(0,i.o([i.y(4,56),i.ps(2,56),i.ps(3,56),i.ps(7,56),i.ps(6,56),i.ps(8,56),i.af_u(["properties","destinations"],i.y_(1,56))]),i.ge(1)),2592e6)),47932:i.q(i.tw(i.cw(0,i.o([i.y(4,54),i.ps(2,54),i.ps(3,54),i.ps(7,54),i.ps(6,54),i.ps(8,54),i.af_u(["properties","destinations"],i.y_(1,54))]),i.ge(1)),2592e6)),47933:i.q(i.tw(i.cw(0,i.o([i.y(4,61),i.ps(2,61),i.ps(3,61),i.ps(7,61),i.ps(6,61),i.ps(8,61),i.af_u(["properties","destinations"],i.y_(1,61))]),i.ge(1)),2592e6)),47934:i.q(i.tw(i.cw(0,i.o([i.y(4,64),i.ps(2,64),i.ps(3,64),i.ps(7,64),i.ps(6,64),i.ps(8,64),i.af_u(["properties","destinations"],i.y_(1,64))]),i.ge(1)),2592e6)),47935:i.q(i.tw(i.cw(0,i.o([i.y(4,58),i.ps(2,58),i.ps(3,58),i.ps(7,58),i.ps(6,58),i.ps(8,58),i.af_u(["properties","destinations"],i.y_(1,58))]),i.ge(1)),2592e6)),47936:i.q(i.tw(i.cw(0,i.o([i.y(4,55),i.ps(2,55),i.ps(3,55),i.ps(7,55),i.ps(6,55),i.ps(8,55),i.af_u(["properties","destinations"],i.y_(1,55))]),i.ge(1)),2592e6)),47937:i.q(i.tw(i.cw(0,i.o([i.y(4,52),i.ps(2,52),i.ps(3,52),i.ps(7,52),i.ps(6,52),i.ps(8,52),i.af_u(["properties","destinations"],i.y_(1,52))]),i.ge(1)),2592e6)),47938:i.q(i.tw(i.cw(0,i.o([i.y(4,57),i.ps(2,57),i.ps(3,57),i.ps(7,57),i.ps(6,57),i.ps(8,57),i.af_u(["properties","destinations"],i.y_(1,57))]),i.ge(1)),2592e6)),47939:i.q(i.tw(i.cw(0,i.o([i.y(13,36),i.y(10,36),i.ps(2,36),i.ps(3,36),i.ps(7,36),i.ps(6,36),i.ps(8,36),i.af_u(["properties","destinations"],i.y_(5,36))]),i.ge(1)),2592e6)),47940:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(1,"london")),i.ge(1)),2592e6)),47941:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(1,"paris")),i.ge(1)),2592e6)),47942:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(1,"rome")),i.ge(1)),2592e6)),47943:i.q(i.ocq(i.ocq(i.itp("liveramp_Bombora","1005405049",!1,"47943"),i.itp("eyeota","238",!1,"47943")),i.itp("liveramp_Experian","1004602229",!1,"47943"))),47944:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Bombora","1005405069",!1,"47944"),i.itp("liveramp_Bombora","1005405079",!1,"47944")),i.itp("liveramp_PlaceIQ","1002437396",!1,"47944")),i.itp("liveramp_PlaceIQ","1002437406",!1,"47944")),i.itp("liveramp_Stirista","1000306896",!1,"47944"))),47945:i.q(i.ocq(i.ocq(i.ocq(i.itp("eyeota","302",!1,"47945"),i.itp("liveramp_Bombora","1005405099",!1,"47945")),i.itp("eyeota","6684",!1,"47945")),i.itp("eyeota","35590",!1,"47945"))),48010:i.q(i.tw(i.cw(0,i.o([i.ps(2,70),i.ps(13,70),i.ps(3,70),i.af_u(["properties","destinations"],i.s_(5,70))]),i.ge(1)),7776e6)),48261:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.e_(15,"new-south-wales")),i.ge(1)),7776e6)),48262:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(15,"queensland")),i.ge(1)),7776e6)),48263:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(15,"northern-territory"),i.s_(5,70)),i.ge(1)),7776e6)),48264:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.e_(15,"western-australia")),i.ge(1)),7776e6)),48265:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.e_(15,"south-australia")),i.ge(1)),7776e6)),48266:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(15,"victoria")),i.ge(1)),7776e6)),48267:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(15,"tasmania")),i.ge(1)),7776e6)),48309:i.q(i.tw(i.cw(0,i.pe(14,"Ireland"),i.ge(1)),7776e6)),49048:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"nigeria")),i.ge(1)),2592e6)),49050:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"tanzania")),i.ge(1)),2592e6)),49052:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"ghana")),i.ge(1)),2592e6)),49089:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"kenya")),i.ge(1)),2592e6)),49109:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(1,"sydney")),i.ge(1)),7776e6)),49149:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(1,"melbourne")),i.ge(1)),7776e6)),50432:i.q(i.acq(i.tw(i.cw(0,i.y(14,80),i.ge(1)),7776e6),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota_statsocial","23277",!1,"50432"),i.itp("eyeota","1696",!1,"50432")),i.itp("liveramp_Experian","1004268299",!1,"50432")),i.itp("liveramp_Stirista","1003669759",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440206",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440196",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440216",!1,"50432")),i.itp("liveramp_Experian","1004257349",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440136",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440116",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440036",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440026",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440096",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440086",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440106",!1,"50432")),i.itp("liveramp_PlaceIQ","1002440016",!1,"50432")),i.itp("liveramp_Stirista","1003669759",!1,"50432")),i.itp("eyeota_experian","39467",!1,"50432")),i.itp("eyeota_experian","39469",!1,"50432")),i.itp("liveramp_Experian","1004259009",!1,"50432")),i.itp("eyeota_dataxpand","29625",!1,"50432")),i.itp("eyeota_experian","39471",!1,"50432")),i.itp("liveramp_Experian","1004268299",!1,"50432")),i.itp("liveramp_Experian","1004268299",!1,"50432")),i.itp("liveramp_Experian","1004268299",!1,"50432")),i.itp("liveramp_Experian","1004257119",!1,"50432")),i.itp("eyeota","35849",!1,"50432")),i.itp("eyeota","1536",!1,"50432")),i.itp("liveramp_PlaceIQ","1004245449",!1,"50432")),i.itp("liveramp_PlaceIQ","1004245429",!1,"50432")),i.itp("liveramp_PlaceIQ","1004245439",!1,"50432")),i.itp("eyeota_onaudience","28522",!1,"50432")),i.itp("eyeota_onaudience","28519",!1,"50432")),i.itp("eyeota_onaudience","28521",!1,"50432")),i.itp("eyeota_onaudience","28523",!1,"50432")),i.itp("liveramp_Experian","1004261549",!1,"50432")),i.itp("liveramp_Experian","1004261569",!1,"50432")),i.itp("liveramp_Experian","1004261559",!1,"50432")),i.itp("liveramp_Experian","1004261589",!1,"50432")),i.itp("liveramp_Experian","1004268299",!1,"50432")),i.itp("liveramp_Experian","1004268299",!1,"50432")),i.itp("liveramp_Bombora","1000883929",!1,"50432")),i.itp("liveramp_Bombora","1000884019",!1,"50432")),i.itp("liveramp_Bombora","1000883949",!1,"50432")),i.itp("liveramp_Bombora","1000883829",!1,"50432")),i.itp("liveramp_Bombora","1000883959",!1,"50432")),i.itp("liveramp_Stirista","1003718019",!1,"50432")),i.itp("liveramp_Bombora","1000883839",!1,"50432")),i.itp("liveramp_Bombora","1000883799",!1,"50432")),i.itp("liveramp_OnAudience","1002861136",!1,"50432")),i.itp("liveramp_OnAudience","1002861746",!1,"50432")),i.itp("liveramp_OnAudience","1002861566",!1,"50432")))),50438:i.q(i.tw(i.cw(0,i.a([i.y(14,80),i.os(i.s,2,[66,21,"sports-fitness","wildlife-and-nature"])]),i.ge(1)),7776e6)),50442:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"ethiopia")),i.ge(1)),2592e6)),50443:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"mauritius")),i.ge(1)),2592e6)),50444:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"egypt")),i.ge(1)),2592e6)),50445:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.s_(5,"morocco")),i.ge(1)),2592e6)),50446:i.q(i.tw(i.cw(0,i.af_u(["properties","destinations"],i.o([i.s_(5,"south africa"),i.s_(5,"south-africa"),i.s_(5,"south_africa")])),i.ge(1)),2592e6)),50562:i.q(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004268169",!1,"50562"),i.itp("liveramp_OnAudience","1002861946",!1,"50562")),i.itp("eyeota","35721",!1,"50562")),i.itp("liveramp_OnAudience","1002861346",!1,"50562"))),50563:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","35461",!1,"50563"),i.itp("eyeota_statsocial","23114",!1,"50563")),i.itp("liveramp_OnAudience","1002859976",!1,"50563")),i.itp("eyeota","6699",!1,"50563")),i.itp("eyeota","6700",!1,"50563")),i.itp("eyeota","6701",!1,"50563")),i.itp("eyeota","13039",!1,"50563")),i.itp("liveramp_OnAudience","1002859976",!1,"50563")),i.itp("liveramp_PlaceIQ","1002440796",!1,"50563")),i.itp("liveramp_PlaceIQ","1002615636",!1,"50563")),i.itp("eyeota_experian","30158",!1,"50563")),i.itp("liveramp_PlaceIQ","1002437116",!1,"50563")),i.itp("liveramp_PlaceIQ","1002437136",!1,"50563")),i.itp("eyeota","35462",!1,"50563")),i.itp("eyeota","35465",!1,"50563")),i.itp("eyeota","35464",!1,"50563")),i.itp("eyeota","35463",!1,"50563"))),50564:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","35998",!1,"50564"),i.itp("eyeota","35940",!1,"50564")),i.itp("eyeota","13440",!1,"50564")),i.itp("liveramp_PlaceIQ","1002444666",!1,"50564")),i.itp("liveramp_Experian","1004268949",!1,"50564")),i.itp("liveramp_Experian","1004268959",!1,"50564"))),50635:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004269009",!1,"50635"),i.itp("liveramp_Experian","1004269009",!1,"50635")),i.itp("liveramp_Experian","1004269019",!1,"50635")),i.itp("liveramp_StatSocial","1006914631",!1,"50635")),i.itp("liveramp_Mastercard","1005907751",!1,"50635")),i.itp("liveramp_StatSocial","1006914601",!1,"50635")),i.itp("eyeota_experian","27575",!1,"50635")),i.itp("liveramp_Bombora","1000094984",!1,"50635")),i.itp("liveramp_Stirista","1003283999",!1,"50635")),i.itp("liveramp_Experian","1004268919",!1,"50635")),i.itp("liveramp_Experian","1004268919",!1,"50635")))),50692:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","13439",!1,"50692"),i.itp("eyeota","1543",!1,"50692")),i.itp("eyeota","13439",!1,"50692")),i.itp("liveramp_Experian","1004268939",!1,"50692")),i.itp("liveramp_Stirista","1003670389",!1,"50692")),i.itp("eyeota","6739",!1,"50692")),i.itp("liveramp_PlaceIQ","1002444496",!1,"50692")),i.itp("liveramp_PlaceIQ","1002444516",!1,"50692")),i.itp("liveramp_PlaceIQ","1002444506",!1,"50692")),i.itp("liveramp_IPSOS","1004367549",!1,"50692")),i.itp("liveramp_IPSOS","1004367539",!1,"50692")),i.itp("liveramp_Experian","1004268939",!1,"50692"))),50702:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","13438",!1,"50702"),i.itp("eyeota","1574",!1,"50702")),i.itp("eyeota","1728",!1,"50702")),i.itp("liveramp_Mastercard","1005063709",!1,"50702")),i.itp("liveramp_Mastercard","1005063709",!1,"50702")),i.itp("eyeota","36003",!1,"50702")),i.itp("eyeota","35944",!1,"50702")),i.itp("liveramp_Stirista","1001320519",!1,"50702")),i.itp("liveramp_PlaceIQ","1002445216",!1,"50702")),i.itp("liveramp_PlaceIQ","1002445196",!1,"50702")),i.itp("liveramp_PlaceIQ","1002445486",!1,"50702")),i.itp("eyeota","35944",!1,"50702")),i.itp("liveramp_Stirista","1001320519",!1,"50702")),i.itp("liveramp_PlaceIQ","1002445486",!1,"50702")),i.itp("liveramp_Mastercard","1005907021",!1,"50702")),i.itp("liveramp_IPSOS","1004367559",!1,"50702")))),50712:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Stirista","1003717679",!1,"50712"),i.itp("eyeota_mastercard","41861",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440136",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440116",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440036",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440026",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440146",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440126",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440046",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440096",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440086",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440106",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440016",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440156",!1,"50712")),i.itp("liveramp_Kantar","1004779189",!1,"50712")),i.itp("liveramp_Experian","1004268299",!1,"50712")),i.itp("eyeota_experian","39467",!1,"50712")),i.itp("liveramp_Stirista","1003669759",!1,"50712")),i.itp("eyeota_experian","39471",!1,"50712")),i.itp("liveramp_Experian","1004268299",!1,"50712")),i.itp("liveramp_Experian","1004268299",!1,"50712")),i.itp("liveramp_Experian","1004257119",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440206",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440196",!1,"50712")),i.itp("liveramp_PlaceIQ","1002440216",!1,"50712")),i.itp("liveramp_Experian","1004257349",!1,"50712")),i.itp("liveramp_Experian","1004268299",!1,"50712")),i.itp("liveramp_Experian","1004268299",!1,"50712")))),50713:i.q(i.acq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_OnAudience","1002860456",!1,"50713"),i.itp("liveramp_Experian","1004269059",!1,"50713")),i.itp("liveramp_OnAudience","1002861356",!1,"50713")),i.itp("liveramp_Experian","1004601959",!1,"50713")),i.itp("liveramp_OnAudience","1002861486",!1,"50713")),i.itp("eyeota_mastercard","41904",!1,"50713")),i.itp("liveramp_Experian","1004269039",!1,"50713")),i.itp("liveramp_IPSOS","1002977076",!1,"50713")),i.itp("liveramp_Experian","1004269029",!1,"50713")),i.itp("liveramp_Experian","1004269059",!1,"50713")),i.itp("liveramp_Experian","1004269039",!1,"50713")),i.itp("liveramp_StatSocial","1006914541",!1,"50713")),i.itp("liveramp_Bombora","1000094044",!1,"50713")),i.itp("liveramp_Bombora","1000884389",!1,"50713")),i.itp("liveramp_OnAudience","1002861486",!1,"50713")),i.itp("liveramp_Stirista","1004343449",!1,"50713")),i.itp("eyeota","1504",!1,"50713")),i.itp("eyeota","37",!1,"50713")),i.itp("eyeota","6591",!1,"50713")),i.itp("eyeota","35282",!1,"50713")),i.itp("eyeota","12932",!1,"50713")),i.itp("eyeota","35300",!1,"50713")),i.itp("liveramp_Experian","1004261389",!1,"50713")),i.itp("liveramp_Experian","1004261389",!1,"50713")),i.itp("liveramp_IPSOS","1003133196",!1,"50713")),i.itp("eyeota","50",!1,"50713")),i.itp("liveramp_Mastercard","1005908671",!1,"50713")),i.itp("liveramp_IPSOS","1003133026",!1,"50713")),i.itp("liveramp_Bombora","1000884619",!1,"50713")),i.itp("liveramp_PlaceIQ","1002437646",!1,"50713")),i.itp("liveramp_IPSOS","1002976936",!1,"50713")),i.tw(i.cw(0,i.t,i.ge(1)),2592e6))),51619:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.cw(0,i.os(i.s,3,["family","nomad","road trip","road-trip","rv"]),i.ge(1)),i.itp("eyeota","34743",!1,"51619")),i.itp("eyeota","34666",!1,"51619")),i.itp("eyeota","34666",!1,"51619")),i.itp("eyeota","12770",!1,"51619"))),51645:i.q(i.ocq(i.ocq(i.tw(i.cw(0,i.a([i.ref(9),i.ref(17)]),i.ge(1)),7776e6),i.tw(i.cw(0,i.a([i.ref(9),i.af_u(["properties","destinations"],i.s_(15,12))]),i.ge(1)),2592e6)),i.tw(i.cw(0,i.a([i.ps(25,96),i.ref(17)]),i.ge(1)),2592e6))),52010:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","36000",!1,"52010"),i.itp("liveramp_OnAudience","1002862386",!1,"52010")),i.itp("eyeota","13435",!1,"52010")),i.itp("liveramp_ShareThis","1003276339",!1,"52010")),i.itp("eyeota","326",!1,"52010"))),52012:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","35571",!1,"52012"),i.itp("eyeota","35564",!1,"52012")),i.itp("liveramp_Stirista","1003670449",!1,"52012")),i.itp("liveramp_Kantar","1004780349",!1,"52012")),i.itp("liveramp_OnAudience","1002860786",!1,"52012"))),52013:i.q(i.ocq(i.ocq(i.ocq(i.itp("eyeota","35938",!1,"52013"),i.itp("liveramp_Experian","1004785889",!1,"52013")),i.itp("liveramp_Stirista","1003670379",!1,"52013")),i.itp("eyeota","1542",!1,"52013"))),52096:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_OnAudience","1002861556",!1,"52096"),i.itp("liveramp_Stirista","1003670419",!1,"52096")),i.itp("liveramp_StatSocial","1006914581",!1,"52096")),i.itp("liveramp_StatSocial","1006917231",!1,"52096")),i.itp("liveramp_Experian","1004257139",!1,"52096"))),52097:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","36012",!1,"52097"),i.itp("eyeota","1560",!1,"52097")),i.itp("eyeota","35990",!1,"52097")),i.itp("eyeota","13429",!1,"52097")),i.itp("eyeota","13437",!1,"52097")),i.itp("liveramp_Experian","1004785859",!1,"52097")),i.itp("liveramp_Experian","1004785849",!1,"52097")),i.itp("liveramp_Experian","1004785869",!1,"52097")),i.itp("liveramp_Experian","1004860249",!1,"52097")),i.itp("liveramp_Kantar","1004779169",!1,"52097")),i.itp("liveramp_Experian","1004860369",!1,"52097")),i.itp("liveramp_Stirista","1003717679",!1,"52097")),i.itp("eyeota_mastercard","41861",!1,"52097")),i.itp("liveramp_OnAudience","1002860376",!1,"52097")),i.itp("liveramp_Bombora","1000883759",!1,"52097")),i.itp("liveramp_Experian","1004258359",!1,"52097")),i.itp("eyeota","1635",!1,"52097")),i.itp("liveramp_Bombora","1000883999",!1,"52097")),i.itp("liveramp_OnAudience","1002860386",!1,"52097")),i.itp("eyeota","1645",!1,"52097")),i.itp("liveramp_Experian","1004263269",!1,"52097"))),52388:i.q(i.acq(i.cw(0,i.ps(14,80),i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004268919",!1,"52388"),i.itp("eyeota_experian","27573",!1,"52388")),i.itp("liveramp_Experian","1004268919",!1,"52388")),i.itp("liveramp_Experian","1004268919",!1,"52388")),i.itp("eyeota_experian","22032",!1,"52388")),i.itp("liveramp_Mastercard","1005907051",!1,"52388")),i.itp("eyeota_statsocial","23136",!1,"52388")),i.itp("eyeota","1467",!1,"52388")),i.itp("eyeota","35702",!1,"52388")),i.itp("eyeota_mastercard","41088",!1,"52388")),i.itp("liveramp_Mastercard","1005907271",!1,"52388")),i.itp("liveramp_Stirista","1003283999",!1,"52388")),i.itp("liveramp_Mastercard","1005907281",!1,"52388")),i.itp("liveramp_Mastercard","1005063219",!1,"52388")),i.itp("liveramp_Mastercard","1005063229",!1,"52388")),i.itp("liveramp_Mastercard","1005907281",!1,"52388")),i.itp("liveramp_Mastercard","1005063639",!1,"52388")),i.itp("liveramp_Mastercard","1005063639",!1,"52388")),i.itp("liveramp_Mastercard","1005907731",!1,"52388")),i.itp("liveramp_Stirista","1003283999",!1,"52388")),i.itp("eyeota_experian","30587",!1,"52388")),i.itp("liveramp_Mastercard","1005063629",!1,"52388")),i.itp("eyeota_mastercard","39153",!1,"52388")),i.itp("liveramp_Mastercard","1005907281",!1,"52388")),i.itp("eyeota_mastercard","39133",!1,"52388")),i.itp("liveramp_Mastercard","1005063229",!1,"52388")),i.itp("liveramp_Mastercard","1005911741",!1,"52388")))),52396:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_OnAudience","1002860376",!1,"52396"),i.itp("eyeota","1635",!1,"52396")),i.itp("liveramp_Bombora","1000883759",!1,"52396")),i.itp("liveramp_Experian","1004258359",!1,"52396")),i.itp("liveramp_StatSocial","1006911641",!1,"52396")),i.itp("liveramp_StatSocial","1006911641",!1,"52396")),i.itp("liveramp_Mastercard","1005062919",!1,"52396")),i.itp("liveramp_Bombora","1000883759",!1,"52396")),i.itp("liveramp_ShareThis","1001010879",!1,"52396")),i.itp("liveramp_Mastercard","1005063329",!1,"52396")),i.itp("liveramp_Experian","1004258349",!1,"52396")),i.itp("liveramp_Experian","1004785509",!1,"52396"))),52397:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004860249",!1,"52397"),i.itp("liveramp_Experian","1004860249",!1,"52397")),i.itp("liveramp_Kantar","1004779169",!1,"52397")),i.itp("liveramp_PlaceIQ","1002440036",!1,"52397")),i.itp("liveramp_PlaceIQ","1002440026",!1,"52397")),i.itp("liveramp_PlaceIQ","1002440046",!1,"52397")),i.itp("eyeota","35925",!1,"52397")),i.itp("eyeota","1701",!1,"52397")),i.itp("liveramp_Bombora","1000883949",!1,"52397")),i.itp("liveramp_Bombora","1000883949",!1,"52397")),i.itp("eyeota","1700",!1,"52397"))),52398:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","36022",!1,"52398"),i.itp("liveramp_Kantar","1004779169",!1,"52398")),i.itp("liveramp_Experian","1004601979",!1,"52398")),i.itp("eyeota","57",!1,"52398")),i.itp("liveramp_IPSOS","1002976976",!1,"52398")),i.itp("liveramp_ShareThis","1003631569",!1,"52398")),i.itp("liveramp_ShareThis","1001601366",!1,"52398")),i.itp("eyeota","1588",!1,"52398")),i.itp("eyeota","6747",!1,"52398")),i.itp("eyeota","6744",!1,"52398"))),52461:i.q(i.ocq(i.itp("liveramp_PlaceIQ","1002440816",!1,"52461"),i.itp("eyeota_experian","23057",!1,"52461"))),52464:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Yougov","1006310191",!1,"52464"),i.itp("eyeota","35767",!1,"52464")),i.itp("eyeota","35609",!1,"52464")),i.itp("liveramp_DLG","1003697429",!1,"52464")),i.itp("eyeota","13183",!1,"52464")),i.itp("liveramp_Experian","1004268089",!1,"52464")),i.itp("eyeota","35610",!1,"52464")),i.itp("eyeota","1607",!1,"52464"))),52465:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004860729",!1,"52465"),i.itp("liveramp_Experian","1004860729",!1,"52465")),i.itp("liveramp_Experian","1004860729",!1,"52465")),i.itp("eyeota","35789",!1,"52465")),i.itp("liveramp_Experian","1004860269",!1,"52465")),i.itp("eyeota","35295",!1,"52465")),i.itp("liveramp_Yougov","1006302691",!1,"52465")),i.itp("liveramp_Bombora","1005388449",!1,"52465")),i.itp("eyeota","1649",!1,"52465")),i.itp("eyeota","12967",!1,"52465")),i.itp("eyeota","35295",!1,"52465")),i.itp("liveramp_ShareThis","1005132939",!1,"52465")),i.itp("liveramp_ShareThis","1001014439",!1,"52465")),i.itp("liveramp_Stirista","1003717679",!1,"52465")),i.itp("liveramp_ShareThis","1001601906",!1,"52465")),i.itp("liveramp_ShareThis","1001009579",!1,"52465")),i.itp("eyeota","1649",!1,"52465")),i.itp("liveramp_Experian","1004259069",!1,"52465")),i.itp("eyeota","35789",!1,"52465"))),52466:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","4001",!1,"52466"),i.itp("eyeota","35628",!1,"52466")),i.itp("liveramp_Stirista","1006352111",!1,"52466")),i.itp("liveramp_Stirista","1004374109",!1,"52466")),i.itp("liveramp_Stirista","1004375249",!1,"52466")),i.itp("eyeota","3999",!1,"52466")),i.itp("eyeota","3986",!1,"52466")),i.itp("eyeota","4005",!1,"52466"))),52483:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.o([i.ps(19,68),i.ps(23,68),i.ps(4,68),i.ps(3,68),i.ps(7,68),i.ps(6,68)]),i.ge(1)),2592e6),i.itp("eyeota","13438",!1,"52483")),i.itp("eyeota","1574",!1,"52483")),i.itp("eyeota","1728",!1,"52483")),i.itp("eyeota","36003",!1,"52483")),i.itp("eyeota","35944",!1,"52483")),i.itp("liveramp_Stirista","1001320519",!1,"52483")),i.itp("liveramp_Mastercard","1005907021",!1,"52483")),i.itp("liveramp_Bombora","1005405099",!1,"52483")),i.itp("liveramp_IPSOS","1004367569",!1,"52483")),i.itp("eyeota","302",!1,"52483"))),56605:i.q(i.ocq(i.tw(i.cw(0,i.os(i.s,3,[118,119]),i.ge(1)),2592e6),i.tw(i.cw(0,i.os(i.s,19,[118,119]),i.ge(1)),2592e6))),56798:i.q(i.tw(i.cw(0,i.o([i.y(4,53),i.ps(2,53),i.ps(3,53),i.ps(7,53),i.ps(6,53),i.ps(8,53),i.af_u(["properties","destinations"],i.y_(1,53))]),i.ge(1)),2592e6)),56801:i.q(i.cw(0,i.y(14,80),i.ge(1))),56802:i.q(i.cw(0,i.pe(14,"Australia"),i.ge(1))),56803:i.q(i.cw(0,i.pe(14,"Canada"),i.ge(1))),56804:i.q(i.cw(0,i.pe(14,"India"),i.ge(1))),57571:i.q(i.tw(i.cw(0,i.o([i.y(4,59),i.ps(2,59),i.ps(3,59),i.ps(7,59),i.ps(6,59),i.ps(8,59),i.af_u(["properties","destinations"],i.y_(1,59))]),i.ge(1)),2592e6)),60307:i.q(i.tw(i.cw(0,i.o([i.y(4,49),i.ps(2,49),i.ps(3,49),i.ps(7,49),i.ps(6,49),i.ps(8,49),i.af_u(["properties","destinations"],i.y_(1,49))]),i.ge(1)),2592e6)),60308:i.q(i.tw(i.cw(0,i.o([i.y(4,46),i.ps(2,46),i.ps(3,46),i.ps(7,46),i.ps(6,46),i.ps(8,46),i.af_u(["properties","destinations"],i.y_(1,46))]),i.ge(1)),2592e6)),60309:i.q(i.tw(i.cw(0,i.o([i.y(4,60),i.ps(2,60),i.ps(3,60),i.ps(7,60),i.ps(6,60),i.ps(8,60),i.af_u(["properties","destinations"],i.y_(1,60))]),i.ge(1)),2592e6)),60310:i.q(i.tw(i.cw(0,i.o([i.y(4,51),i.ps(2,51),i.ps(3,51),i.ps(7,51),i.ps(6,51),i.ps(8,51),i.af_u(["properties","destinations"],i.y_(1,51))]),i.ge(1)),2592e6)),60311:i.q(i.tw(i.cw(0,i.o([i.y(4,48),i.ps(2,48),i.ps(3,48),i.ps(7,48),i.ps(6,48),i.ps(8,48),i.af_u(["properties","destinations"],i.y_(1,48))]),i.ge(1)),2592e6)),60312:i.q(i.tw(i.cw(0,i.o([i.y(4,45),i.ps(2,45),i.ps(3,45),i.ps(7,45),i.ps(6,45),i.ps(8,45),i.af_u(["properties","destinations"],i.y_(1,45))]),i.ge(1)),2592e6)),60313:i.q(i.tw(i.cw(0,i.o([i.y(4,50),i.ps(2,50),i.ps(3,50),i.ps(7,50),i.ps(6,50),i.ps(8,50),i.af_u(["properties","destinations"],i.y_(1,50))]),i.ge(1)),2592e6)),60315:i.q(i.tw(i.cw(0,i.o([i.y(4,42),i.ps(2,42),i.ps(3,42),i.ps(7,42),i.ps(6,42),i.ps(8,42),i.af_u(["properties","destinations"],i.y_(1,42))]),i.ge(1)),2592e6)),60316:i.q(i.tw(i.cw(0,i.o([i.y(4,40),i.ps(2,40),i.ps(3,40),i.ps(7,40),i.ps(6,40),i.ps(8,40),i.af_u(["properties","destinations"],i.y_(1,40))]),i.ge(1)),2592e6)),60317:i.q(i.tw(i.cw(0,i.o([i.y(4,41),i.ps(2,41),i.ps(3,41),i.ps(7,41),i.ps(6,41),i.ps(8,41),i.af_u(["properties","destinations"],i.y_(1,41))]),i.ge(1)),2592e6)),60318:i.q(i.tw(i.cw(0,i.o([i.y(4,44),i.ps(2,44),i.ps(3,44),i.ps(7,44),i.ps(6,44),i.ps(8,44),i.af_u(["properties","destinations"],i.y_(1,44))]),i.ge(1)),2592e6)),60319:i.q(i.tw(i.cw(0,i.o([i.y(4,43),i.ps(2,43),i.ps(3,43),i.ps(7,43),i.ps(6,43),i.ps(8,43),i.af_u(["properties","destinations"],i.y_(1,43))]),i.ge(1)),2592e6)),60321:i.q(i.tw(i.cw(0,i.o([i.os(i.w,21,[91,90,20]),i.os(i.w,18,[91,90,20]),i.os(i.w,24,[91,90,20]),i.os(i.s,2,[62,20,63]),i.os(i.s,26,[62,20,63]),i.os(i.s,3,[62,20,63]),i.os(i.s,22,[62,20,63]),i.os(i.s,28,[62,20,63]),i.os(i.s,8,[62,20,63]),i.af_u(["properties","destinations"],i.o([i.s_(16,62),i.s_(16,20),i.s_(16,63)]))]),i.ge(1)),2592e6)),62400:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_OnAudience","1002863136",!1,"62400"),i.itp("liveramp_Experian","1004271919",!1,"62400")),i.itp("liveramp_PlaceIQ","1002440116",!1,"62400")),i.itp("eyeota","4001",!1,"62400")),i.itp("liveramp_ShareThis","1003627259",!1,"62400")),i.itp("liveramp_Experian","1004860329",!1,"62400")))),66937:i.q(i.acq(i.tw(i.cw(0,i.t,i.ge(1)),2592e6),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("eyeota","228",!1,"66937"),i.itp("liveramp_Experian","1004999699",!1,"66937")),i.itp("eyeota","35429",!1,"66937")),i.itp("eyeota","11209",!1,"66937")),i.itp("eyeota","6674",!1,"66937")),i.itp("eyeota","227",!1,"66937")),i.itp("eyeota","293",!1,"66937")),i.itp("eyeota","35441",!1,"66937")),i.itp("eyeota","35452",!1,"66937")),i.itp("eyeota","35440",!1,"66937")),i.itp("eyeota","35453",!1,"66937")),i.itp("comscore","221346US",!1,"66937")),i.itp("comscore","221997US",!1,"66937")),i.itp("comscore","121346US",!1,"66937")),i.itp("comscore","121997US",!1,"66937")),i.itp("comscore","321346US",!1,"66937")),i.itp("comscore","321997US",!1,"66937")),i.itp("liveramp_Experian","1005797791",!1,"66937")),i.itp("liveramp_Experian","1005797881",!1,"66937")),i.itp("liveramp_Experian","1005797801",!1,"66937")),i.itp("liveramp_Experian","1005797871",!1,"66937")))),70363:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_ShareThis","1001600416",!1,"70363"),i.itp("liveramp_Bombora","1003152039",!1,"70363")),i.itp("liveramp_Experian","1004578559",!1,"70363")),i.itp("eyeota","1464",!1,"70363")),i.itp("eyeota","1464",!1,"70363")),i.itp("eyeota","12849",!1,"70363")),i.itp("liveramp_Experian","1004577719",!1,"70363")),i.itp("liveramp_ShareThis","1003592969",!1,"70363")),i.itp("liveramp_ShareThis","1003592979",!1,"70363")),i.itp("eyeota","12849",!1,"70363")),i.itp("eyeota","34737",!1,"70363")),i.itp("eyeota","34806",!1,"70363")),i.itp("liveramp_Experian","1004577719",!1,"70363")),i.itp("liveramp_Experian","1007227741",!1,"70363")),i.itp("liveramp_Experian","1004580579",!1,"70363")),i.itp("liveramp_Experian","1007227191",!1,"70363")),i.itp("liveramp_Experian","1004580569",!1,"70363")),i.itp("liveramp_Experian","1007227751",!1,"70363"))),70364:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1004578069",!1,"70364"),i.itp("liveramp_Experian","1004782949",!1,"70364")),i.itp("liveramp_Experian","1004782929",!1,"70364")),i.itp("liveramp_Experian","1004578079",!1,"70364")),i.itp("liveramp_Experian","1004578089",!1,"70364")),i.itp("liveramp_DunandBradstreet","1001203919",!1,"70364")),i.itp("liveramp_DunandBradstreet","1001203919",!1,"70364")),i.itp("liveramp_Experian","1007228341",!1,"70364"))),70757:i.q(i.cw(0,i.t,i.ge(1))),83115:i.q(i.tw(i.cw(0,i.ref(10),i.ge(1)),7776e6)),83206:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_IPSOS","1002976996",!1,"83206"),i.itp("liveramp_ShareThis","1006581961",!1,"83206")),i.itp("liveramp_ShareThis","1006582361",!1,"83206")),i.itp("comscore","2millUS",!1,"83206")),i.itp("comscore","3millUS",!1,"83206")),i.itp("comscore","1millUS",!1,"83206")),i.itp("liveramp_Experian","1007229001",!1,"83206")),i.itp("liveramp_ShareThis","1006582321",!1,"83206")),i.itp("liveramp_ShareThis","1006581921",!1,"83206")),i.itp("liveramp_Experian","1004257089",!1,"83206")),i.itp("liveramp_ShareThis","1005133389",!1,"83206"))),83208:i.q(i.acq(i.tw(i.cw(0,i.af_i(["properties","pois"],i.e_(["name"],"City Walls & Forts")),i.ge(1)),7776e6),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_Experian","1001291009",!1,"83208"),i.itp("liveramp_ShareThis","1001290399",!1,"83208")),i.itp("liveramp_Experian","1001286319",!1,"83208")),i.itp("liveramp_RoyMorgan","1002214386",!1,"83208")),i.itp("liveramp_OnAudience","1002860996",!1,"83208")),i.itp("liveramp_ShareThis","1001326789",!1,"83208")))),83440:i.q(i.tw(i.cw(0,i.ref(25),i.ge(1)),7776e6)),83512:i.q(i.acq(i.cw(0,i.t,i.ge(1)),i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.itp("liveramp_ShareThis","1003627039",!1,"83512"),i.itp("eyeota","35934",!1,"83512")),i.itp("liveramp_Stirista","1000044934",!1,"83512")),i.itp("liveramp_Bombora","1005405079",!1,"83512")),i.itp("liveramp_ShareThis","1003555939",!1,"83512")),i.itp("liveramp_ShareThis","1004108209",!1,"83512")),i.itp("comscore","318346US",!1,"83512")),i.itp("comscore","118346US",!1,"83512")),i.itp("liveramp_Bombora","1000883929",!1,"83512")),i.cw(0,i.o([i.os(i.s,19,[72]),i.os(i.s,23,[72]),i.os(i.s,2,[72]),i.os(i.s,["name"],[72]),i.os(i.s,8,[72])]),i.ge(1))))),83971:i.q(i.cw(0,i.o([i.af_u(["properties","articles"],i.ref(29),i.ref(15)),i.af_u(["properties","articles"],i.ref(30),i.ref(15))]),i.ge(1))),84279:i.q(i.tw(i.cw(0,i.ref(13),i.ge(1)),7776e6)),84282:i.q(i.tw(i.cw(0,i.ref(21),i.ge(1)),7776e6)),84283:i.q(i.tw(i.cw(0,i.ref(11),i.ge(1)),7776e6)),84284:i.q(i.tw(i.cw(0,i.ref(20),i.ge(1)),7776e6)),84406:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.ref(20),i.ge(1)),7776e6),i.itp("liveramp_OnAudience","1002863866",!1,"84406")),i.itp("liveramp_OnAudience","1002862366",!1,"84406")),i.itp("liveramp_Experian","1004860669",!1,"84406")),i.itp("liveramp_Yougov","1006310191",!1,"84406")),i.itp("eyeota","35984",!1,"84406")),i.itp("liveramp_Acxiom","15613",!1,"84406")),i.itp("liveramp_Acxiom","300575199",!1,"84406")),i.isp("liveramp_KANTAR_lonely_planet","1008050751",!1,"84406")),i.isp("liveramp_EXPERIAN_lonely_planet","1008904831",!1,"84406"))),84407:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.ref(11),i.ge(1)),7776e6),i.itp("liveramp_Experian","1004860669",!1,"84407")),i.itp("liveramp_ShareThis","1005133039",!1,"84407")),i.itp("eyeota","35944",!1,"84407")),i.itp("liveramp_IPSOS","1004367559",!1,"84407")),i.itp("eyeota","35848",!1,"84407")),i.itp("eyeota","36000",!1,"84407")),i.itp("eyeota","13427",!1,"84407")),i.itp("eyeota","35984",!1,"84407")),i.itp("eyeota","1724",!1,"84407")),i.itp("liveramp_Acxiom","300727999",!1,"84407")),i.itp("liveramp_Acxiom","300575199",!1,"84407")),i.itp("liveramp_Acxiom","15613",!1,"84407")),i.isp("liveramp_EXPERIAN_lonely_planet","1008904831",!1,"84407")),i.isp("liveramp_KANTAR_lonely_planet","1006096321",!1,"84407")),i.itp("liveramp_Kantar","1004779179",!1,"84407")),i.itp("liveramp_Acxiom","1005525689",!1,"84407"))),84408:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.ref(21),i.ge(1)),7776e6),i.itp("liveramp_ShareThis","1001009159",!1,"84408")),i.itp("liveramp_ShareThis","1003631539",!1,"84408")),i.itp("liveramp_Stirista","1003670419",!1,"84408")),i.itp("liveramp_StatSocial","1006914581",!1,"84408")),i.itp("liveramp_Acxiom","10884",!1,"84408")),i.itp("liveramp_Acxiom","300728499",!1,"84408")),i.itp("liveramp_Acxiom","1005525709",!1,"84408")),i.itp("liveramp_Acxiom","1005525649",!1,"84408")),i.isp("liveramp_KANTAR_lonely_planet","1008050751",!1,"84408")),i.isp("liveramp_EXPERIAN_lonely_planet","1008904881",!1,"84408"))),84409:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.ref(13),i.ge(1)),7776e6),i.itp("liveramp_Experian","1004860669",!1,"84409")),i.itp("liveramp_IPSOS","1004367559",!1,"84409")),i.itp("liveramp_ShareThis","1001015119",!1,"84409")),i.itp("liveramp_ShareThis","1003631579",!1,"84409")),i.itp("liveramp_Experian","1004860249",!1,"84409")),i.itp("liveramp_Experian","1004860589",!1,"84409")),i.itp("liveramp_StatSocial","1006914581",!1,"84409")),i.itp("liveramp_Yougov","1006281361",!1,"84409")),i.itp("liveramp_Acxiom","300575199",!1,"84409")),i.itp("liveramp_Acxiom","15613",!1,"84409")),i.isp("liveramp_EXPERIAN_lonely_planet","1008904831",!1,"84409")),i.isp("liveramp_KANTAR_lonely_planet","1008050751",!1,"84409"))),84410:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.ref(25),i.ge(1)),7776e6),i.itp("eyeota","35944",!1,"84410")),i.itp("liveramp_IPSOS","1004367559",!1,"84410")),i.itp("liveramp_ShareThis","1003276329",!1,"84410")),i.itp("eyeota","1728",!1,"84410")),i.itp("liveramp_ShareThis","1003631519",!1,"84410")),i.itp("liveramp_Experian","1004860669",!1,"84410")),i.itp("liveramp_Yougov","1006281361",!1,"84410")),i.itp("liveramp_Acxiom","300575199",!1,"84410")),i.itp("liveramp_Acxiom","300727999",!1,"84410")),i.isp("liveramp_KANTAR_lonely_planet","1006096321",!1,"84410")),i.isp("liveramp_EXPERIAN_lonely_planet","1008904831",!1,"84410"))),84411:i.q(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.ocq(i.tw(i.cw(0,i.ref(10),i.ge(1)),7776e6),i.itp("eyeota","1570",!1,"84411")),i.itp("liveramp_IPSOS","1004367559",!1,"84411")),i.itp("liveramp_Kantar","1005776781",!1,"84411")),i.itp("liveramp_Yougov","1006309891",!1,"84411")),i.itp("liveramp_Acxiom","300573299",!1,"84411")),i.itp("liveramp_Acxiom","300573399",!1,"84411")),i.itp("liveramp_Acxiom","300727999",!1,"84411")),i.itp("liveramp_Acxiom","15613",!1,"84411")),i.isp("liveramp_EXPERIAN_lonely_planet","1008904781",!1,"84411")),i.itp("liveramp_Acxiom","1005525689",!1,"84411")),i.itp("liveramp_Kantar","1004779179",!1,"84411"))),90207:i.q(i.cw(0,i.o([i.ps(["article","type"],116),i.ps(2,116),i.os(i.s,25,[95]),i.os(i.s,3,[95]),i.os(i.s,8,[95])]),i.ge(1))),94436:i.q(i.acq(i.tw(i.cw(0,i.y(14,92),i.ge(1)),290304e5),i.itp("liveramp_Experian","1004263699",!1,"94436")))}||{},queriesByEvent:{"!UpdateSecondPartyData":["84406","84407","84408","84409","84410","84411"],"!UpdateThirdPartyData":["46274","47174","47282","47292","47297","47650","47651","47652","47730","47749","47750","47751","47752","47753","47756","47846","47863","47864","47865","47943","47944","47945","50432","50562","50563","50564","50635","50692","50702","50712","50713","51619","52010","52012","52013","52096","52097","52388","52396","52397","52398","52461","52464","52465","52466","52483","62400","66937","70363","70364","83206","83208","83512","84406","84407","84408","84409","84410","84411","94436"],LinkClick:["24996"],Pageview:["10000000","10000001","10000002","10000003","10000004","10000005","10000006","10000007","10000008","10000010","10000011","10000012","10000013","10000014","10000015","10000016","10000017","10000018","10000019","10000020","10000021","10000022","10000023","10000024","10000025","10000026","10000035","10000036","10000037","10000038","10000039","10000040","10000041","10000042","10000043","10000044","10000045","10000046","10000047","10000048","10000049","10000050","10000051","10000052","10000053","10000054","10000055","10000056","10000057","10000058","10000059","10000060","10000061","10000062","10000063","10000064","10000065","10000066","10000067","10000068","10000069","10000070","10000071","10000072","10000073","10000074","10000075","10000076","10000077","10000078","10000079","10000080","10000081","10000082","10000083","10000084","10000085","10000086","10000087","10000088","10000089","10000090","10000324","10000325","10000327","10000328","10000329","10000330","122660","23918","24040","47174","47281","47292","47296","47628","47650","47653","47654","47721","47723","47733","47734","47736","47749","47750","47751","47752","47753","47755","47756","47846","47862","47894","47895","47896","47897","47898","47899","47900","47901","47903","47917","47918","47919","47920","47921","47922","47923","47924","47925","47926","47929","47930","47931","47932","47933","47934","47935","47936","47937","47938","47939","47940","47941","47942","48010","48261","48262","48263","48264","48265","48266","48267","48309","49048","49050","49052","49089","49109","49149","50432","50438","50442","50443","50444","50445","50446","50635","50702","50712","50713","51619","51645","52388","52483","56605","56798","56801","56802","56803","56804","57571","60307","60308","60309","60310","60311","60312","60313","60315","60316","60317","60318","60319","60321","62400","66937","70757","83115","83208","83440","83512","83971","84279","84282","84283","84284","84406","84407","84408","84409","84410","84411","90207","94436"]}||{}}}();!function(e){const t=self;function n(e,n,r,i){function o(n){if("function"!=typeof t.postMessage)return e.ports[0].postMessage(n);t.postMessage(n)}if(!r)return o([n,null,i]);"undefined"!=typeof console&&"error"in console&&console.error("Worker caught an error:",r),o([n,r])}t.addEventListener("message",(function(t){if(r=t,!Array.isArray(r.data)||2!==r.data.length)return;var r;const i=t.data,[o,a]=i;if("function"==typeof e)return function(e,t,r,i){const o=function(e,t){try{return{res:e(t)}}catch(e){return{err:e}}}(t,i);return Boolean(null===(a=o)||void 0===a?void 0:a.err)?n(e,r,o.err):!(c=o.res)||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof c.then?n(e,r,null,o.res):void o.res.then((function(t){n(e,r,null,t)}),(function(t){n(e,r,t)}));var a,c}(t,e,o,a);n(t,o,new Error("Please pass a function into register()."))}))}((function(e){return((e,t)=>Nt(bn(e,t),(t=>Object.assign(Object.assign({},t),{userId:e.userId}))))(e,xn)}))})();',"Worker",void 0,void 0)}var c=i(655);const u=()=>({kind:"null",value:null}),l=e=>({kind:"string",value:e}),p=e=>({kind:"number",value:e}),d=e=>({kind:"array",value:e}),_=e=>({kind:"object",value:e}),g=e=>e,m=()=>({kind:"bottom"}),f=e=>({kind:"inner",a:e}),h=e=>({kind:"top",error:e}),v=e=>({kind:"unbounded",group:e}),y=(e,t)=>({kind:"windowed",key:t,group:e}),w=(e,t,i)=>({kind:"countLimit",n:i,limit:t,group:e}),b=(e,t,i)=>({kind:"uniqueLimit",n:i,limit:t,group:e}),q=e=>({kind:"numberGroup",group:e}),k=e=>({kind:"stringGroup",group:e}),E=e=>({kind:"tuple",tuple:e}),P=e=>({state:e}),S=(e,t)=>({commands:e,payload:t});function O(e){return e}function D(e,t,i,n,r,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return i(t(e));case 4:return n(i(t(e)));case 5:return r(n(i(t(e))));case 6:return o(r(n(i(t(e)))));case 7:return s(o(r(n(i(t(e))))));case 8:return a(s(o(r(n(i(t(e)))))));case 9:return c(a(s(o(r(n(i(t(e))))))));default:for(var u=arguments[0],l=1;l<arguments.length;l++)u=arguments[l](u);return u}}var M=function(e){return{equals:function(t,i){return t===i||e(t,i)}}},I=function(e){return M((function(t,i){for(var n in e)if(!e[n].equals(t[n],i[n]))return!1;return!0}))},x=function(e){return function(t,i){return t===i||0===e(t,i)}},T=function(e){return{equals:x(e),compare:function(t,i){return t===i?0:e(t,i)}}},A=function(e){return function(t){return T((function(i,n){return t.compare(e(i),e(n))}))}},C=function(e){return function(t,i){return-1===e.compare(t,i)}},U=function(e){return function(t,i){return 1===e.compare(t,i)}},j=function(e){return function(t,i){return t===i||e.compare(t,i)>-1?t:i}};var L={equals:function(e,t){return e===t}},R={equals:L.equals,compare:function(e,t){return e<t?-1:e>t?1:0}};const B=(e,t)=>{switch(e.kind){case"bottom":return{kind:"bottom"};case"inner":return f(t(e.a));case"top":return h(e.error)}},G=e=>T(((t,i)=>{if("bottom"===t.kind&&"bottom"===i.kind)return 0;if("bottom"===t.kind)return-1;if("bottom"===i.kind)return 1;if("top"===t.kind&&"top"===i.kind)return R.compare(t.error,i.error);if("top"===t.kind)return 1;if("top"===i.kind)return-1;if("inner"===t.kind&&"inner"===i.kind)return e.compare(t.a,i.a);throw new Error("Non exhaustive match in extendedAlgebraOrd")}));var N=function(e,t){for(var i=0,n=t.length,r=e.length;i<n;i++,r++)e[r]=t[i];return e},K=function(e){return"Some"===e._tag},W={_tag:"None"},$=function(e){return{_tag:"Some",value:e}},z=function(e){return"Left"===e._tag},Q=(Object.prototype.hasOwnProperty,function(e){return N([e[0]],e.slice(1))});var F=W,J=$;function Y(e){return function(t){return e(t)?J(t):F}}var H=function(e){return"Left"===e._tag?F:J(e.right)},V=function(e){return{equals:function(t,i){return t===i||(ie(t)?ie(i):!ie(i)&&e.equals(t.value,i.value))}}},X=function(e){return{equals:V(e).equals,compare:function(t,i){return t===i?0:te(t)?te(i)?e.compare(t.value,i.value):1:-1}}},Z=function(e){return function(t){return ie(t)?F:J(e(t.value))}},ee=H,te=K,ie=function(e){return"None"===e._tag},ne=function(e){return function(t){return ie(t)?e():t.value}};var re;re=void 0;var oe=function(e){return e[0]},se=oe;var ae=function(e,t){for(var i=0,n=t.length,r=e.length;i<n;i++,r++)e[r]=t[i];return e},ce=function(e){return e.length>0},ue=function(e,t){return e<0||e>=t.length},le=function(e){return function(t){return ae([e],t)}},pe=le,de=function(e){return function(t){return ae(ae([],t),[e])}},_e=de,ge=Q,me=function(e){return ce(e)?$(e):W},fe=function(e){return function(t){for(var i=Math.max(0,Math.floor(t)),n=[e(0)],r=1;r<i;r++)n.push(e(r));return n}};var he=ge;var ve=function(e){return function(t){var i=Math.max(1,e);return i>=t.length?[he(t),[]]:[D(t.slice(1,i),pe(we(t))),t.slice(i)]}},ye=function(e){return M((function(t,i){return t.length===i.length&&t.every((function(t,n){return e.equals(t,i[n])}))}))},we=se;var be={equals:function(e,t){return e===t}},qe={equals:be.equals,compare:function(e,t){return e<t?-1:e>t?1:0}};var ke=function(e,t){return function(i){for(var n=i.length,r=e,o=0;o<n;o++)r=t(o,r,i[o]);return r}};var Ee=function(e){return 0===e.length},Pe=ce,Se=pe,Oe=_e,De=function(e,t){return e<=0?[]:fe(t)(e)};var Me=ue,Ie=function(e){return function(t){return Me(e,t)?Ae(t):t.slice(0,e)}};var xe=function(e,t){for(var i=e.length,n=0;n<i&&t(e[n]);n++);return n};var Te=function(e){return function(t){return e<=0||Ee(t)?Ae(t):e>=t.length?[]:t.slice(e,t.length)}};var Ae=function(e){return e.slice()},Ce=function(e){return Ee(e)?[]:e.slice().reverse()},Ue=function(e){return function(t){return t.length<=1?Ae(t):t.slice().sort(e.compare)}},je=function(e,t,i){for(var n=[],r=Math.min(e.length,t.length),o=0;o<r;o++)n[o]=i(e[o],t[o]);return n};var Le=function(e){return function(t){return e>=1&&Pe(t)?ve(e)(t):Ee(t)?[Ae(t),[]]:[[],Ae(t)]}};var Re=function(e){return function(t){return D(t,function(e){return function(t){for(var i=[],n=0;n<t.length;n++)i.push.apply(i,e(n,t[n]));return i}}((function(t,i){return e(i)})))}},Be=function(e){return function(t){for(var i=[],n=0;n<t.length;n++){var r=e(n,t[n]);K(r)&&i.push(r.value)}return i}},Ge=function(e){return Be((function(t,i){return e(i)}))},Ne=Ge(O),Ke=ke,We=function(e){var t=$e(e);return function(e){return t((function(t,i){return e(i)}))}},$e=function(e){return function(t){return Ke(e.of([]),(function(i,n,r){return e.ap(e.map(n,(function(e){return function(t){return D(e,Oe(t))}})),t(i,r))}))}},ze=function(e){return T((function(t,i){for(var n=t.length,r=i.length,o=Math.min(n,r),s=0;s<o;s++){var a=e.compare(t[s],i[s]);if(0!==a)return a}return qe.compare(n,r)}))},Qe=function(e){return{_tag:"Left",left:e}},Fe=function(e){return{_tag:"Right",right:e}},Je=function(e,t){return D(e,Ve(t))},Ye=function(e,t){return D(e,Ze(t))},He="Either",Ve=function(e){return function(t){return tt(t)?t:Fe(e(t.right))}},Xe=Fe,Ze=function(e){return function(t){return tt(t)?t:tt(e)?e:Fe(t.right(e.right))}},et={URI:He,map:Je,ap:Ye,of:Xe},tt=z;var it=function(e){return-1===e?1:1===e?-1:0};function nt(e,t){return Ne(e.map(t))}function rt(e,t,i,n){const r=(e,t)=>{if(0===e.length)return Ne(t.map((e=>J({1:e[1],2:i(F,J(e[2]))}))));if(0===t.length)return Ne(e.map((e=>J({1:e[1],2:i(J(e[2]),F)}))));if(e.length>0&&t.length>0&&C(n)(e[0][1],t[0][1])){const[n,...o]=e,s=n[1],a=n[2];return Se({1:s,2:i(J(a),F)})(r(o,t))}if(e.length>0&&t.length>0&&U(n)(e[0][1],t[0][1])){const[n,...o]=t,s=n[1],a=n[2];return Se({1:s,2:i(F,J(a))})(r(e,o))}if(e.length>0&&t.length>0){const[n,...o]=e,[s,...a]=t,c=n[1],u=n[2],l=s[2];return Se({1:c,2:i(J(u),J(l))})(r(o,a))}throw new Error("Non exhaustive match in mapOption2")},o=A((e=>e[1]))(n),s=(e=>{const t=nt(e,(e=>te(e[2])?J({1:e[1],2:e[2].value}):F));return 0===t.length?F:J(t)})(r(Ue(o)([...e].map((e=>({1:e[0],2:e[1]})))),Ue(o)([...t].map((e=>({1:e[0],2:e[1]}))))));return Z((e=>new Map(e.map((e=>[e[1],e[2]])))))(s)}function ot(e,t,i,n){const r=A((e=>e[0]))(n),o=Ue(r)([...t]).reduceRight(((e,t)=>{if(tt(e)){const n=i(t[1],e.left);return te(n)?Qe(n.value):Fe(t[0])}return e}),Qe(e));return ee(o)}function st(e,t){return new Map([...e].map(t))}function at(e,t){return new Map([...e].filter(t))}function ct(e){return JSON.stringify(ut(e))}function ut(e){switch(e.kind){case"null":return dt.encode(e);case"string":return _t.encode(e);case"number":return gt.encode(e);case"array":return mt.encode(e);case"object":return ft.encode(e)}}function lt(e){return null===e?dt.decode(e):"number"==typeof e?gt.decode(e):"string"==typeof e?_t.decode(e):Array.isArray(e)?mt.decode(e):ft.decode(e)}const pt=(e,t)=>Qe(`Failed to decode. Input was ${JSON.stringify(e)}. Codec type was ${t}`),dt={encode:e=>null,decode:e=>null===e?Fe({kind:"null",value:null}):pt(e,"SimpleNull")},_t={encode:e=>e.value,decode:e=>"string"==typeof e?Fe(l(e)):pt(e,"SimpleString")},gt={encode:e=>e.value,decode:e=>"number"==typeof e?Fe(p(e)):pt(e,"SimpleNumber")},mt={encode:e=>e.value.map(ut),decode:e=>{if(Array.isArray(e)){const t=We(et)(lt)(e);return Ve(d)(t)}return pt(e,"SimpleArray")}},ft={encode:e=>{const t=[...e.value.entries()];return Object.assign({},...Array.from(t,(([e,t])=>({[e]:ut(t)}))))},decode:e=>{if(e&&e.constructor===Object){const t=We(et)((([e,t])=>D(lt(t),Ve((t=>function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}(e,t))))))(Object.entries(e));return Ve((e=>_(new Map([...e]))))(t)}return pt(e,"SimpleObject")}};function ht(e){return D(e,yt,Z(ct),ne((()=>"<encode error>")))}function vt(e){return Z(Pt)(function(e){switch(e.state.kind){case"top":return J(l(e.state.error));case"bottom":return F;case"inner":return yt(e.state.a)}}(e))}function yt(e){return function(e){switch(e.kind){case"numberGroup":case"stringGroup":return wt(e.group);case"tuple":return e.tuple.length>0}}(e.payload)?J(d(function(e,t){const i=Z((e=>Se(e)(t)))(e);return ne((()=>t))(i)}(Z((e=>l(function(e){const t=e=>{switch(e){case"add":return"p";case"mul":return"m";case"max":return"v";case"min":return"n"}},i=e=>1===e[2]?t(e[1]):t(e[1])+JSON.stringify(e[2]);return e.map(i).join("")}(e))))(e.commands),function(e){const t=e=>{switch(e.kind){case"bottom":return{kind:"null",value:null};case"top":return l(e.error);case"inner":return p(e.a)}},i=e=>nt([bt,qt,e=>D(e,Et,_,J)],(t=>t(e))),n=e=>nt([bt,kt,e=>D(e,Et,(e=>st(e,(([e,t])=>[JSON.stringify(e),t]))),_,J)],(t=>t(e)));switch(e.kind){case"tuple":return e.tuple.map(t);case"stringGroup":return i(e.group);case"numberGroup":return n(e.group)}}(e.payload)))):F}function wt(e){switch(e.kind){case"unbounded":return e.group.size>0;case"windowed":return e.group.size>0||te(e.key);case"countLimit":case"uniqueLimit":return e.group.size>0||te(e.limit)}}function bt(e){switch(e.kind){case"unbounded":return F;case"windowed":return J(l("w"));case"countLimit":return J(l(1===e.n?"x":`x${e.n}`));case"uniqueLimit":return J(l(1===e.n?"u":`u${e.n}`))}}function qt(e){switch(e.kind){case"unbounded":return F;case"windowed":return J(l(te(e.key)?e.key.value:""));case"countLimit":case"uniqueLimit":return J(l(te(e.limit)?e.limit.value:""))}}function kt(e){switch(e.kind){case"unbounded":return F;case"windowed":return te(e.key)?J(p(e.key.value)):J({kind:"null",value:null});case"countLimit":case"uniqueLimit":return te(e.limit)?J(p(e.limit.value)):J({kind:"null",value:null})}}function Et(e){switch(e.kind){case"unbounded":case"windowed":case"countLimit":case"uniqueLimit":return e.group}}function Pt(e){switch(e.kind){case"array":return 0===e.value.length?{kind:"null",value:null}:1===e.value.length?Pt(e.value[0]):d(e.value.map(Pt));case"object":return D(at(e.value,(([e,t])=>"null"!==t.kind)),(e=>st(e,(e=>[e[0],Pt(e[1])]))),_);default:return e}}function St(e){const t=e=>{if(0===e.length)return{kind:"bottom"};const t=(e=>{if(4!==e.length)return F;const[t,i,n,r]=e;if("string"===t.kind&&"string"===i.kind&&"object"===r.kind){const e=Y((e=>Ot(e[1].value)&&Dt(e[2].value)))({1:t,2:i});return Z((e=>({prim:e[1].value,grp:e[2].value,cutoff:n,m:r.value})))(e)}return F})(e);if(te(t)){const{prim:e,grp:i,cutoff:n,m:r}=t.value,o=Mt(n,r,It(i));return"string"==typeof o?h(o):f(S(xt(e),o))}const i=(e=>{if(3!==e.length)return F;const[t,i,n]=e;if("string"===t.kind&&"object"===n.kind){const e=Y((e=>Dt(e.value)))(t);return Z((e=>({grp:e.value,cutoff:i,m:n.value})))(e)}return F})(e);if(te(i)){const{grp:e,cutoff:t,m:n}=i.value,r=Mt(t,n,It(e));return"string"==typeof r?h(r):f(S(F,r))}const n=(e=>{if(2!==e.length)return F;const[t,i]=e;if("string"===t.kind&&"object"===i.kind){const e=Y((e=>Ot(e.value)))(t);return Z((e=>({prim:e.value,m:i.value})))(e)}return F})(e);if(te(n)){const{prim:e,m:t}=n.value;return f(S(xt(e),k(v(t))))}const r=(e=>{if(1!==e.length)return F;const[t]=e;return"object"===t.kind?J({m:t.value}):F})(e);if(te(r)){const{m:e}=r.value;return f(S(F,k(v(e))))}const o=(e=>{if(e.length<1)return F;const[t,...i]=e;if("string"===t.kind){const e=Y((e=>Ot(e.value)))(t);return Z((e=>({prim:e.value,rest:i})))(e)}return F})(e);if(te(o)){const{prim:e,rest:t}=o.value;return f(S(xt(e),At(t)))}return f(S(F,At(e)))},i=e=>"array"===e.kind?Re(i)(e.value):[e];return"null"===e.kind?P({kind:"bottom"}):P(t(i(e)))}function Ot(e){const t=e.split("");if(!0==(0===t.length))return!1;{const[e,...i]=t;return-1!=="pmvn".indexOf(e)&&i.every((e=>-1!=="pmvn0123456789".indexOf(e)))}}function Dt(e){const t=e.split("");switch(!0){case 0===t.length:return!1;case"w"===t[0]&&void 0===t[1]:return!0;default:{const[e,...i]=t;return-1!=="ux".indexOf(e)&&-1===i.map((e=>!isNaN(parseInt(e)))).indexOf(!1)}}}function Mt(e,t,i){switch(e.kind){case"string":return k(i({1:J(e.value),2:t}));case"number":case"null":return q(i({1:"null"===e.kind?F:J(e.value),2:at(st(t,(([e,t])=>[Number(e),t])),(e=>!isNaN(e[0])))}));default:return"{bad cutoff}"}}function It(e){const t=e=>t=>b(t[2],t[1],e),i=e=>t=>w(t[2],t[1],e),n=e.split("");switch(!0){case"w"===n[0]&&void 0===n[1]:return e=>y(e[2],e[1]);case"u"===n[0]&&void 0===n[1]:return t(1);case"u"===n[0]&&void 0!==n[1]:return t(parseInt(n.slice(1).join("")));case"x"===n[0]&&void 0===n[1]:return i(1);case"x"===n[0]&&void 0!==n[1]:return i(parseInt(n.slice(1).join("")));default:throw new Error("This should never happen if you use isGroupCommand")}}function xt(e){return Z(g)(me(Tt(e,(e=>{const t=e.split("");if(0===t.length)return F;const[i,...n]=t,r=(e=>{switch(e){case"p":return J("add");case"m":return J("mul");case"v":return J("max");case"n":return J("min");default:return F}})(i);return Z((e=>{const{init:t,rest:i}=(r=e=>{return"number"==typeof(t=parseInt(e))&&isFinite(t)&&Math.floor(t)===t;var t},function(e){var t=Le(xe(e,r))(e);return{init:t[0],rest:t[1]}})(n);var r;return{1:{1:e,2:0===t.length?1:parseInt(t.join(""))},2:i.join("")}}))(r)}))))}function Tt(e,t){const i=t(e);return ne((()=>[]))(Z((e=>[e[1]].concat(Tt(e[2],t))))(i))}function At(e){return E(e.map(Ct))}function Ct(e){switch(e.kind){case"number":return f(e.value);case"string":return h(e.value);case"null":return{kind:"bottom"};case"object":return h("{object}");case"array":return h("{array}")}}const Ut={strategy:(e,t,i)=>n=>{if(ie(i))return t;if("delta"===e&&ie(t))return F;if(ie(t))return i;if(te(t)&&te(i))return n(t.value,i.value);throw new Error("Non exhaustive match in combineCommand.strategy")},operation:(e,t,i,n,r,o)=>{const s=ze(G(o));if("append"===e&&"add"===t)return je(i,n,Wt("append",r.plus));if("append"===e&&"mul"===t)return je(i,n,Wt("append",r.times));if("append"===e&&"max"===t)return j(s)(i,n);if("join"===e&&"add"===t)return je(i,n,Wt("join",j(o)));if("join"===e&&"mul"===t)return je(i,n,Wt("join",j(o)));if("join"===e&&"max"===t)return j(s)(i,n);if("min"===t)return Ut.operation(e,"max",i,n,r,function(e){return T(((t,i)=>it(e.compare(t,i))))}(o));if("delta"===e&&"max"===t)return U(s)(i,n)?i:n.map(m);if("delta"===e)return je(i,n,((e,t)=>U(G(o))(e,t)?e:{kind:"bottom"}));throw new Error("Non exhaustive match in combineCommand.operation")},extend:(e,t,i,n)=>{if("delta"===e&&"top"===i.kind&&"top"===n.kind)return U(R)(i.error,n.error)?h(i.error):{kind:"bottom"};if("delta"===e&&"bottom"===n.kind)return i;if("delta"===e&&"bottom"===i.kind)return{kind:"bottom"};if("top"===i.kind&&"top"===n.kind)return h(j(R)(i.error,n.error));if("top"===i.kind)return i;if("top"===n.kind)return n;if("inner"===i.kind&&"inner"===n.kind)return t(i.a,n.a);if("bottom"===i.kind)return n;if("bottom"===n.kind)return i;throw new Error("Non exhaustive match in extend")}},jt={plus:(e,t)=>e+t,times:(e,t)=>e*t};function Lt(e,t,i,n){if("unbounded"===e.kind&&"unbounded"===t.kind){const r=e.group,o=t.group;return ne(m)(Z((e=>f(v(e))))(rt(r,o,i,n)))}if("windowed"===e.kind&&"windowed"===t.kind){const r=e.key,o=e.group,s=t.key,a=t.group,c=j(X(n))(r,s);return ne(m)(Z((e=>f(y(e,c))))(rt(o,a,i,n)))}if("countLimit"===e.kind&&"countLimit"===t.kind){const r=e.n,o=t.n;if(r===o){const o=e.limit,s=e.group,a=t.limit,c=t.group,u=j(X(n))(o,a);return ne(m)(Z((e=>f(w(e,u,r))))(rt(s,c,i,n)))}return h("Non matching counts")}if("uniqueLimit"===e.kind&&"uniqueLimit"===t.kind){const r=e.n,o=t.n;if(r===o){const o=e.limit,s=e.group,a=t.limit,c=t.group,u=j(X(n))(o,a);return ne(m)(Z((e=>f(b(e,u,r))))(rt(s,c,i,n)))}return h("Non matching counts")}return h("Non matching group types")}function Rt(e,t,i,n,r,o){const s=(e,t)=>({1:Ie(e)(t).concat(De(Math.max(0,e-t.length),m)),2:Te(e)(t)}),a=(t,i,n)=>{if(0===t.length)return Ut.operation(e,"max",i,n,r,o);if(t.length>0){const[c,...u]=t,l=s(c[2],i),p=l[1],d=l[2],_=s(c[2],n),g=_[1],m=_[2];return Ut.operation(e,c[1],p,g,r,o).concat(a(u,d,m))}throw new Error("Non exhaustive match in recurse")};return Ce((c=e=>"bottom"===e.kind,function(e){return e.slice(xe(e,c))})(Ce(a(t,i,n))));var c}function Bt(e,t,i){return ne(u)(Gt(e,F)(t,i))}function Gt(e,t){const i=t=>(i,n)=>Ut.strategy(e,i,n)(Gt(e,t)),n=(n,r)=>{if(V(ye(I({1:L,2:be}))).equals(n.commands,r.commands)){const o=((t,n,r)=>{if("stringGroup"===n.kind&&"stringGroup"===r.kind){const e=Lt(n.group,r.group,i(t),R);return B(e,(e=>k(Kt(e,R))))}if("numberGroup"===n.kind&&"numberGroup"===r.kind){const e=Lt(n.group,r.group,i(t),qe);return B(e,(e=>q(Kt(e,qe))))}if("tuple"===n.kind&&"tuple"===r.kind){const i=te(t)?t.value:[];return f(E(Rt(e,i,n.tuple,r.tuple,jt,qe)))}throw new Error(`Non matching payload. Got ${n.kind} and ${r.kind}`)})(ie(n.commands)?t:n.commands,n.payload,r.payload);return B(o,(e=>S(n.commands,e)))}throw new Error(`Non matching primitive strings. Got ${ht(n)} and ${ht(r)}`)};return(t,i)=>vt(P(Ut.extend(e,n,St(t).state,St(i).state)))}function Nt(e,t,i){const n=Z((t=>at(e,(([e,n])=>function(e){return function(t,i){return-1!==e.compare(t,i)}}(i)(e,t)))))(t);return ne((()=>e))(n)}function Kt(e,t){switch(e.kind){case"unbounded":return e;case"windowed":return ie(e.key)?e:y(Nt(e.group,e.key,t),e.key);case"countLimit":{const i=e.limit,n=e.n,r=e.group,o=(e,t)=>t<=1?F:J(t-1),s=ot(n,r,o,t),a=j(X(t))(i,s);return w(Nt(r,a,t),a,n)}case"uniqueLimit":{const i=e.limit,n=e.n,r=e.group,o=(e,t)=>{if("object"===e.kind){const i=[...e.value.keys(),...t.keys()],r=new Set(i);return r.size>=n?F:J(r)}return F},s=ot(new Set,r,o,t),a=j(X(t))(i,s);return b(Nt(r,a,t),a,n)}}}function Wt(e,t){return(i,n)=>Ut.extend(e,((e,i)=>f(t(e,i))),i,n)}var $t=i(6567),zt=i(64),Qt=i(6013),Ft=i(7545),Jt=i(7121);class Yt{constructor(e,t,i){this.externalData=e,this.localQueries=t,this.externalQueries=i,this.queryCodesAsList=[],this.queryCodesAsMap={};const n=this.externalData.getExternalJsonData(zt.mL)||[],r=(0,$t.fS)((()=>[]))((0,$t.Y3)((()=>n.filter((e=>(0,Jt.UC)(e,this.localQueries,this.externalQueries))))));this.add(r)}has(e){return e in this.queryCodesAsMap}add(e){return(0,r.zG)(e.forEach((e=>this.queryCodesAsMap[e]=!0)),(e=>this.updateSegmentsList()))}remove(e){return(0,r.zG)(e.forEach((e=>delete this.queryCodesAsMap[e])),(e=>this.updateSegmentsList()))}getAllAsList(){return this.queryCodesAsList}getStdAsList(){return this.queryCodesAsList.filter((e=>e>=1e7))}getAllAsMap(){return this.queryCodesAsMap}getUpdates(e){const t=[],i=[];return Object.entries(e).forEach((([e,n])=>{const r=parseInt(e),o=(null==n?void 0:n.result)||{result:!1},s=!0===(null==o?void 0:o.result)&&!(r in this.queryCodesAsMap),a=!1===(null==o?void 0:o.result)&&r in this.queryCodesAsMap;s?t.push(r):a&&i.push(r)})),{entered:t,exited:i}}flush(){this.externalData.setExternalJsonData(zt.mL,this.getAllAsList())}reset(){this.externalData.removeExternalData(zt.mL),this.queryCodesAsList=[],this.queryCodesAsMap={}}updateSegmentsList(){this.queryCodesAsList=Object.keys(this.queryCodesAsMap).map((e=>parseInt(e)))}}const Ht="bootstrap",Vt="process",Xt="processTransitions",Zt="updateEnvironment",ei="updateExternalState",ti="updateLAL",ii="updateTPD";const ni="permutive:query:changed",ri="internal_query_states",oi="external_query_states",si=e=>class extends e{constructor(...e){super(...e),this.isWorkerReady=!1,this.stateMap={value:{},promise:Promise.resolve({})},this.extStateMap={},this.userSegments=new Yt(this.externalData,this.queryMetadata,this.externalQueries),this.segmentEntryQueryCodes=new Set,this.segmentExitQueryCodes=new Set,this.hasNewOrModifiedQueries=!1,this.makeDebouncedProcessTransitions()}makeStateMaps(){const e=this.permutiveData.getData(ri)||{},t=this.permutiveData.getData(oi)||{},i=Object.keys(this.queryMetadata),n=Object.keys(e);this.hasNewOrModifiedQueries=i.length!==n.length||i.filter((t=>{var i;return this.queryMetadata[t]!==(null===(i=e[t])||void 0===i?void 0:i.checksum)})).length>0,this.logger.debug("QueryManager has new or modified queries",this.hasNewOrModifiedQueries);const o=this.hasNewOrModifiedQueries?(0,Qt.fl)(e,(t=>{var i;return(null===(i=e[t])||void 0===i?void 0:i.checksum)===this.queryMetadata[t]})):e;this.extStateMap=this.hasNewOrModifiedQueries?(0,r.zG)((0,Qt.fl)(t,(e=>e in o)),(e=>(this.permutiveData.setData(oi,e),e))):t,this.stateMap={value:o,promise:Promise.resolve(o)};this.permutiveData.getData("query_states")&&this.permutiveData.setData("query_states",null)}makeDebouncedProcessTransitions(){this.scheduler=new Ft.b(this.transitionDebounceTime,this.transitionDebounceMaxTime);this.debouncedProcessTransitions=this.scheduler.scheduleAccumulated((e=>this.processTransitions(e)),{concat:(e,t)=>e.concat(t),empty:[]})}makeMessage(e,t,i){return{type:e,payload:(0,r.bc)(this.queryMetadata,this.extStateMap,...t),stateMap:i,userId:this.userId.get()}}trackTransition(e,t){const i=zt.ED?this.customProperties.getCustomProps():{},n=Object.assign(Object.assign(Object.assign({},i),{segment_number:t}),{});e?this.segmentEntryQueryCodes.add(t):this.segmentExitQueryCodes.add(t),this.permutive.track(e?"SegmentEntry":"SegmentExit",n)}trackSegmentsTransition(e,t){e.forEach((e=>{this.trackTransition(!0,e),this.messages.emit(ni,{queryCode:e,result:{result:!0}})})),t.forEach((e=>{this.trackTransition(!1,e),this.messages.emit(ni,{queryCode:e,result:{result:!1}})}))}updateUserSegments(e,t){this.userSegments.add(e),this.userSegments.remove(t),this.userSegments.flush()}onStateChangeReady(e){const{entered:t,exited:i}=this.userSegments.getUpdates(e);this.trackSegmentsTransition(t,i),this.updateUserSegments(t,i),this.logger.debug("QM: Updating cohort and query state cache",e),this.permutiveData.setData(ri,e);const n=t.length>0||i.length>0;return(0,r.zG)(n,(e=>e?this.messages.emit("permutive:segments:updated"):{}),(e=>({segmentsEntered:new Set(t),segmentsExited:new Set(i)})))}onStateChange(e,t){return(0,r.zG)(t.length>0?this.network.error(`QL error(s). Got ${t.join("; ")}`,this.userId.get()):{},(t=>this.stateMap.value=Object.assign(Object.assign({},this.stateMap.value),e)),(e=>this.isWorkerReady?[e,this.onStateChangeReady(e)]:[e,{segmentsEntered:new Set,segmentsExited:new Set}]))}postMessage(e,t){const i=e=>this.userId.get()===e.userId?e:{diff:{},errors:[]};return new Promise((n=>{this.stateMap.promise=this.stateMap.promise.then((0,r.ls)((i=>this.makeMessage(e,t,i)),(e=>this.processMessage(e)))).then((0,r.ls)(i,(({diff:e,errors:t})=>{const[i,r]=this.onStateChange(e,t);return n([e,r]),i}))).catch((e=>(0,r.zG)(this.network.error(`Error during query execution. Got ${e}`,this.userId.get()),(e=>n([{},{segmentsEntered:new Set,segmentsExited:new Set}])),(e=>this.stateMap.value))))}))}processTransitions(e){return this.postMessage(Xt,[e])}bootstrap(e){return this.postMessage(Ht,[{segments:{"1p":this.userSegments.getAllAsMap()},sessionId:this.sessionManager.getSessionId(),viewId:this.viewId.get(),lookalikeModels:{}},e])}updateEnvironment(e){return this.postMessage(Zt,[e])}updateLAL(e){return this.postMessage(ti,[e])}updateTPD(e){return this.postMessage(ii,[e])}process(e,t){return(0,Jt.AG)(e)?this.debouncedProcessTransitions([e]):this.processStandard([e],t)}processStandard(e,t){return(0,c.mG)(this,void 0,void 0,(function*(){const i=yield this.postMessage(Vt,[e]);return t&&this.setAsRealTimeifNeeded(e),i}))}updateExternalState(e){const t=(0,Qt.b0)(e,((e,t)=>{const i=this.queryMetadata[e];return i&&t[i]?(0,$t.Uo)(lt(t[i])):$t.YP})),i=(0,Qt.b0)(this.extStateMap,((e,t)=>(0,$t.Uo)(lt(t)))),n=(e,t,i)=>(0,r.zG)((0,$t.Y3)((()=>function(e,t){return Bt("join",e,t)}(e,t))),(0,$t.fS)((()=>(this.network.error(`Failed to join external state for query: ${i}. Had ${ct(t)}, received ${ct(e)}}`,this.userId.get()),t)))),o=(0,Qt.b0)(Object.assign(Object.assign({},i),t),((e,t)=>i[e]?(0,$t.G)(ut(n(t,i[e],e))):(0,$t.G)(ut(t))));return this.permutiveData.setData(oi,o),this.extStateMap=o,this.postMessage(ei,[])}reset(){this.userSegments.reset(),this.permutiveData.setData(ri,{}),this.permutiveData.setData(oi,{}),this.stateMap={value:{},promise:Promise.resolve({})},this.extStateMap={}}setAsReady(){this.isWorkerReady=!0,this.onStateChangeReady(this.stateMap.value),this.messages.emit("permutive:queries:initialised")}getStateSizeInBytes(){return 2*JSON.stringify(this.stateMap.value).length}updateExternalSegments(e){const t={};for(const i of Object.keys(e)){const n=parseInt(i);!isNaN(n)&&this.externalQueries.has(n)&&(t[n]={result:{result:e[n]}})}const{entered:i,exited:n}=this.userSegments.getUpdates(t);this.trackSegmentsTransition(i,n),this.updateUserSegments(i,n);(i.length>0||n.length>0)&&this.messages.emit("permutive:segments:updated")}setAsRealTimeifNeeded(e){return!this.realtime.isRealtime()&&e.filter((e=>"Pageview"===e.name)).length>0?this.realtime.setAsRealtime(this.userSegments.getAllAsList().length):void 0}};function ai(){return(0,n.h)(new a)}class ci{constructor(e){this.queryMetadata={23918:"0c8b70cdb7",24040:"c784c76f7e",24996:"23aa5da699",46274:"70d0410fd4",47174:"a2fc1f2ee8",47281:"9888b11a3e",47282:"b35dbbdfa9",47292:"1f04d0d236",47296:"9b4fdc8d94",47297:"c07e52e268",47628:"6a9e47ccd2",47650:"30ccb3dcfa",47651:"e697a740f6",47652:"b3e63ecc4d",47653:"345ea0c1e6",47654:"f6d350e58c",47721:"df9661337d",47723:"82ad429f5d",47730:"3004ccf38f",47733:"2229c3fcd4",47734:"0df2234db9",47736:"2daee34d1b",47749:"7d83a1460e",47750:"53780b576d",47751:"84e6841c8a",47752:"2c33cdb553",47753:"2c19f5dfa5",47755:"363fa058c2",47756:"4b40dd8a1d",47846:"779d02f8d4",47862:"703fbbbecb",47863:"6cfed21e0d",47864:"439a6ced55",47865:"8c3ec35f81",47894:"1f9507de48",47895:"3e74ce2d0c",47896:"9b2e2ffd0b",47897:"eee4386a77",47898:"19c61940ac",47899:"508e12b514",47900:"dc7c4918f7",47901:"856fb0f3dc",47903:"3a939ca68b",47917:"a5366ee05e",47918:"2d55a9e09a",47919:"193c0cfd4c",47920:"286b1e5e0e",47921:"83898edc21",47922:"f04a12c3cc",47923:"ca871fe6a4",47924:"932f37985c",47925:"2d1293afb6",47926:"6187f8bc87",47929:"b3ce636c49",47930:"dfa9358c1c",47931:"55a0974014",47932:"e9e0915070",47933:"e17f6fe41b",47934:"a3255bc876",47935:"cd45d75cb2",47936:"2e7747a7dc",47937:"a0a443eeb9",47938:"1e43d1a9fd",47939:"bd7c83f39e",47940:"acff113f88",47941:"17b5d5db49",47942:"90f559fe35",47943:"5402574347",47944:"e324189321",47945:"52470c894e",48010:"d03987db20",48261:"ffd88e717e",48262:"7faf500c2e",48263:"95898934b4",48264:"7ef2e03324",48265:"32e81b66a6",48266:"7ede4b28a1",48267:"53c33b8cf7",48309:"4723c895c2",49048:"b7dcf4e541",49050:"73bf01b9ff",49052:"1b47412aca",49089:"2939784c4a",49109:"222179c5c0",49149:"7f37d324b7",50432:"63b091a862",50438:"5919b6af34",50442:"c9060e3cd5",50443:"419056c45b",50444:"d4f61b0b8a",50445:"74d1098be7",50446:"4c8299f021",50562:"90a66137a4",50563:"70260351ed",50564:"6a29c304de",50635:"ce3dd01512",50692:"9c21353ca6",50702:"9c5fdd05d1",50712:"b8bf258e02",50713:"2a589e555a",51619:"e640ea95f9",51645:"ff4aae3249",52010:"dc4189f215",52012:"a2cc64757a",52013:"611b032786",52096:"b66fa7cdbb",52097:"c4c25613ea",52388:"94b0be3b40",52396:"83b2b988cb",52397:"138f02798f",52398:"eb6efab26d",52461:"20332e33e5",52464:"0bcb199d16",52465:"d24f1d9143",52466:"36403ec864",52483:"5a4c97a741",56605:"6eef33d2d9",56798:"755096a398",56801:"22911a2329",56802:"3e53f4ed9a",56803:"5c901334d6",56804:"a371556aa1",57571:"347622e5e9",60307:"238aa5d06d",60308:"ed86e41edf",60309:"46f2fcad29",60310:"76cff18121",60311:"4970ed2682",60312:"c92082c236",60313:"4dc5dde576",60315:"ddd893279d",60316:"fa8994cb85",60317:"cff8b4045c",60318:"dca9b9436c",60319:"8d4baeaba7",60321:"af0e39052f",62400:"b7fe228ee7",66937:"633aa32df9",70363:"8e27f54905",70364:"5b6dc0029d",70757:"0c8b70cdb7",83115:"c7aaa517ec",83206:"212dea2ae6",83208:"8cb29d3f30",83440:"7d3f048ece",83512:"e9b499f773",83971:"5ad251aa7b",84279:"58c6d21f60",84282:"bb839c20fc",84283:"6389e07bd7",84284:"984de772f9",84406:"6a588f6ef6",84407:"8746c29339",84408:"decbce8896",84409:"f348c2321a",84410:"ec93ab13d3",84411:"4e0423b170",90207:"49897af694",94436:"2f8ac07e70",122660:"c19a84eee6",1e7:"ab2a79b4e1",10000001:"ea7eca3b49",10000002:"7a0b76bb2f",10000003:"49e502122c",10000004:"f1c67fac3c",10000005:"377db020e8",10000006:"547879da4e",10000007:"ca176545c8",10000008:"1a9d700b97",10000010:"a4cefa7f58",10000011:"aa7075e35b",10000012:"1ae8bddb93",10000013:"1e8886ad72",10000014:"f516ad362e",10000015:"787c19bee4",10000016:"d6475b75d5",10000017:"38ea08fad7",10000018:"5fab00fa2c",10000019:"e109f9b360",10000020:"90a178ea71",10000021:"bd128fcfed",10000022:"cd3face523",10000023:"c2f26784d1",10000024:"eb85193dfd",10000025:"9674e8f207",10000026:"6d37ba6b9a",10000035:"b0aca14cab",10000036:"d36ef645a5",10000037:"adf0bd9d7d",10000038:"0a8427037a",10000039:"9b0eb48861",10000040:"de880ed625",10000041:"82f6856d68",10000042:"98ff38947b",10000043:"3cde49fc7f",10000044:"204ea1bd83",10000045:"87b257dec6",10000046:"5579a14726",10000047:"aca78f9e2e",10000048:"fa2ea1e2fa",10000049:"673bfae6e5",10000050:"6f4e13e789",10000051:"d7f4837226",10000052:"53669c17cf",10000053:"cd9d4baf1b",10000054:"36a6a1b8ac",10000055:"61fbd3f45d",10000056:"36169adc34",10000057:"4dcf4dc5ea",10000058:"91ed3d5df9",10000059:"9975f2d18a",10000060:"291bb4c201",10000061:"835df65992",10000062:"8af22f787c",10000063:"13625d9512",10000064:"865b534730",10000065:"711a803835",10000066:"3f5a01518e",10000067:"a90790be86",10000068:"840b4c697a",10000069:"5b811cacf3",10000070:"26f90895bf",10000071:"ecfb5c1cab",10000072:"49ab120d1d",10000073:"8816deadae",10000074:"5c7a1ac24a",10000075:"0dc58fe713",10000076:"c791f64ecd",10000077:"fb2601505c",10000078:"ec0d63e687",10000079:"9f1a1f7510",10000080:"e51622030c",10000081:"c7a8cae6d0",10000082:"8ce761d02d",10000083:"7b6a42ef76",10000084:"479977505c",10000085:"930fdc5c22",10000086:"39e47fa144",10000087:"08cf53e104",10000088:"a2e20ffb1f",10000089:"68f37c2880",10000090:"be04a0b54e",10000324:"1ccab119ee",10000325:"1f783b581b",10000327:"21c25a4900",10000328:"482cefaa5d",10000329:"8ea8e0687e",10000330:"7f88a52c7e"},this.externalQueries=new Set([]),this.customProperties=e.customProperties,this.externalData=e.externalData,this.logger=e.logger,this.messages=e.messages,this.network=e.network,this.permutive=e.permutive,this.permutiveData=e.permutiveData,this.queryWorker=e.queryWorker,this.realtime=e.realtime,this.sessionManager=e.sessionManager,this.transitionDebounceMaxTime=e.transitionDebounceMaxTime,this.transitionDebounceTime=e.transitionDebounceTime,this.userId=e.userId,this.viewId=e.viewId}processMessage(e){return this.queryWorker.postMessage(e)}}class ui extends((()=>(0,r.zG)(ci,si))()){constructor(e){super(e),this.makeStateMaps()}}},3253:(e,t,i)=>{i.d(t,{S:()=>s});var n=i(655),r=i(3735),o=i(6013);class s{constructor(e,t){var i;this.db=e,this.options=t,this.hasChanged=!1,this.options=null!==(i=this.options)&&void 0!==i?i:{},this.options.timeout_seconds=this.options.timeout_seconds||1800,this.options.session_data_key=this.options.session_data_key||"permutive-session",this.session_id=null}getSessionId(){return this.session_id}sessionHasChanged(){return this.hasChanged}decodeSessionData(e){return null===e?null:"object"==typeof e&&e.hasOwnProperty("session_id")&&e.hasOwnProperty("last_updated")?Object.assign(Object.assign({},e),{last_updated:new Date(e.last_updated)}):null}reset(){return this.db.delete(this.options.session_data_key)}persistSessionData(e){return(0,n.mG)(this,void 0,void 0,(function*(){const t=e.last_updated.toISOString();yield this.db.put(Object.assign(Object.assign({},e),{last_updated:t}),this.options.session_data_key)}))}newSession(e){return this.hasChanged=!0,{session_id:(0,o.k$)(),last_updated:e}}hasExpired(e,t){if(isNaN(t.getTime()))return!0;return e>new Date(t.getTime()+1e3*this.options.timeout_seconds)}static initialise(e,t,i){return(0,n.mG)(this,void 0,void 0,(function*(){const n=new s(t,i);e.deleteCookie(n.options.session_data_key);const o=new Date,a=yield n.db.get(n.options.session_data_key).catch(r.gn),c=n.decodeSessionData(a),u=null===c||n.hasExpired(o,c.last_updated)?n.newSession(o):Object.assign(Object.assign({},c),{last_updated:o});return yield n.persistSessionData(u),n.session_id=u.session_id,n}))}}},2747:(e,t,i)=>{i.d(t,{S:()=>m});var n=i(3735),r=i(787),o=i(6013),s=i(7545);class a{constructor(e,t,i,n,r){this.config=e,this.namespace=t,this.logger=i,this.network=n,this.userId=r,this.permutiveData={},this.permutiveDataSize=0,this.localStorageQueue=new Set,this.localStorageScheduler=new s.b(e.localStorageWriteDelay,e.localStorageWriteMaxDelay),this.debouncedFlush=this.localStorageScheduler.schedule(this.flushLocalStorageQueue.bind(this)),this.debouncedStorageKeys=new Set(e.localStorageDebouncedKeys),this.localStorageScheduler.scheduleForPageUnload(this.flushLocalStorageQueue.bind(this)),this.permutiveData=this.buildData()}reset(){this.permutiveData={}}getDataSize(){return this.permutiveDataSize}getData(e){return this.permutiveData[e]}setData(e,t){this.permutiveData[e]=t,this.debouncedStorageKeys.has(e)?(this.localStorageQueue.add(e),this.debouncedFlush()):this.writeData(e)}flushLocalStorageQueue(){for(let e of this.localStorageQueue)this.writeData(e);this.localStorageQueue.clear()}buildData(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.getDataChunk("misc")),this.getDataChunk("models")),this.getDataChunk("queries")),this.getDataChunk("tpd")),this.getDataChunk("enrichers"))}getDataChunk(e){const t=this.namespace.getNamespacedStorageKey(this.chunkKeyToStorageKey(e)),i=window.localStorage.getItem(t),n=(0,r.A)(i);return null===n?{}:(this.permutiveDataSize+=2*i.length,n)}chunkKeyToStorageKey(e){switch(e){case"models":return this.config.permutiveDataModelsKey;case"queries":return this.config.permutiveDataQueriesKey;case"tpd":return this.config.permutiveDataTPDKey;case"enrichers":return this.config.permutiveDataEnrichersKey;case"misc":return this.config.permutiveDataMiscKey;default:return(0,o.Fi)(e)}}writeData(e){this.logger.debug(`Data Store: Writing ${e} to localStorage`);const[t,i]=this.dataKeyToChunkInfo(e);return(0,o.Z_)(this.network,this.userId,(()=>window.localStorage.setItem(this.namespace.getNamespacedStorageKey(t),JSON.stringify(i))))()}dataKeyToChunkInfo(e){const t=e=>(0,o.eu)(this.permutiveData,e);switch(e){case"models_data":case"models_last_updated":return[this.chunkKeyToStorageKey("models"),t(c)];case"query_states":case"internal_query_states":case"external_query_states":case"state_offset":case"event-source-id":return[this.chunkKeyToStorageKey("queries"),t(u)];case"third-party-data":case"third-party-data-session-id":case"third-party-data-usage":return[this.chunkKeyToStorageKey("tpd"),t(l)];case"enricher:geoip":return[this.chunkKeyToStorageKey("enrichers"),t(p)];case"identities":case"amp_ready":case"metricsEnabled":case"addon:tradedesk":case"addon:tracking_pixel":case"addon:eyeota_pixel":case"addon:twitter_pixel":case"addon:pinterest_pixel":case"addon:facebook_pixel_v2":case"addon:appnexus":case"addon:ddp":case"addon:gigya":case"addon:neustar_fabrick":case"pubmatic":case"lotame":return[this.chunkKeyToStorageKey("misc"),t(d)];default:return(0,o.Fi)(e)}}}const c=["models_data","models_last_updated"],u=["query_states","internal_query_states","external_query_states","state_offset","event-source-id"],l=["third-party-data","third-party-data-session-id","third-party-data-usage"],p=["enricher:geoip"],d=["identities","amp_ready","metricsEnabled","addon:tradedesk","addon:tracking_pixel","addon:eyeota_pixel","addon:twitter_pixel","addon:pinterest_pixel","addon:facebook_pixel_v2","addon:appnexus","addon:ddp","addon:gigya","addon:neustar_fabrick","pubmatic","lotame"];var _=i(5097);const g=e=>{const{logger:t,consentTracking:i}=e,n=e=>{t.debug(`Data Store: Failed to write ${e} as consent is revoked`)};return e=>class extends e{constructor(){super(...arguments),this.writeData=(0,_.v)(super.writeData.bind(this),n,i.isRevoked)}}},m=(e,t,i,r,o,s)=>new((0,n.zG)(a,g({consentTracking:s,logger:i})))(e,t,i,r,o)},1823:(e,t,i)=>{i.d(t,{$:()=>r});var n=i(6013);class r{constructor(e){this.permutiveData=e,this.eventSourceId=e.getData("event-source-id")||this.generateAndStoreEventSourceId()}get(){return this.eventSourceId}generateAndSet(){this.eventSourceId=this.generateAndStoreEventSourceId()}generateAndStoreEventSourceId(){const e=(0,n.k$)();return this.permutiveData.setData("event-source-id",e),e}}},7738:(e,t,i)=>{i.d(t,{L:()=>n});class n{constructor(e){this.config=e}getNamespacedStorageKey(e){return`${this.config.stateNamespace}${e}`}}},4528:(e,t,i)=>{i.d(t,{u:()=>n});class n{constructor(e,t){this.metrics=e,this.messages=t}isRealtime(){return this._isRealtime}isReady(){return this._isReady}setAsRealtime(e){this._isRealtime=!0,this.messages.emit("permutive:realtime"),this.metrics.trackTimeSinceInit("sdk_realtime_targeting_set_task_duration_seconds",{}),this.metrics.track({name:"sdk_user_segments_count",value:e,labels:{}})}setAsReady(){this._isReady=!0,this.messages.emit("permutive:ready"),this.metrics.trackTimeSinceInit("sdk_initialisation_task_duration_seconds",{sdk_version:"v19.31.0"}),window.performance&&window.performance.memory&&(this.metrics.track({name:"sdk_heap_memory_bytes_used",value:window.performance.memory.usedJSHeapSize,labels:{}}),this.metrics.track({name:"sdk_heap_memory_limit_fraction_used",value:window.performance.memory.usedJSHeapSize/window.performance.memory.jsHeapSizeLimit,labels:{}}))}}},2472:(e,t,i)=>{i.d(t,{a:()=>s});var n=i(655),r=i(3735),o=i(356);class s{constructor(e,t,i,n,r,o,s,a){this.config=e,this.localStorage=t,this.logger=i,this.queryManager=n,this.permutiveData=r,this.eventSourceId=o,this.cookies=s,this.externalData=a}reset(){return(0,n.mG)(this,void 0,void 0,(function*(){return this.logger.log("Resetting State"),(0,r.zG)(this.cookies.deleteCookie(this.config.cookieName),(e=>this.externalData.removeExternalData(this.config.cookieName)),(e=>(0,o.XP)({_paols:!0,_papns:!0,_pcrdbs:!0,_pcrprs:!0,_pdfps:!0,_pfwqp:!0,_pnativo:!0,_prps:!0,_prubicons:!0,_psegs:!0,_psmart:!0,"permutive-id":!0,"permutive-loaded":!0,_pclmc:!0,"permutive-prebid-rtd":!0,"permutive-events-cache":!0}).forEach((e=>this.externalData.removeExternalData(e)))),(e=>this.queryManager.reset()),(e=>this.permutiveData.reset()),(e=>this.eventSourceId.generateAndSet()),(e=>Promise.all([this.localStorage.delete(this.config.permutiveDataModelsKey),this.localStorage.delete(this.config.permutiveDataQueriesKey),this.localStorage.delete(this.config.permutiveDataTPDKey),this.localStorage.delete(this.config.permutiveDataEnrichersKey),this.localStorage.delete(this.config.permutiveDataMiscKey)])),r.Q1)}))}}},1714:(e,t,i)=>{i.d(t,{N:()=>m,e:()=>_});var n=i(655),r=i(2688),o=i(7183),s=i(8198),a=i(3735),c=i(477),u=i.n(c);function l(){return u()('/*! permutive-javascript-sdk v19.31.0 (web) (built 2022-10-07T13:53:03.574Z) */(()=>{"use strict";const n=()=>({kind:"null",value:null}),r=n=>({kind:"string",value:n}),t=n=>({kind:"number",value:n}),e=n=>({kind:"array",value:n}),u=n=>({kind:"object",value:n}),i=n=>n,o=()=>({kind:"bottom"}),c=n=>({kind:"inner",a:n}),a=n=>({kind:"top",error:n}),s=n=>({kind:"unbounded",group:n}),f=(n,r)=>({kind:"windowed",key:r,group:n}),l=(n,r,t)=>({kind:"countLimit",n:t,limit:r,group:n}),d=(n,r,t)=>({kind:"uniqueLimit",n:t,limit:r,group:n}),p=n=>({kind:"numberGroup",group:n}),m=n=>({kind:"stringGroup",group:n}),g=n=>({kind:"tuple",tuple:n}),v=n=>({state:n}),h=(n,r)=>({commands:n,payload:r});function k(n){return n}function w(n,r,t,e,u,i,o,c,a){switch(arguments.length){case 1:return n;case 2:return r(n);case 3:return t(r(n));case 4:return e(t(r(n)));case 5:return u(e(t(r(n))));case 6:return i(u(e(t(r(n)))));case 7:return o(i(u(e(t(r(n))))));case 8:return c(o(i(u(e(t(r(n)))))));case 9:return a(c(o(i(u(e(t(r(n))))))));default:for(var s=arguments[0],f=1;f<arguments.length;f++)s=arguments[f](s);return s}}var y=function(n){return{equals:function(r,t){return r===t||n(r,t)}}},b=function(n){return y((function(r,t){for(var e in n)if(!n[e].equals(r[e],t[e]))return!1;return!0}))},x=function(n){return function(r,t){return r===t||0===n(r,t)}},j=function(n){return{equals:x(n),compare:function(r,t){return r===t?0:n(r,t)}}},N=function(n){return function(r){return j((function(t,e){return r.compare(n(t),n(e))}))}},q=function(n){return function(r,t){return-1===n.compare(r,t)}},L=function(n){return function(r,t){return 1===n.compare(r,t)}},O=function(n){return function(r,t){return r===t||n.compare(r,t)>-1?r:t}};var M={equals:function(n,r){return n===r}},S={equals:M.equals,compare:function(n,r){return n<r?-1:n>r?1:0}};const G=(n,r)=>{switch(n.kind){case"bottom":return{kind:"bottom"};case"inner":return c(r(n.a));case"top":return a(n.error)}},E=n=>j(((r,t)=>{if("bottom"===r.kind&&"bottom"===t.kind)return 0;if("bottom"===r.kind)return-1;if("bottom"===t.kind)return 1;if("top"===r.kind&&"top"===t.kind)return S.compare(r.error,t.error);if("top"===r.kind)return 1;if("top"===t.kind)return-1;if("inner"===r.kind&&"inner"===t.kind)return n.compare(r.a,t.a);throw new Error("Non exhaustive match in extendedAlgebraOrd")}));var _=function(n,r){for(var t=0,e=r.length,u=n.length;t<e;t++,u++)n[u]=r[t];return n},A=function(n){return"Some"===n._tag},$={_tag:"None"},I=function(n){return{_tag:"Some",value:n}},C=function(n){return"Left"===n._tag},z=(Object.prototype.hasOwnProperty,function(n){return _([n[0]],n.slice(1))});var J=$,P=I;function R(n){return function(r){return n(r)?P(r):J}}var F=function(n){return"Left"===n._tag?J:P(n.right)},W=function(n){return{equals:function(r,t){return r===t||(H(r)?H(t):!H(t)&&n.equals(r.value,t.value))}}},B=function(n){return{equals:W(n).equals,compare:function(r,t){return r===t?0:D(r)?D(t)?n.compare(r.value,t.value):1:-1}}},T=function(n){return function(r){return H(r)?J:P(n(r.value))}},U=F,D=A,H=function(n){return"None"===n._tag},K=function(n){return function(r){return H(r)?n():r.value}};var Q;Q=void 0;var V=function(n){return n[0]},X=V;var Y=function(n,r){for(var t=0,e=r.length,u=n.length;t<e;t++,u++)n[u]=r[t];return n},Z=function(n){return n.length>0},nn=function(n,r){return n<0||n>=r.length},rn=function(n){return function(r){return Y([n],r)}},tn=rn,en=function(n){return function(r){return Y(Y([],r),[n])}},un=en,on=z,cn=function(n){return Z(n)?I(n):$},an=function(n){return function(r){for(var t=Math.max(0,Math.floor(r)),e=[n(0)],u=1;u<t;u++)e.push(n(u));return e}};var sn=on;var fn=function(n){return function(r){var t=Math.max(1,n);return t>=r.length?[sn(r),[]]:[w(r.slice(1,t),tn(dn(r))),r.slice(t)]}},ln=function(n){return y((function(r,t){return r.length===t.length&&r.every((function(r,e){return n.equals(r,t[e])}))}))},dn=X;var pn={equals:function(n,r){return n===r}},mn={equals:pn.equals,compare:function(n,r){return n<r?-1:n>r?1:0}};var gn=function(n,r){return function(t){for(var e=t.length,u=n,i=0;i<e;i++)u=r(i,u,t[i]);return u}};var vn=function(n){return 0===n.length},hn=Z,kn=tn,wn=un,yn=function(n,r){return n<=0?[]:an(r)(n)};var bn=nn,xn=function(n){return function(r){return bn(n,r)?qn(r):r.slice(0,n)}};var jn=function(n,r){for(var t=n.length,e=0;e<t&&r(n[e]);e++);return e};var Nn=function(n){return function(r){return n<=0||vn(r)?qn(r):n>=r.length?[]:r.slice(n,r.length)}};var qn=function(n){return n.slice()},Ln=function(n){return vn(n)?[]:n.slice().reverse()},On=function(n){return function(r){return r.length<=1?qn(r):r.slice().sort(n.compare)}},Mn=function(n,r,t){for(var e=[],u=Math.min(n.length,r.length),i=0;i<u;i++)e[i]=t(n[i],r[i]);return e};var Sn=function(n){return function(r){return n>=1&&hn(r)?fn(n)(r):vn(r)?[qn(r),[]]:[[],qn(r)]}};var Gn=function(n){return function(r){return w(r,function(n){return function(r){for(var t=[],e=0;e<r.length;e++)t.push.apply(t,n(e,r[e]));return t}}((function(r,t){return n(t)})))}},En=function(n){return function(r){for(var t=[],e=0;e<r.length;e++){var u=n(e,r[e]);A(u)&&t.push(u.value)}return t}},_n=function(n){return En((function(r,t){return n(t)}))},An=_n(k),$n=gn,In=function(n){var r=Cn(n);return function(n){return r((function(r,t){return n(t)}))}},Cn=function(n){return function(r){return $n(n.of([]),(function(t,e,u){return n.ap(n.map(e,(function(n){return function(r){return w(n,wn(r))}})),r(t,u))}))}},zn=function(n){return j((function(r,t){for(var e=r.length,u=t.length,i=Math.min(e,u),o=0;o<i;o++){var c=n.compare(r[o],t[o]);if(0!==c)return c}return mn.compare(e,u)}))},Jn=function(n){return{_tag:"Left",left:n}},Pn=function(n){return{_tag:"Right",right:n}},Rn=function(n,r){return w(n,Bn(r))},Fn=function(n,r){return w(n,Un(r))},Wn="Either",Bn=function(n){return function(r){return Hn(r)?r:Pn(n(r.right))}},Tn=Pn,Un=function(n){return function(r){return Hn(r)?r:Hn(n)?n:Pn(r.right(n.right))}},Dn={URI:Wn,map:Rn,ap:Fn,of:Tn},Hn=C;var Kn=function(n){return-1===n?1:1===n?-1:0};function Qn(n,r){return An(n.map(r))}function Vn(n,r,t,e){const u=(n,r)=>{if(0===n.length)return An(r.map((n=>P({1:n[1],2:t(J,P(n[2]))}))));if(0===r.length)return An(n.map((n=>P({1:n[1],2:t(P(n[2]),J)}))));if(n.length>0&&r.length>0&&q(e)(n[0][1],r[0][1])){const[e,...i]=n,o=e[1],c=e[2];return kn({1:o,2:t(P(c),J)})(u(i,r))}if(n.length>0&&r.length>0&&L(e)(n[0][1],r[0][1])){const[e,...i]=r,o=e[1],c=e[2];return kn({1:o,2:t(J,P(c))})(u(n,i))}if(n.length>0&&r.length>0){const[e,...i]=n,[o,...c]=r,a=e[1],s=e[2],f=o[2];return kn({1:a,2:t(P(s),P(f))})(u(i,c))}throw new Error("Non exhaustive match in mapOption2")},i=N((n=>n[1]))(e),o=(n=>{const r=Qn(n,(n=>D(n[2])?P({1:n[1],2:n[2].value}):J));return 0===r.length?J:P(r)})(u(On(i)([...n].map((n=>({1:n[0],2:n[1]})))),On(i)([...r].map((n=>({1:n[0],2:n[1]}))))));return T((n=>new Map(n.map((n=>[n[1],n[2]])))))(o)}function Xn(n,r,t,e){const u=N((n=>n[0]))(e),i=On(u)([...r]).reduceRight(((n,r)=>{if(Hn(n)){const e=t(r[1],n.left);return D(e)?Jn(e.value):Pn(r[0])}return n}),Jn(n));return U(i)}function Yn(n,r){return new Map([...n].map(r))}function Zn(n,r){return new Map([...n].filter(r))}function nr(n){return JSON.stringify(rr(n))}function rr(n){switch(n.kind){case"null":return ur.encode(n);case"string":return ir.encode(n);case"number":return or.encode(n);case"array":return cr.encode(n);case"object":return ar.encode(n)}}function tr(n){return null===n?ur.decode(n):"number"==typeof n?or.decode(n):"string"==typeof n?ir.decode(n):Array.isArray(n)?cr.decode(n):ar.decode(n)}const er=(n,r)=>Jn(`Failed to decode. Input was ${JSON.stringify(n)}. Codec type was ${r}`),ur={encode:n=>null,decode:n=>null===n?Pn({kind:"null",value:null}):er(n,"SimpleNull")},ir={encode:n=>n.value,decode:n=>"string"==typeof n?Pn(r(n)):er(n,"SimpleString")},or={encode:n=>n.value,decode:n=>"number"==typeof n?Pn(t(n)):er(n,"SimpleNumber")},cr={encode:n=>n.value.map(rr),decode:n=>{if(Array.isArray(n)){const r=In(Dn)(tr)(n);return Bn(e)(r)}return er(n,"SimpleArray")}},ar={encode:n=>{const r=[...n.value.entries()];return Object.assign({},...Array.from(r,(([n,r])=>({[n]:rr(r)}))))},decode:n=>{if(n&&n.constructor===Object){const r=In(Dn)((([n,r])=>w(tr(r),Bn((r=>function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n}(n,r))))))(Object.entries(n));return Bn((n=>u(new Map([...n]))))(r)}return er(n,"SimpleObject")}};function sr(n){return w(n,lr,T(nr),K((()=>"<encode error>")))}function fr(n){return T(hr)(function(n){switch(n.state.kind){case"top":return P(r(n.state.error));case"bottom":return J;case"inner":return lr(n.state.a)}}(n))}function lr(n){return function(n){switch(n.kind){case"numberGroup":case"stringGroup":return dr(n.group);case"tuple":return n.tuple.length>0}}(n.payload)?P(e(function(n,r){const t=T((n=>kn(n)(r)))(n);return K((()=>r))(t)}(T((n=>r(function(n){const r=n=>{switch(n){case"add":return"p";case"mul":return"m";case"max":return"v";case"min":return"n"}},t=n=>1===n[2]?r(n[1]):r(n[1])+JSON.stringify(n[2]);return n.map(t).join("")}(n))))(n.commands),function(n){const e=n=>{switch(n.kind){case"bottom":return{kind:"null",value:null};case"top":return r(n.error);case"inner":return t(n.a)}},i=n=>Qn([pr,mr,n=>w(n,vr,u,P)],(r=>r(n))),o=n=>Qn([pr,gr,n=>w(n,vr,(n=>Yn(n,(([n,r])=>[JSON.stringify(n),r]))),u,P)],(r=>r(n)));switch(n.kind){case"tuple":return n.tuple.map(e);case"stringGroup":return i(n.group);case"numberGroup":return o(n.group)}}(n.payload)))):J}function dr(n){switch(n.kind){case"unbounded":return n.group.size>0;case"windowed":return n.group.size>0||D(n.key);case"countLimit":case"uniqueLimit":return n.group.size>0||D(n.limit)}}function pr(n){switch(n.kind){case"unbounded":return J;case"windowed":return P(r("w"));case"countLimit":return P(r(1===n.n?"x":`x${n.n}`));case"uniqueLimit":return P(r(1===n.n?"u":`u${n.n}`))}}function mr(n){switch(n.kind){case"unbounded":return J;case"windowed":return P(r(D(n.key)?n.key.value:""));case"countLimit":case"uniqueLimit":return P(r(D(n.limit)?n.limit.value:""))}}function gr(n){switch(n.kind){case"unbounded":return J;case"windowed":return D(n.key)?P(t(n.key.value)):P({kind:"null",value:null});case"countLimit":case"uniqueLimit":return D(n.limit)?P(t(n.limit.value)):P({kind:"null",value:null})}}function vr(n){switch(n.kind){case"unbounded":case"windowed":case"countLimit":case"uniqueLimit":return n.group}}function hr(n){switch(n.kind){case"array":return 0===n.value.length?{kind:"null",value:null}:1===n.value.length?hr(n.value[0]):e(n.value.map(hr));case"object":return w(Zn(n.value,(([n,r])=>"null"!==r.kind)),(n=>Yn(n,(n=>[n[0],hr(n[1])]))),u);default:return n}}function kr(n){const r=n=>{if(0===n.length)return{kind:"bottom"};const r=(n=>{if(4!==n.length)return J;const[r,t,e,u]=n;if("string"===r.kind&&"string"===t.kind&&"object"===u.kind){const n=R((n=>wr(n[1].value)&&yr(n[2].value)))({1:r,2:t});return T((n=>({prim:n[1].value,grp:n[2].value,cutoff:e,m:u.value})))(n)}return J})(n);if(D(r)){const{prim:n,grp:t,cutoff:e,m:u}=r.value,i=br(e,u,xr(t));return"string"==typeof i?a(i):c(h(jr(n),i))}const t=(n=>{if(3!==n.length)return J;const[r,t,e]=n;if("string"===r.kind&&"object"===e.kind){const n=R((n=>yr(n.value)))(r);return T((n=>({grp:n.value,cutoff:t,m:e.value})))(n)}return J})(n);if(D(t)){const{grp:n,cutoff:r,m:e}=t.value,u=br(r,e,xr(n));return"string"==typeof u?a(u):c(h(J,u))}const e=(n=>{if(2!==n.length)return J;const[r,t]=n;if("string"===r.kind&&"object"===t.kind){const n=R((n=>wr(n.value)))(r);return T((n=>({prim:n.value,m:t.value})))(n)}return J})(n);if(D(e)){const{prim:n,m:r}=e.value;return c(h(jr(n),m(s(r))))}const u=(n=>{if(1!==n.length)return J;const[r]=n;return"object"===r.kind?P({m:r.value}):J})(n);if(D(u)){const{m:n}=u.value;return c(h(J,m(s(n))))}const i=(n=>{if(n.length<1)return J;const[r,...t]=n;if("string"===r.kind){const n=R((n=>wr(n.value)))(r);return T((n=>({prim:n.value,rest:t})))(n)}return J})(n);if(D(i)){const{prim:n,rest:r}=i.value;return c(h(jr(n),qr(r)))}return c(h(J,qr(n)))},t=n=>"array"===n.kind?Gn(t)(n.value):[n];return"null"===n.kind?v({kind:"bottom"}):v(r(t(n)))}function wr(n){const r=n.split("");if(!0==(0===r.length))return!1;{const[n,...t]=r;return-1!=="pmvn".indexOf(n)&&t.every((n=>-1!=="pmvn0123456789".indexOf(n)))}}function yr(n){const r=n.split("");switch(!0){case 0===r.length:return!1;case"w"===r[0]&&void 0===r[1]:return!0;default:{const[n,...t]=r;return-1!=="ux".indexOf(n)&&-1===t.map((n=>!isNaN(parseInt(n)))).indexOf(!1)}}}function br(n,r,t){switch(n.kind){case"string":return m(t({1:P(n.value),2:r}));case"number":case"null":return p(t({1:"null"===n.kind?J:P(n.value),2:Zn(Yn(r,(([n,r])=>[Number(n),r])),(n=>!isNaN(n[0])))}));default:return"{bad cutoff}"}}function xr(n){const r=n=>r=>d(r[2],r[1],n),t=n=>r=>l(r[2],r[1],n),e=n.split("");switch(!0){case"w"===e[0]&&void 0===e[1]:return n=>f(n[2],n[1]);case"u"===e[0]&&void 0===e[1]:return r(1);case"u"===e[0]&&void 0!==e[1]:return r(parseInt(e.slice(1).join("")));case"x"===e[0]&&void 0===e[1]:return t(1);case"x"===e[0]&&void 0!==e[1]:return t(parseInt(e.slice(1).join("")));default:throw new Error("This should never happen if you use isGroupCommand")}}function jr(n){return T(i)(cn(Nr(n,(n=>{const r=n.split("");if(0===r.length)return J;const[t,...e]=r,u=(n=>{switch(n){case"p":return P("add");case"m":return P("mul");case"v":return P("max");case"n":return P("min");default:return J}})(t);return T((n=>{const{init:r,rest:t}=(u=n=>{return"number"==typeof(r=parseInt(n))&&isFinite(r)&&Math.floor(r)===r;var r},function(n){var r=Sn(jn(n,u))(n);return{init:r[0],rest:r[1]}})(e);var u;return{1:{1:n,2:0===r.length?1:parseInt(r.join(""))},2:t.join("")}}))(u)}))))}function Nr(n,r){const t=r(n);return K((()=>[]))(T((n=>[n[1]].concat(Nr(n[2],r))))(t))}function qr(n){return g(n.map(Lr))}function Lr(n){switch(n.kind){case"number":return c(n.value);case"string":return a(n.value);case"null":return{kind:"bottom"};case"object":return a("{object}");case"array":return a("{array}")}}const Or={strategy:(n,r,t)=>e=>{if(H(t))return r;if("delta"===n&&H(r))return J;if(H(r))return t;if(D(r)&&D(t))return e(r.value,t.value);throw new Error("Non exhaustive match in combineCommand.strategy")},operation:(n,r,t,e,u,i)=>{const c=zn(E(i));if("append"===n&&"add"===r)return Mn(t,e,Ir("append",u.plus));if("append"===n&&"mul"===r)return Mn(t,e,Ir("append",u.times));if("append"===n&&"max"===r)return O(c)(t,e);if("join"===n&&"add"===r)return Mn(t,e,Ir("join",O(i)));if("join"===n&&"mul"===r)return Mn(t,e,Ir("join",O(i)));if("join"===n&&"max"===r)return O(c)(t,e);if("min"===r)return Or.operation(n,"max",t,e,u,function(n){return j(((r,t)=>Kn(n.compare(r,t))))}(i));if("delta"===n&&"max"===r)return L(c)(t,e)?t:e.map(o);if("delta"===n)return Mn(t,e,((n,r)=>L(E(i))(n,r)?n:{kind:"bottom"}));throw new Error("Non exhaustive match in combineCommand.operation")},extend:(n,r,t,e)=>{if("delta"===n&&"top"===t.kind&&"top"===e.kind)return L(S)(t.error,e.error)?a(t.error):{kind:"bottom"};if("delta"===n&&"bottom"===e.kind)return t;if("delta"===n&&"bottom"===t.kind)return{kind:"bottom"};if("top"===t.kind&&"top"===e.kind)return a(O(S)(t.error,e.error));if("top"===t.kind)return t;if("top"===e.kind)return e;if("inner"===t.kind&&"inner"===e.kind)return r(t.a,e.a);if("bottom"===t.kind)return e;if("bottom"===e.kind)return t;throw new Error("Non exhaustive match in extend")}},Mr={plus:(n,r)=>n+r,times:(n,r)=>n*r};function Sr(n,r,t,e){if("unbounded"===n.kind&&"unbounded"===r.kind){const u=n.group,i=r.group;return K(o)(T((n=>c(s(n))))(Vn(u,i,t,e)))}if("windowed"===n.kind&&"windowed"===r.kind){const u=n.key,i=n.group,a=r.key,s=r.group,l=O(B(e))(u,a);return K(o)(T((n=>c(f(n,l))))(Vn(i,s,t,e)))}if("countLimit"===n.kind&&"countLimit"===r.kind){const u=n.n,i=r.n;if(u===i){const i=n.limit,a=n.group,s=r.limit,f=r.group,d=O(B(e))(i,s);return K(o)(T((n=>c(l(n,d,u))))(Vn(a,f,t,e)))}return a("Non matching counts")}if("uniqueLimit"===n.kind&&"uniqueLimit"===r.kind){const u=n.n,i=r.n;if(u===i){const i=n.limit,a=n.group,s=r.limit,f=r.group,l=O(B(e))(i,s);return K(o)(T((n=>c(d(n,l,u))))(Vn(a,f,t,e)))}return a("Non matching counts")}return a("Non matching group types")}function Gr(n,r,t,e,u,i){const c=(n,r)=>({1:xn(n)(r).concat(yn(Math.max(0,n-r.length),o)),2:Nn(n)(r)}),a=(r,t,e)=>{if(0===r.length)return Or.operation(n,"max",t,e,u,i);if(r.length>0){const[o,...s]=r,f=c(o[2],t),l=f[1],d=f[2],p=c(o[2],e),m=p[1],g=p[2];return Or.operation(n,o[1],l,m,u,i).concat(a(s,d,g))}throw new Error("Non exhaustive match in recurse")};return Ln((s=n=>"bottom"===n.kind,function(n){return n.slice(jn(n,s))})(Ln(a(r,t,e))));var s}function Er(r,t,e){return K(n)(_r(r,J)(t,e))}function _r(n,r){const t=r=>(t,e)=>Or.strategy(n,t,e)(_r(n,r)),e=(e,u)=>{if(W(ln(b({1:M,2:pn}))).equals(e.commands,u.commands)){const i=((r,e,u)=>{if("stringGroup"===e.kind&&"stringGroup"===u.kind){const n=Sr(e.group,u.group,t(r),S);return G(n,(n=>m($r(n,S))))}if("numberGroup"===e.kind&&"numberGroup"===u.kind){const n=Sr(e.group,u.group,t(r),mn);return G(n,(n=>p($r(n,mn))))}if("tuple"===e.kind&&"tuple"===u.kind){const t=D(r)?r.value:[];return c(g(Gr(n,t,e.tuple,u.tuple,Mr,mn)))}throw new Error(`Non matching payload. Got ${e.kind} and ${u.kind}`)})(H(e.commands)?r:e.commands,e.payload,u.payload);return G(i,(n=>h(e.commands,n)))}throw new Error(`Non matching primitive strings. Got ${sr(e)} and ${sr(u)}`)};return(r,t)=>fr(v(Or.extend(n,e,kr(r).state,kr(t).state)))}function Ar(n,r,t){const e=T((r=>Zn(n,(([n,e])=>{return(u=t,function(n,r){return-1!==u.compare(n,r)})(n,r);var u}))))(r);return K((()=>n))(e)}function $r(n,r){switch(n.kind){case"unbounded":return n;case"windowed":return H(n.key)?n:f(Ar(n.group,n.key,r),n.key);case"countLimit":{const t=n.limit,e=n.n,u=n.group,i=(n,r)=>r<=1?J:P(r-1),o=Xn(e,u,i,r),c=O(B(r))(t,o);return l(Ar(u,c,r),c,e)}case"uniqueLimit":{const t=n.limit,e=n.n,u=n.group,i=(n,r)=>{if("object"===n.kind){const t=[...n.value.keys(),...r.keys()],u=new Set(t);return u.size>=e?J:P(u)}return J},o=Xn(new Set,u,i,r),c=O(B(r))(t,o);return d(Ar(u,c,r),c,e)}}}function Ir(n,r){return(t,e)=>Or.extend(n,((n,t)=>c(r(n,t))),t,e)}function Cr(n,r,t,e,u,i,o,c,a){switch(arguments.length){case 1:return n;case 2:return r(n);case 3:return t(r(n));case 4:return e(t(r(n)));case 5:return u(e(t(r(n))));case 6:return i(u(e(t(r(n)))));case 7:return o(i(u(e(t(r(n))))));case 8:return c(o(i(u(e(t(r(n)))))));case 9:return a(c(o(i(u(e(t(r(n))))))));default:for(var s=arguments[0],f=1;f<arguments.length;f++)s=arguments[f](s);return s}}var zr=function(n){return"Some"===n._tag},Jr={_tag:"None"},Pr=function(n){return{_tag:"Some",value:n}},Rr=function(n){return"Left"===n._tag},Fr=Object.prototype.hasOwnProperty,Wr=Rr,Br=function(n){return function(r){return Wr(r)?n(r.left):r.right}};var Tr=function(n){return function(r){return!n(r)}};var Ur=Jr,Dr=Pr;var Hr=zr;var Kr=function(n){for(var r in n)if(Fr.call(n,r))return!1;return!0};function Qr(n){return function(r){var t={},e=!1;for(var u in r)if(Fr.call(r,u)){var i=r[u];n(u,i)?t[u]=i:e=!0}return e?t:r}}var Vr=function(n){return Qr((function(r,t){return n(t)}))};var Xr=Kr;var Yr=Vr;Yr(Tr(Xr));Tr((function(n){return 0===n.length}));function Zr(n,r){const t=Object.keys(n),e=t.length,u={};for(let i=0;i<e;i++){const e=t[i],o=r(e,n[e]);Hr(o)&&(u[e]=o.value)}return u}function nt(n,r){const t=Cr((n=>Zr(n,((n,r)=>r.state?Dr({[r.checksum]:r.state}):Ur)))(n),tr,Br((n=>u(new Map)))),e=Cr(tr(r),Br((n=>u(new Map))));return Cr(function(n,r){return Er("delta",n,r)}(t,e),(n=>rr(n)))||{}}!function(n){const r=self;function t(n,t,e,u){function i(t){if("function"!=typeof r.postMessage)return n.ports[0].postMessage(t);r.postMessage(t)}if(!e)return i([t,null,u]);"undefined"!=typeof console&&"error"in console&&console.error("Worker caught an error:",e),i([t,e])}r.addEventListener("message",(function(r){if(e=r,!Array.isArray(e.data)||2!==e.data.length)return;var e;const u=r.data,[i,o]=u;if("function"==typeof n)return function(n,r,e,u){const i=function(n,r){try{return{res:n(r)}}catch(n){return{err:n}}}(r,u);return Boolean(null===(o=i)||void 0===o?void 0:o.err)?t(n,e,i.err):!(c=i.res)||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof c.then?t(n,e,null,i.res):void i.res.then((function(r){t(n,e,null,r)}),(function(r){t(n,e,r)}));var o,c}(r,n,i,o);t(r,i,new Error("Please pass a function into register()."))}))}((function(n){switch(n.type){case"delta":return nt(n.stateMap,n.lastSentStateMapWithChecksum);case"noop":return{}}}))})();',"Worker",void 0,void 0)}var p=i(7545),d=i(7121);function _(){return(0,o.h)(new l)}const g={concat:(e,t)=>Object.assign(Object.assign({},e),t),empty:{}};class m{constructor(e,t,i,n,r,o,s,a,c){this.api=e,this.network=t,this.sessionManager=i,this.permutiveData=n,this.queryManager=r,this.metrics=o,this.userId=s,this.eventSourceId=a,this.stateWorker=c,this.DEBOUNCE_TIME=1e3,this.MAX_DEBOUNCE_TIME=5e3,this.fetchUnseenState=!0,this.scheduler=new p.b(this.DEBOUNCE_TIME,this.MAX_DEBOUNCE_TIME),this.debouncedSyncIfNotEmpty=this.scheduler.scheduleAccumulated((e=>this.syncIfNotEmpty.bind(this)("standard",e)),g),this.fetchUnseenState=!!f.includes("7c6db7ee-7cf2-4f9a-853a-78875d37e2bb")||this.sessionManager.sessionHasChanged(),this.stateOffset=this.permutiveData.getData("state_offset")||0,this.lastSentStateMapWithChecksum=(0,d.Yh)(this.permutiveData.getData("internal_query_states")||{}),this.stateWorker.postMessage({type:"noop"})}sync(e){return(0,a.zG)(this.debouncedSyncIfNotEmpty(e),(e=>Promise.resolve()))}syncWithUnseen(){return this.syncIfNotEmpty("unseen",{}).then(a.Q1)}syncIfNotEmpty(e,t){const[i,n,o]="standard"===e?[this.stateOffset,t,this.fetchUnseenState]:"unseen"===e?[this.stateOffset,this.queryManager.stateMap.value,!0]:[0,{},!0],s=this.metrics.startTimer("sdk_compute_delta_seconds",{}),c={type:"delta",stateMap:n,lastSentStateMapWithChecksum:this.lastSentStateMapWithChecksum},u=this.stateWorker.postMessage(c).then((e=>(this.metrics.stopTimer("sdk_compute_delta_seconds",s),e))),l=e=>{this.fetchUnseenState=!1;const t=(0,a.ls)((e=>this.network.error(`Error sending state delta. Got ${(0,r.w)(e)}`,this.userId.get())),(e=>({})));return this.api.state(this.metrics,this.userId.get(),this.eventSourceId.get(),e,i,o).then((e=>function(e){return!!e}(e)?this.onStateResponse(e):{})).then((t=>(this.lastSentStateMapWithChecksum=e,t))).catch(t)};return u.then((e=>o||Object.keys(e).length>0?l(e):Promise.resolve({})))}resetSync(){return(0,n.mG)(this,void 0,void 0,(function*(){this.reset(),yield this.syncIfNotEmpty("reset",{})}))}reset(){this.lastSentStateMapWithChecksum={}}onStateResponse(e){const t=(0,s.Y3)((()=>JSON.parse(e.state)),(e=>this.network.error(`Failed to parse State API response, got ${e}`,this.userId.get()))),i=e=>e?this.queryManager.updateExternalState(e):(0,a.Q1)();return(0,s.tO)(t)?(0,a.zG)(e.state_offset,(e=>this.stateOffset=e),(e=>this.permutiveData.setData("state_offset",e)),(e=>i(t.right)),(e=>t.right)):{}}}const f=["fe68d1f7-c9f4-45b3-8905-7cda73d3fd74"]},7258:(e,t,i)=>{i.d(t,{u:()=>n});class n{constructor(e,t,i,n,r){this.permutiveData=e,this.permutiveReset=t,this.userId=i,this.viewId=n,this.eventsCache=r}getPermutiveData(e){return this.permutiveData.getData(e)}setPermutiveData(e,t){return this.permutiveData.setData(e,t)}getStateSizeInBytes(){return this.permutiveData.getDataSize()+this.eventsCache.getStateSizeInBytes()}reset(){return this.permutiveReset.reset()}}},7846:(e,t,i)=>{i.d(t,{M:()=>s});var n=i(3735),r=i(6567),o=i(6013);class s{constructor(e,t,i,n){this.config=e,this.clientContext=t,this.cookies=i,this.externalData=n,this.userId=this.getOrGenerateUserId(),this.set(this.userId)}isEqual(e){return this.userId===e}get(){return this.userId}set(e){this.cookies.setCookie(this.config.cookieName,e,!0),this.externalData.setExternalData(this.config.cookieName,e),this.clientContext.updateContext(["user_id",e]),this.userId=e}getOrGenerateUserId(){return(0,r.fS)((()=>(0,r.fS)(o.k$)(this.getUserIdFromLocalStorage())))(this.getUserIdFromCookie())}getUserIdFromCookie(){return this.getUserIdFromStorageIfValid("cookie")}getUserIdFromLocalStorage(){return this.getUserIdFromStorageIfValid("localStorage")}getUserIdFromStorageIfValid(e){const t=(0,r.DT)(o.Gz);return(0,n.zG)("cookie"===e?this.cookies.getCookie(this.config.cookieName):this.externalData.getExternalData(this.config.cookieName),r.ij,(0,r.tS)(t))}}},6919:(e,t,i)=>{i.d(t,{W:()=>r});var n=i(6013);class r{constructor(e,t){this.clientContext=e,this.config=t,t.viewId&&(0,n.Gz)(t.viewId)?this.set(t.viewId):this.generateAndSet()}get(){return this.viewId}generateAndSet(){return this.set((0,n.k$)())}set(e){return this.viewId=e,this.clientContext.updateContext(["view_id",this.viewId]),this.viewId}}},2485:(e,t,i)=>{i.d(t,{_:()=>r});var n=i(5097);const r=e=>{const{logger:t,consentTracking:i}=e,r=(e,i)=>(t.debug(`DB: Failed to write ${String(i)} as consent is revoked`),Promise.resolve(i));return e=>class extends e{constructor(){super(...arguments),this.put=(0,n.v)(super.put.bind(this),r,i.isRevoked)}}}},3195:(e,t,i)=>{i.d(t,{S:()=>a});var n=i(3735),r=i(2485),o=i(787);class s{constructor(e){this.namespace=e}put(e,t){return(0,n.zG)(this.namespace.getNamespacedStorageKey(String(t)),(t=>window.localStorage.setItem(t,JSON.stringify(e))),(e=>Promise.resolve(t)))}get(e){return(0,n.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>window.localStorage.getItem(e)),o.A,(e=>Promise.resolve(e)))}delete(e){return(0,n.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>Promise.resolve(window.localStorage.removeItem(e))))}deleteStore(){return Promise.resolve()}}const a=(e,t,i)=>new((0,n.zG)(s,(0,r._)({logger:t,consentTracking:i})))(e)},5595:(e,t,i)=>{i.d(t,{m:()=>n});class n extends Error{constructor(e){super(e),this.name="StoreClosingError"}}},1057:(e,t,i)=>{i.d(t,{Ec:()=>s,_8:()=>o});var n=i(6567),r=i(6013);const o=e=>{const t=e.__tcfapi,i={type:"aborted"},o=["tcloaded","useractioncomplete"];return t?(0,r.a4)((()=>a(t,"getTCData")),(()=>a(t,"getTCData").then((e=>"loaded"===(null==e?void 0:e.cmpStatus)&&o.includes(null==e?void 0:e.eventStatus))))).then((0,n.g_)((()=>i),(e=>({type:"loaded",data:e})))):Promise.resolve({type:"missing"})},s=e=>e.gdprApplies?(0,n.G)(e.vendor.consents):n.YP,a=(e,t)=>new Promise((i=>{e(t,2,(e=>{i(e)}))}))},3351:(e,t,i)=>{i.d(t,{D:()=>n});const n={tradedesk:21,ddp:755,appnexus:32,pubmatic:76,neustar_fabrick:468}},2520:(e,t,i)=>{i.d(t,{U:()=>s});var n=i(655),r={equals:function(e,t){return e===t}},o=i(6013);class s{constructor(e,t,i,n,r,o,s,a,c,u,l){this.network=e,this.logger=t,this.api=i,this.permutiveData=n,this.messages=r,this.sessionManager=o,this.metrics=s,this.permutiveIdentity=a,this.queryManager=c,this.permutive=u,this.userId=l,this.lastUserIdentitiesChecked=new Date,this.logger.log("Enabling tpd reporting"),this.messages.on("permutive:segments:updated",(()=>{this.reportUsage()})),this.readThirdPartyCohorts(),this.lastCheckedSession=this.permutiveData.getData("third-party-data-session-id")||""}readThirdPartyCohorts(){this.userSegments=this.permutiveData.getData("third-party-data")||{},this.segmentsPromise=Promise.resolve(this.userSegments)}shouldUseSegmentsInMemory(){const e=this.lastUserIdentitiesChecked>=this.permutiveIdentity.getIdentitiesLastModified;return this.lastUserIdentitiesChecked=new Date,e&&this.lastCheckedSession===this.sessionManager.getSessionId()&&!!this.segmentsPromise}segments(){if(this.shouldUseSegmentsInMemory())return this.segmentsPromise;const e=this.sessionManager.getSessionId(),t=(0,o.b2)();this.lastCheckedSession=e;const i=this.metrics.startTimer("sdk_get_third_party_data_task_duration_seconds",{}),n=Object.assign(Object.assign({},this.permutiveIdentity.getCustomerDefinedIdentitiesMap()),this.permutiveIdentity.getTPDIdentitiesMap());if(Object.keys(n).length>0){const e=this.permutiveIdentity.getPrioritizedIdentities(n),i=a(e);this.api.tpd(this.metrics,i).then((e=>{this.userSegments=c(e),t.resolve(this.userSegments)})).catch((e=>{this.network.error(`Third Party Data segments retrieval failed with reason: ${e}`,this.userId.get()),t.resolve({})}))}else t.resolve({});const s=t.promise.then((e=>this.userSegments));return s.then((t=>{this.permutiveData.setData("third-party-data-session-id",e),this.metrics.stopTimer("sdk_get_third_party_data_task_duration_seconds",i);const n=this.permutiveData.getData("third-party-data")||{},s=(0,o.rB)((0,o.rB)(r)),a=(0,o.rB)(r);if(0===Object.keys(n).length||!s.equals(n,t)){this.permutiveData.setData("third-party-data",this.userSegments);const e=Object.entries(t||{});(n?e.filter((([e,t])=>!a.equals(n[e]||{},t))):e).forEach((([e,t])=>this.fireSegments(e,Object.keys(t))))}})),this.segmentsPromise=s}reset(){this.segmentsPromise=null,this.userSegments={}}fireSegments(e,t){this.permutive.track("ThirdPartySegments",{data_provider:e,segments:t})}reportUsage(){const e=u(this.queryManager.stateMap.value),t=(0,o.vp)(JSON.stringify(e));if(this.permutiveData.getData("third-party-data-usage")!==t&&Object.keys(e).length>0){this.permutiveData.setData("third-party-data-usage",t);const i={user_id:this.userId.get(),time:new Date,tpd_segments:e};this.api.tpdUsage(this.metrics,i)}}}const a=e=>(null==e?void 0:e.reduce(((e,t)=>(e[t.tag]=t.id,e)),{}))||{},c=e=>Object.entries(e).reduce(((e,[t,i])=>Object.assign(Object.assign({},e),{[t]:(0,o.j5)(i)})),{}),u=e=>{const t={},i=Object.keys(e),r=i.length;for(let o=0;o<r;o++){const r=i[o],s=e[r],{activations:a}=s;(0,n._T)(s,["activations"]);a&&Object.keys(a).length>0&&(t[r]=a)}return t}},2223:(e,t,i)=>{i.d(t,{C:()=>c});var n=i(655),r=i(9320),o=i(3735);const s=(a=[[{name:"dfp",import:Promise.resolve().then(i.bind(i,242))}],[],[],[],[],[],[],[{name:"clean_room",import:Promise.resolve().then(i.bind(i,5607))}],[],[],[],[{name:"facebook_pixel_v2",import:Promise.resolve().then(i.bind(i,4892))}],[],[],[],[],[{name:"overlays",import:Promise.resolve().then(i.bind(i,718))}],[],[],[],[],[],[],[],[{name:"scriptrunner",import:Promise.resolve().then(i.bind(i,7926))}],[],[],[],[{name:"web",import:Promise.resolve().then(i.bind(i,8482))}],[],[]],(0,o.zG)((0,r.xH)(a),(0,r.u4)({},((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.import})))));var a;const c=({_internals:e,logger:t,network:i,permutiveMethods:r,q:o,clientContext:a})=>{const c=Object.entries(s).map((([s,c])=>(0,n.mG)(void 0,void 0,void 0,(function*(){return t.log(`Loading addon ${s}`),(yield c).load(o,r,e,i,a)}))));return Promise.all(c)}},2127:(e,t,i)=>{i.r(t),i.d(t,{createAddon:()=>E,getCachedClassificationModelSegments:()=>v,getCachedCleanRoomSegments:()=>y,getCachedDFPSegments:()=>w});var n=i(2688),r=i(9320),o=i(3735),s=i(6567),a=i(2751);var c=i(8863),u=i(5506),l=i(6013);const p=e=>Array.isArray(e)?{gam:e,xandrSsp:[]}:e,d="_pdfps";i(9678);let _=!1;let g;const m=e=>{const{logger:t}=e;!0!==_&&googletag.pubadsReady&&(null!=g||(g=({slot:i})=>{const{getContentUrl:n}=i;if(!n||"function"!=typeof n)return;(0,o.zG)(n(),(0,a.pn)("&trunc=1"))&&(t.debug("DFP content URL has been truncated!"),(({metrics:e,logger:t})=>{_||(e.track({name:"sdk_targeting_size_limit_exceeded_count",value:1,labels:{target:"dfp"}}),_=!0,t.debug("DFP has exceeded targeting limit"))})(e),googletag.pubads().removeEventListener("slotRenderEnded",g),g=null)}),googletag.pubads().addEventListener("slotRenderEnded",g))},f={liveSegments:[],classificationModelSegments:[],cleanRoomSegments:[],eligibleSegments:{}},h={segments:f,getGAMKeyValues:()=>({permutive:h.segments.liveSegments.join(",")})},v=e=>{const t=s.fS((()=>({gam:[],xandrSsp:[]})));return(0,o.zG)(e.getExternalJsonData("_pclmc"),s.ij,(0,s.UI)(p),t)},y=e=>{const t=e.getExternalJsonData(c.P)||[],i=e.getExternalJsonData(c.l)||[];return(0,r.G0)(a.Eq)(t)(i)},w=e=>e.getExternalJsonData(d)||[],b=(e,t)=>e.filter((e=>e in t)).map((e=>t[e])),q=(e,t)=>{const{logger:i,externalData:o,network:s}=e;let a=t.map(String).concat(f.classificationModelSegments).concat(f.cleanRoomSegments);if(0===a.length)return i.debug("DFP has no targeting values, skipping update"),f.liveSegments;i.debug("DFP is updating with targeting values",a),((e,t,i)=>{const{logger:n}=e;window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],m(e),window.googletag.cmd.push((()=>{const{getTargeting:e,setTargeting:o}=googletag.pubads(),s=e("permutive")||[],a=Object.values(t.eligibleSegments).map(String).concat(t.classificationModelSegments).concat(t.cleanRoomSegments).concat("rts"),c=(0,r.uK)((e=>a.includes(e))),{left:u}=c(s),l=i.concat(u).concat("rts");n.debug("DFP setting GPT targeting to",l),o("permutive",l)}))})(e,f,a);try{o.setExternalJsonData(d,a)}catch(e){const t=(0,n.w)(e),r="DFP failed to set data. Got:";i.error(r,t),s.error(`${r} ${t.message}`)}return(({api:e,logger:t},i)=>{(0,u.$S)("sync_segments_cookie",!1)?(t.debug("DFP syncing segment cookie _pdfps"),e.segmentSync({key:d,value:i})):t.debug("DFP sync segments cookie not enabled, skipping sync")})(e,JSON.stringify(a)),i.debug("DFP live segments updated to",t),t},k=e=>{const{logger:t,messages:i,queryManager:n,externalData:r,cookies:o,network:s,userId:a}=e;i.on("permutive:segments:updated",(0,l.Z_)(s,a,(()=>{t.debug("DFP received 'permutive:segments:updated' event");const i=n.userSegments.getAllAsList();f.liveSegments=((e,t)=>{const{logger:i}=e,n=b(t,f.eligibleSegments);return(0,l.cO)(n,f.liveSegments)?(i.debug("DFP new segments are equal to live segments, skipping update"),f.liveSegments):q(e,n)})(e,i)}))),i.on("permutive:classificationmodels:db:updated",(0,l.Z_)(s,a,(i=>{t.debug("DFP received 'permutive:classificationmodels:db:updated' event"),f.classificationModelSegments=i.gam,f.liveSegments=q(e,f.liveSegments)}))),i.on("permutive:cleanroom:db:updated",(0,l.Z_)(s,a,(i=>{t.debug("DFP received 'permutive:cleanroom:db:updated' event"),f.cleanRoomSegments=i,f.liveSegments=q(e,f.liveSegments)}))),i.on("permutive:reset",(0,l.Z_)(s,a,(()=>{t.debug("DFP received 'permutive:reset' event"),r.removeExternalData(d),o.deleteCookie(d),f.liveSegments=[]})))},E=e=>{const{logger:t,activationManager:i,queryManager:n,messages:r,externalData:o}=e;f.classificationModelSegments=v(o).gam,f.cleanRoomSegments=y(o),f.eligibleSegments=(e=>{const t=e.getSpecializedActivations("dfp"),i={};for(const e of t.dfp)i[e]=e;for(const e of Object.keys(t.dfp_legacy)){const n=Number(e);i[n]=t.dfp_legacy[n]}return i})(i),f.liveSegments=w(o),t.debug("DFP initialised with segments",f);const s=n.userSegments.getAllAsList(),a=b(s,f.eligibleSegments);return f.liveSegments=q(e,a),k(e),r.emit("permutive:dfp:ready"),h}},242:(e,t,i)=>{i.r(t),i.d(t,{load:()=>a});var n=i(64),r=i(6013),o=i(2127);const s={},a=(e,t,i)=>{e.push({functionName:"addon",arguments:["dfp",{}]});window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((()=>c(t,i)))},c=(e,t)=>{e.ready(t.makeSafe((()=>h(t.metrics))),"realtime"),v(t.externalData),b(t.userId,t.viewId),_(e),googletag.cmd.push((()=>{g(e),m(e)})),window.addEventListener("message",l(e),!1)},u=({advertiserId:e,campaignId:t,lineItemId:i,creativeId:n})=>({advertiser_id:(0,r.ke)(e),campaign_id:(0,r.ke)(t),line_item_id:(0,r.ke)(i),creative_id:(0,r.ke)(n)}),l=e=>t=>{var i;try{const n=JSON.parse(t.data);if(!n.permutive_type||"google_ad_click"!==n.permutive_type)return;const{ad_unit_path:r,creative_id:o,advertiser_id:a,order_id:c,line_item_id:l}=null!==(i=null==n?void 0:n.data)&&void 0!==i?i:{},d=u({lineItemId:l,advertiserId:a,campaignId:c,creativeId:o});let _;Object.keys(s).some((e=>{const{slot:t,creative_id:i}=s[e];if((null==t?void 0:t.ad_unit_path)===r&&i===d.creative_id)return _=s[e],!0})),_=null!=_?_:Object.assign(Object.assign({},d),{is_empty:!1}),p(e,_)}catch(e){}},p=(e,t)=>{n.PH&&t&&e.track("SlotClicked",t)},d=(e,t,i)=>{s[t]=i,f(e,i),w(e,t)},_=e=>{const t=googletag.pubadsReady&&googletag.pubads().getSlots();t&&t.forEach((t=>{const i=t.getResponseInformation();if(!i)return;const n=Object.assign(Object.assign({},u(i)),{is_empty:!1,service_name:"publisher_ads",slot:y(t)}),r=t.getSlotElementId();d(e,r,n)}))},g=e=>{googletag.pubads().addEventListener("slotRenderEnded",(t=>{const i=Object.assign(Object.assign({},u(t)),{is_empty:t.isEmpty,service_name:t.serviceName,slot:y(t.slot)});if(t.size){const[e,n]=t.size;"number"==typeof e&&"number"==typeof n&&(i.width=e,i.height=n)}const n=t.slot.getSlotElementId();d(e,n,i)}))},m=e=>{n.EW&&googletag.pubads().addEventListener("impressionViewable",(({slot:t,serviceName:i})=>{const n=t.getResponseInformation();if(!n)return;const r=Object.assign(Object.assign({},u(n)),{service_name:i,slot:y(t)});e.track("SlotViewable",r)}))},f=(e,t)=>{if(!n.CL)return;var i;i=Object.assign(Object.assign({},t),{rendered_timestamp:Date.now()}),e.track("SlotRendered",i)},h=e=>{let t=0;const i=googletag.pubadsReady&&googletag.pubads().getSlots();i&&i.forEach((e=>e.getResponseInformation()&&t++));const n=0===t?"sdk_targeting_realtime_success_count":"sdk_targeting_realtime_fail_count";e.track({name:n,value:1,labels:{target:"dfp"}})},v=e=>{const t=(0,o.getCachedDFPSegments)(e);googletag.cmd.push((()=>{const{getTargeting:e,setTargeting:i}=googletag.pubads(),n=e("permutive")||[];i("permutive",[...new Set([...t.map(String),...n])])}))},y=e=>{const t={ad_unit_path:e.getAdUnitPath(),slot_element_id:e.getSlotElementId()};return n.jH?Object.assign(Object.assign({},t),(()=>{const t={},i=[];let n=[];const r=(e,r)=>{const o="slot"===e?e=>t[e]=1:()=>{},s=r.getTargetingKeys();n=s;for(let s=0;s<n.length;s++){const a=n[s];if(void 0!==t[a]&&"service"===e)continue;const c=[],u=r.getTargeting(a);for(let e=0;e<u.length;e++)c.push(u[e].toString());c.length>0&&(o(a),i.push({key:a,value:c}))}};return r("slot",e),r("service",googletag.pubads()),{targeting_keys:i}})()):t},w=(e,t)=>{let i=!1;const n=()=>{i&&p(e,s[t])},r=()=>{i=!0},o=()=>{i=!1};try{window.addEventListener("blur",n);const e=document.getElementById(t);e.addEventListener("mouseover",r),e.addEventListener("mouseout",o)}catch(e){}},b=(e,t)=>{const{setTargeting:i}=googletag.pubads()}},718:(e,t,i)=>{i.r(t),i.d(t,{OverlaysAddon:()=>o,load:()=>r});var n=i(6013);const r=e=>{e.unshift({functionName:"addon",arguments:["overlays",{}]})};class o{constructor(e){const t=this;this.permutive=e.permutive,this.options=e,this.activations=this.options.activationManager.getActivations("overlays"),this.loadedImageCounts={};for(let i=0;i<this.activations.length;i++){const r=this.activations[i],o=r.getSegmentCode(),s=r.getTriggerType(),a=r.getConfig(),c=this.buildOverlayCss(a,i);document.head.insertAdjacentHTML("beforeend",c);const u=this.buildOverlayBody(a,i);document.body.insertAdjacentHTML("beforeend",u);const l=`permutive-overlay-${i}`,p=document.getElementById(l),d=p.getElementsByClassName("close")[0],_=p.getElementsByClassName("content")[0],g=()=>{p.style.visibility="hidden",p.style.opacity="0"},m=e=>{_.contains(e.target)||(g(),p.removeEventListener("click",m))};d.addEventListener("click",g),p.addEventListener("click",m);[].slice.call(p.getElementsByTagName("a")).slice(1).forEach((e=>{e.addEventListener("click",(function(){r.trackConversion({useBeacon:!0})}))}));const f=p.getElementsByTagName("form")[0];f&&f.addEventListener("submit",(function(e){e.preventDefault(),r.trackConversion({success:function(){f.submit()}})}));const h=function(e,i){t.showOverlay(e),i.trackImpression()};"EveryTime"===s?this.permutive.segment(o,(0,n.Z_)(e.network,e.userId,(e=>{e?h(l,r):this.permutive.trigger(o,"result",(function(e){e.result&&h(l,r)}))}))):"OnEntry"===s?this.permutive.trigger(o,"result",(0,n.Z_)(e.network,e.userId,(function(e){e.result&&h(l,r)}))):"OnExit"===s&&this.permutive.trigger(o,"result",(0,n.Z_)(e.network,e.userId,(function(e){e.result||h(l,r)})))}}buildOverlayCss(e,t){return'<style type="text/css">.${overlay_class}{position:fixed;top:0;bottom:0;left:0;right:0;width:100%;height:100%;background:rgba(0,0,0,0.${opacity_percentage});transition:opacity ${opacity_transition_ms}ms;visibility:hidden;opacity:0;z-index:1000000;}.${modal_class}{position:fixed;padding:10px;background:#fff;border-radius:5px;z-index:1000001}.${modal_class} .content{overflow:auto;z-index:1000002;}.${modal_class} .close{position:absolute;top:20px;right:30px;transition:all 200ms;font-size:30px;font-weight:bold;text-decoration:none;color:#333;z-index:1000003}.${modal_class} .close:hover{color:orange;}</style>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${opacity_percentage}",e.opacity_percentage.toString()).replace("${opacity_transition_ms}",e.opacity_transition_ms.toString())}buildOverlayBody(e,t){const i=this.options.config.windowKey;let n="";return!function(e){return void 0!==e.html}(e)?function(e){return void 0!==e.image_url&&void 0!==e.image_link}(e)&&(n='<a href="'+e.image_link+'"><img src="'+e.image_url+'"/></a>'):n=e.html,'<div id="${overlay_class}" class="${overlay_class}"><div id="${modal_class}" class="${modal_class}"><a class="close" href="javascript:;">&times;</a><div class="content">${content}</div></div></div>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${content}",n).replace(/<img /g,`<img onload='window[${i}].addons.overlays.loadedImage("permutive-overlay-" + num + "")' `)}showOverlay(e){const t=document.getElementById(`${e}`),i=()=>{const e=t.getElementsByTagName("div")[0],i=e.getBoundingClientRect().height,n=e.getBoundingClientRect().width;e.style.left=window.innerWidth/2-n/2+"px",e.style.top=window.innerHeight/2-i/2+"px",t.style.visibility="visible",t.style.opacity="1"},n=t.getElementsByTagName("img");if(n.length>0){let t=0;const r=()=>{t<10&&(!(e in this.loadedImageCounts)||this.loadedImageCounts[e]<n.length)?(t+=1,setTimeout(r,500)):i()};r()}else i()}loadedImage(e){e in this.loadedImageCounts?this.loadedImageCounts[e]=this.loadedImageCounts[e]+1:this.loadedImageCounts[e]=1}}},4892:(e,t,i)=>{i.r(t),i.d(t,{FacebookV2Pixel:()=>r,load:()=>o});var n=i(6013);class r extends class extends class{constructor(e,t){this.isFirstRun=void 0===e.permutiveData.getData(t),this.cachedSegmentsMembership=e.userSegments.getAllAsMap(),this.isFirstRun&&e.permutiveData.setData(t,!0),e.messages.on("permutive:reset",(()=>e.permutiveData.setData(t,!1)))}}{constructor(e,t,i){super(e,i);e.activationManager.getActivations(t).forEach((t=>{const i=t.getSegmentCode(),n=i in this.cachedSegmentsMembership;this.isFirstRun&&n?this.fire(t,n):e.permutive.trigger(i,"",(e=>{this.fire(t,e.result)}))}))}}{constructor(e){super(e,"facebook_pixel_v2","addon:facebook_pixel_v2")}fire(e,t){fbq("trackCustom",!0===t?"PermutiveSegmentEntry":"PermutiveSegmentExit",{segment_id:e.getSegmentCode()}),e.trackImpression()}}const o=(e,t)=>{(0,n.a4)((()=>t.addon("facebook_pixel_v2",{})),(()=>"undefined"!=typeof fbq),{waitTimeInMs:1e3,maxAttempts:3})}},7926:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ScriptRunnerAddon:()=>ScriptRunnerAddon,load:()=>load});const load=e=>{e.unshift({functionName:"addon",arguments:["scriptrunner",{}]})};class ScriptRunnerAddon{constructor(options){this.permutive=options.permutive,this.options=options,this.network=options.network,this.activations=this.options.activationManager.getActivations("scriptrunner");for(let i=0;i<this.activations.length;i++){const activation=this.activations[i],triggerType=activation.getTriggerType(),segmentCode=activation.getSegmentCode(),run=activation=>{const script=activation.getConfig().script.replace(/impression\(\)/g,"activation.trackImpression();").replace(/conversion\(\)/g,"activation.trackConversion();");try{eval(script)}catch(e){e instanceof Error&&(e.message="Error running custom script: "+e.message,this.network.error(e,this.options.userId.get()))}};"EveryTime"===triggerType?this.permutive.segment(segmentCode,(e=>{e?run(activation):this.permutive.trigger(segmentCode,"result",(function(e){e.result&&run(activation)}))})):"OnEntry"===triggerType?this.options.queryManager.segmentEntryQueryCodes.has(segmentCode)?run(activation):this.permutive.trigger(segmentCode,"result",(function(e){e.result&&run(activation)})):"OnExit"===triggerType&&(this.options.queryManager.segmentExitQueryCodes.has(segmentCode)?run(activation):this.permutive.trigger(activation.getSegmentCode(),"result",(function(e){e.result||run(activation)})))}}}},8482:(e,t,i)=>{i.r(t),i.d(t,{WebAddon:()=>E,load:()=>k});var n=i(655),r=i(2688),o=i(8198),s=i(3735),a=i(4011),c=i(6567),u=i(7209),l=i(64),p=i(6013),d=i(3760),_=i(5506);const g=(0,_.MU)("add_alchemy_entities",!1),m=(0,_.MU)("add_alchemy_taxonomy",!1);function f(e){return Object.assign(Object.assign(Object.assign({},e&&m?{taxonomy_labels:"$alchemy_taxonomy_labels"}:{}),e&&g?{entity_names:"$alchemy_entity_names"}:{}),{classifications_watson:{taxonomy_labels:"$taxonomy_labels"}})}function h(e,t,i,n){const r=Object.assign(Object.assign(Object.assign({isp_info:"$ip_isp_info",geo_info:"$ip_geo_info"},{}),e),t);i.track("Pageview",r).then((e=>{n.emit("permutive:event:pageview",e)}))}function v(e,t,i,n,r,o){return Object.assign(Object.assign(Object.assign({isp_info:"$ip_isp_info",geo_info:"$ip_geo_info"},n),i),{aggregations:Object.assign({PageviewEngagement:Object.assign({engaged_time:e},l.UW?{completion:t}:{})},l.ED?{SegmentEntry:Array.from(r),SegmentExit:Array.from(o)}:{})})}function y(e,t,i,n,r,o,s,a=!0,u=c.YP){const l=v(e,t,i,n,r,o),p=(0,c.fS)((()=>null))(u);let d={useBeacon:a};null!==p&&(d=Object.assign(Object.assign({},d),{unprocessedData:p})),s.track("PageviewComplete",l,d)}const w=["mousemove","click","scroll"],b=["email","tel","submit","reset","button","file","password","radio","checkbox"],q=["email","e-mail","password","tel","telephone","phone","name_first","name_last","sa_zip"],k=(e,t)=>{0};class E{constructor(e){this.dirtyState=!1,this.totalCompletion=0,this.totalEngagedTime=0,this.hasPageviewCompleteFired=!1,this.cleanupPageEngagementDetection=s.Q1,this.permutive=e.permutive,this.options=e,this.api=e.api,this.clientContext=e.clientContext,this.logger=e.logger,this.unprocessedPVC=e.unprocessedEvents.PageviewComplete,this.options.customProperties.overrideCustomProps(e.page||{});this.pageEngagementDetected=(()=>{this.dirtyState=!0,l.Uy&&this.resetTimeout()}).bind(this),h(f(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.permutive,this.options.messages),this.enablePageEngagementDetection(),"loading"!==document.readyState?this.attachListeners():window.addEventListener("DOMContentLoaded",this.attachListeners.bind(this),!1),l.t2&&(this.timerHandle=this.registerEngagementInterval(this.getEventInterval())),l.Uy&&(this.setPageviewCompleteTimeout(l.MU),(0,p.aq)((()=>{this.hasPageviewCompleteFired||y(this.totalEngagedTime,this.totalCompletion,f(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.options.queryManager.segmentEntryQueryCodes,this.options.queryManager.segmentExitQueryCodes,this.permutive)}),navigator.userAgent))}sendLinkClickEvent(e,t){if(window.location.href&&e.href){const i=0===e.href.indexOf("data:")?"NOT_URL":e.href;this.permutive.track("LinkClick",{dest_url:i},{useBeacon:t})}}sendFormSubmissionEvent(e){{const t=e.currentTarget,i={form:Object.assign(Object.assign(Object.assign({method:t.method||"GET",properties:this.serializeForm(t)},"string"==typeof t.id?{id:t.id}:{}),t.name&&"string"==typeof t.name?{name:t.name}:{}),t.action&&"string"==typeof t.action?{action:t.action}:{})};this.permutive.track("FormSubmission",i)}}trackEngagementInterval(e){return(0,s.zG)(this.updateState(e),(({engaged_time:e,total_engaged_time:t,completion:i,total_completion:n})=>function(e,t,i,n,r,o){const s=Object.assign(Object.assign({isp_info:"$ip_isp_info",geo_info:"$ip_geo_info",engaged_time:e,total_engaged_time:t},r),{completion:i,total_completion:n});o.track("PageviewEngagement",s)}(e,t,i,n,this.options.customProperties.getCustomProps(),this.permutive)),(e=>{if(!this.hasPageviewCompleteFired)return function(e,t,i,n,r,o,s,a,c,u){const l=v(e,t,s,a,c,u);return r.then((e=>{const t={props:l,sessionId:i,viewId:n,client:e};o.put(t)}))}(this.totalEngagedTime,this.totalCompletion,this.options.sessionManager.getSessionId(),this.options.viewId.get(),this.clientContext.getClient(),this.unprocessedPVC,f(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.options.queryManager.segmentEntryQueryCodes,this.options.queryManager.segmentExitQueryCodes)}))}reset(e){return(0,n.mG)(this,void 0,void 0,(function*(){if(this.disablePageEngagementDetection(),l.Uy){const e=yield this.unprocessedPVC.getIfPresent();this.hasPageviewCompleteFired=!1,y(this.totalEngagedTime,this.totalCompletion,f(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.options.queryManager.segmentEntryQueryCodes,this.options.queryManager.segmentExitQueryCodes,this.permutive,!1,e)}this.dirtyState=!1,this.options.state.viewId.generateAndSet(),this.totalCompletion=0,this.totalEngagedTime=0,this.options.customProperties.overrideCustomProps(e.page||{}),this.updateWebOptions(e),this.enablePageEngagementDetection();const t={logger:this.logger,config:Object.assign(Object.assign({},this.options.config),{watson:e.watson}),clientContext:this.clientContext,api:this.api,permutiveData:this.options.permutiveData,metrics:this.options.metrics,sessionManager:this.options.sessionManager,enrichers:this.options.enrichers,network:this.options.network};(0,d.H)(t)().then((()=>{h(f(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.permutive,this.options.messages),l.t2&&(clearInterval(this.timerHandle),this.timerHandle=this.registerEngagementInterval(this.getEventInterval()))}))}))}serializeForm(e){return[...e.getElementsByTagName("input")].filter((e=>!(!e.type||!e.id||e.disabled||e.checked||"fieldset"===e.nodeName.toLowerCase()||-1!==b.indexOf(e.type.toLowerCase())||-1!==q.indexOf(e.name.toLowerCase())))).map((e=>({name:e.name||e.id,value:e.value}))).filter((e=>e.value.length<120))}registerEngagementInterval(e){return setInterval((()=>{this.dirtyState&&this.trackEngagementInterval(e)}),1e3*e)}attachListeners(){const e=e=>"a"===e.tagName.toLowerCase(),t=i=>e(i)?(0,c.G)(i):i.parentElement?e(i.parentElement)?(0,c.G)(i.parentElement):t(i.parentElement):c.YP;l.eV&&[].slice.call(document.getElementsByTagName("form"),0).forEach((e=>{e.addEventListener("submit",(0,p.Z_)(this.options.network,this.options.userId,this.sendFormSubmissionEvent.bind(this)))})),l.qr&&document.body.addEventListener("click",(e=>{if(e.target instanceof Element){const i=t(e.target);return(0,c.g_)((()=>{}),(t=>this.sendLinkClickEvent(t,((e,t)=>!("_blank"===t.target||e.metaKey||e.ctrlKey||e.shiftKey||2===e.which||3===e.which))(e,t))))(i)}}),{capture:!0})}updateState(e){const t=Math.max(this.totalCompletion,this.getCurrentCompletion()),i=t-this.totalCompletion;return this.totalEngagedTime+=e,this.totalCompletion=t,this.dirtyState=!1,{engaged_time:e,total_engaged_time:this.totalEngagedTime,completion:i,total_completion:this.totalCompletion}}getCurrentCompletion(){if("function"==typeof this.options.getPageCompletion)return(0,s.zG)((0,o.Y3)((0,s.ls)(this.options.getPageCompletion,Number,(e=>isNaN(e)?0:e),(0,u.uZ)(a.Df)(0,1)),r.w),(0,o.EQ)((e=>(this.logger.warn("Web: invoking getPageCompletion threw an error. Got",e),0)),(e=>(this.logger.debug("Web: invoking getPageCompletion returned",e),e))));return(()=>{const e=document.documentElement.scrollHeight,t=window.pageYOffset+window.innerHeight;return t<=0?0:t>=e?1:t/e})()}setPageviewCompleteTimeout(e){return window.setTimeout((()=>{this.hasPageviewCompleteFired||(y(this.totalEngagedTime,this.totalCompletion,f(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.options.queryManager.segmentEntryQueryCodes,this.options.queryManager.segmentExitQueryCodes,this.permutive,!1),this.hasPageviewCompleteFired=!0)}),e)}resetTimeout(){clearTimeout(this.pageviewCompleteTimeoutHandle),this.pageviewCompleteTimeoutHandle=this.setPageviewCompleteTimeout(l.MU)}registerPageEngagementCleanup(e){if("function"!=typeof e)return this.logger.warn("No page detection cleanup was registered"),null;this.cleanupPageEngagementDetection=()=>(0,o.Y3)((()=>{e(),this.cleanupPageEngagementDetection=s.Q1}),(e=>this.logger.warn("Page detection cleanup threw an error",(0,r.w)(e))))}enablePageEngagementDetection(){this.options.addPageEngagementDetection&&(0,s.zG)(this.options.addPageEngagementDetection(this.pageEngagementDetected),(e=>this.registerPageEngagementCleanup(e))),this.setDirtyEventListenersTo(!0,this.getDirtyEvents())}disablePageEngagementDetection(){this.cleanupPageEngagementDetection(),this.setDirtyEventListenersTo(!1,this.getDirtyEvents())}setDirtyEventListenersTo(e,t){const i=e?window.addEventListener:window.removeEventListener;return t.forEach((e=>i(e,this.pageEngagementDetected))),null}getDirtyEvents(){return this.options.dirtyEvents||w}getEventInterval(){return this.options.eventInterval||5}updateWebOptions(e){var t;e.watson={enabled:"boolean"==typeof(null===(t=e.watson)||void 0===t?void 0:t.enabled)?e.watson.enabled:this.options.config.watson.enabled};const i={addPageEngagementDetection:void 0,dirtyEvents:void 0,eventInterval:void 0,getPageCompletion:void 0,page:void 0,watson:void 0};return this.options=Object.assign(Object.assign(Object.assign({},this.options),i),e)}}},7735:(e,t,i)=>{i.d(t,{J:()=>r});var n=i(416);class r{constructor(){this.replacementMap={}}register(e){this.replacementMap=Object.assign(Object.assign({},this.replacementMap),e.getReplacementMap)}enrich(e,t){return this.enrichRecursive(e,t)}enrichRecursive(e,t){const i={output:{},isFullyEnriched:!0},r=Object.keys(e);for(let o=0;o<r.length;o++){const s=r[o],a=e[s];switch(!0){case(0,n.t)(a):const[e,r]=this.isPropertyReplaceable(a);i.output[s]=e?r:a,this.replacementMap.hasOwnProperty(a)&&r===a&&t&&delete i.output[s],i.isFullyEnriched=!!e&&i.isFullyEnriched;break;case null!==a&&"object"==typeof a&&a.constructor===Object:const o=this.enrichRecursive(a,t);i.output[s]=o.output,i.isFullyEnriched=i.isFullyEnriched&&o.isFullyEnriched;break;default:i.output[s]=a}}return i}isPropertyReplaceable(e){const t=this.replacementMap[e];return[this.replacementMap.hasOwnProperty(e)&&t!==e,t]}}},3760:(e,t,i)=>{i.d(t,{B:()=>a,H:()=>c});var n=i(3735),r=i(5151),o=i(7112);const s=[],a=e=>{s.push(e)},c=e=>{const t=s.map((t=>(0,o.Y3)((()=>t.load(e)),(t=>{e.network.error(t)}))));return(0,n.zG)((0,r.RD)(t),(0,r.UI)(n.Q1))}},416:(e,t,i)=>{i.d(t,{t:()=>n});const n=e=>"string"==typeof e&&"$"===e[0]},4762:(e,t,i)=>{i.d(t,{F:()=>o});var n=i(3735),r=i(6567);class o{constructor(e,t,i){this.urls=e,this.config=t,this.network=i}identify(e,t,i){const n=()=>this.reqWithMetrics(e,"sdk_http_identify_seconds",{url:this.urls.getEndpointUrl("/identify",(0,r.G)(this.config.apiVersion)),method:"POST",payload:{user_id:t.get(),aliases:i},contentType:"text/plain",dataType:"json",withCredentials:!0});return this.identifyPromise?this.identifyPromise=this.identifyPromise.then(n):this.identifyPromise=n()}metrics(e){return this.network.req({url:this.urls.getEndpointUrl("/internal/metrics",(0,r.G)(this.config.apiVersion)),method:"POST",payload:e,contentType:"text/plain",dataType:"text",withCredentials:!1})}track(e,t,i){const n=this.getTrackUrl(t,{isFullyEnriched:i,useBeacon:!1});return this.reqWithMetrics(e,"sdk_http_events_seconds",{url:n,method:"POST",payload:t,contentType:"text/plain",dataType:"json",withCredentials:!1})}trackBatch(e,t){const i=this.getTrackUrl(t,{isFullyEnriched:!0,useBeacon:!1});return this.reqWithMetrics(e,"sdk_http_events_seconds",{url:i,method:"POST",payload:t,contentType:"text/plain",dataType:"json",withCredentials:!1})}trackBeacon(e,t){const i=this.getTrackUrl(e,{isFullyEnriched:t,useBeacon:!0});return this.network.reqWithBeacon({url:i,payload:e})}trackBatchBeacon(e){const t=this.getTrackUrl(e,{isFullyEnriched:!0,useBeacon:!0});return this.network.reqWithBeacon({url:t,payload:e})}tpd(e,t){return this.reqWithMetrics(e,"sdk_http_tpd_seconds",{url:this.urls.getEndpointUrl("/tpd",(0,r.G)(this.config.apiVersion)),method:"POST",payload:{user_id:t},contentType:"text/plain",dataType:"json",withCredentials:!1})}tpdUsage(e,t){return this.reqWithMetrics(e,"sdk_http_tpd_usage_seconds",{url:this.urls.getEndpointUrl("/tpd/usage",(0,r.G)(this.config.apiVersion)),method:"POST",payload:t,contentType:"text/plain",dataType:"json",withCredentials:!1})}reset(e){return this.reqWithMetrics(e,"sdk_http_reset_seconds",{url:this.urls.getEndpointUrl("/reset",(0,r.G)(this.config.apiVersion)),method:"POST",payload:null,contentType:"text/plain",dataType:"json",withCredentials:!0})}segmentSync(e){return this.network.req({url:`https://${this.config.segmentSyncApiHost}/sync/${e.key}`,method:"POST",payload:`value=${encodeURIComponent(e.value)}`,contentType:"application/x-www-form-urlencoded",dataType:"json",withCredentials:!0})}modelsBinary(e){return this.reqWithMetrics(e,"sdk_http_models_seconds",{url:this.getModelsUrl("binary"),method:"GET",contentType:"text/plain",dataType:"binary",withCredentials:!1})}modelsJson(e){return this.reqWithMetrics(e,"sdk_http_models_seconds",{url:this.getModelsUrl("json"),method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!1})}state(e,t,i,n,o,s){return this.reqWithMetrics(e,"sdk_http_reset_seconds",{url:this.urls.getEndpointUrl("/state",(0,r.G)("v1.0"),[["fetch_unseen",JSON.stringify(s)]]),method:"POST",payload:{group_id:t,event_source_id:i,state:JSON.stringify(n),last_seen_offset:o},contentType:"text/plain",dataType:"json",withCredentials:!1})}cleanRoom(e,t){return this.network.req({url:this.urls.getAdvertiserEndpointUrl("/segment",(0,r.G)(this.config.advertiserApiVersion),[["new-session",e.toString()]]),method:"POST",payload:t,contentType:"text/plain",dataType:"json",withCredentials:!1})}classificationModels(e){return this.network.req({url:this.urls.getClassificationModelsEndpointUrl("/segment",(0,r.G)(this.config.classificationModelsApiVersion)),method:"POST",payload:e,contentType:"text/plain",dataType:"json",withCredentials:!1})}appnexus(e){return this.network.req({url:e,method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!0,timeout:2e3})}pxid(e){return this.network.req({url:this.urls.makeAuthenticatedUrl(e),method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!0,timeout:2e3})}queries(){const e={addons:{dfp:{activations:{dfp:[],dfp_legacy:{}},auto_init:!0,track_slot_rendered:!1,track_slot_viewable:!1,track_slot_clicked:!1,track_targeting_keys:!1,sync_segments_cookie:!1},web:{auto_init:!1,track_pageview_engagement:!0,track_pageview_complete:!0,track_form_submission:!1,track_link_click:!1,engagement_edge_only:!0,segment_transition_edge_only:!1}},queries:{queries:{},eventSegments:{},eventsLookup:[],literalsLookup:[],subexpressionsLookup:[],stateSyncReplays:[],propertiesLookup:[]},queries_metadata:{}},t=`${this.config.cdnBaseUrl.startsWith("dev.local:")?"http":"https"}://${this.config.cdnBaseUrl}/queries/7c6db7ee-7cf2-4f9a-853a-78875d37e2bb-amp.json`;return this.network.req({url:t,withCredentials:!1,dataType:"json",method:"GET"}).catch((()=>e))}pxidReset(e){return this.network.req({url:this.urls.makeAuthenticatedUrl(e),method:"POST",payload:null,contentType:"text/plain",dataType:"json",withCredentials:!0})}getSocioDemoPredictions(e){return this.network.req({method:"POST",url:this.urls.getEndpointUrl("/demographic/infer/v3",(0,r.G)(this.config.apiVersion)),dataType:"json",payload:e,withCredentials:!1})}reqWithMetrics(e,t,i){const r=e.startTimer(t,{});return this.network.req(i).then((i=>(0,n.zG)(e.stopTimer(t,r),(e=>i))))}getTrackUrl(e,t){const{isFullyEnriched:i,useBeacon:n}=t,o=Array.isArray(e),s=!i;return this.urls.getEndpointUrl(o?"/batch/events":"/events",(0,r.G)(this.config.apiVersion),[["enrich",JSON.stringify(s)],["sdkp",JSON.stringify(!n)]])}getModelsUrl(e){const t=`https://${this.config.cdnBaseUrl}`;switch(e){case"binary":return`${t}/models/v2/7c6db7ee-7cf2-4f9a-853a-78875d37e2bb-models.bin`;case"json":return`${t}/models/7c6db7ee-7cf2-4f9a-853a-78875d37e2bb-models.json`}}}},550:(e,t,i)=>{i.d(t,{XO:()=>r,bk:()=>s,kJ:()=>n,mh:()=>o,sv:()=>a});const n=e=>Object.assign({id:e.id,name:e.name,time:new Date(e.time),properties:e.properties||{}},c(e)),r=e=>Object.assign({id:e.id||null,name:e.name,time:(u(e.time)?e.time:new Date).toISOString(),properties:e.properties||{}},c(e)),o=(e,t)=>Object.assign({id:e.id,time:new Date(e.time),name:t.name,properties:t.properties},c(t)),s=e=>void 0!==e.request_id,a=e=>void 0!==e.properties,c=e=>Object.assign(Object.assign({},e.session_id?{session_id:e.session_id}:{}),e.view_id?{view_id:e.view_id}:{}),u=e=>isFinite(e)&&e instanceof Date},8110:(e,t,i)=>{i.d(t,{s:()=>r});var n=i(6567);class r{constructor(e){this.config=e,this.PATH_JOINER_Q="?",this.PATH_JOINER_A="&"}getEndpointUrl(e,t,i=[]){return this.getUrl("base",e,t,i)}getSdkErrorsUrl(e,t){return this.getUrl("sdk-errors",e,t,[])}getAdvertiserEndpointUrl(e,t,i=[]){return this.getUrl("adv",e,t,i)}getClassificationModelsEndpointUrl(e,t,i=[]){return this.getUrl("clm",e,t,i)}makeAuthenticatedUrl(e){return this.makeUrlWithQueryParams(e,[["k",this.config.apiKey]])}getUrlPrefix(e){switch(e){case"base":return"";case"adv":return"/adv";case"sdk-errors":return"/sdk-errors";case"clm":return"/clm"}}getUrl(e,t,i,r){const o=this.getUrlPrefix(e),s=(0,n.g_)((()=>""),(e=>`/${e}`))(i),a=`${this.config.apiProtocol}://${this.config.apiHost}${o}${s}${t}`;return this.makeUrlWithQueryParams(a,r.concat([["k",this.config.apiKey]]))}makeUrlWithQueryParams(e,t){const i=t.map((([e,t])=>`${e}=${t}`)).join(this.PATH_JOINER_A),n=e.includes(this.PATH_JOINER_Q)?this.PATH_JOINER_A:this.PATH_JOINER_Q;return`${e}${n}${i}`}}},6146:(e,t,i)=>{i.d(t,{NY:()=>d,vk:()=>u,qA:()=>c});var n=i(655),r=i(3735),o=i(3195),s=i(4438);var a=i(1728);const c=()=>({opt_in:!0,token:s.L}),u=()=>({opt_in:!1,token:""}),l=e=>{return(0,r.ls)((t=e,e=>(0,r.zG)((0,a.J)(t.consentRequired,e),(({consentData:e,isValid:i})=>(t.consentDatabase.put(e,s.L),i)))),(({logger:e,messages:t})=>i=>{const n=i?"given":"revoked";return e.log("Consent has been",n),t.emit(`permutive:consent:${n}`),i})(e));var t},p=e=>(t,i)=>{e.on("permutive:consent:revoked",t),e.on("permutive:consent:given",i)},d=(e,t,i,{consentRequired:c})=>(0,n.mG)(void 0,void 0,void 0,(function*(){const n={isRevoked:()=>!1,listenForConsent:r.Q1},u=(0,o.S)(i,t,n),{giveConsent:d,revokeConsent:_,isRevoked:g}=(()=>{let e=!0;return{revokeConsent:()=>e=!1,giveConsent:()=>e=!0,isRevoked:()=>!1===e}})(),m=yield u.get(s.L);(0,a.J)(c,m).isValid?d():_();const f={isRevoked:g,listenForConsent:p(e)};f.listenForConsent(_,d);return{consentTracking:f,consentValidation:l({consentDatabase:u,consentRequired:c,logger:t,messages:e}),consentDatabase:u}}))},4438:(e,t,i)=>{i.d(t,{L:()=>n});const n="permutive-consent"},9658:(e,t,i)=>{i.d(t,{D:()=>p});var n=i(9320),r=i(8198),o=i(3735),s=i(6567),a=i(5151),c=i(6992),u=i(4438),l=i(1728);const p=e=>{const{partialTagWithKey:t}=e,i=t.key;var p;window[i].consent=(p=e,(0,o.ls)(p.consentModule.consentValidation,(e=>e?(0,c.H)(p)():null)));const d=(0,s.EQ)((()=>{return t={consentDatabase:e.consentModule.consentDatabase,consentRequired:e.tag.config.consentRequired},(0,o.zG)((0,o.a9)(t.consentDatabase.get(u.L)),(0,a.UI)((e=>(0,l.J)(t.consentRequired,e).isValid)));var t}),a.of);return(0,o.zG)((0,o.zG)((({consentModule:e,tag:t})=>{const i=(0,n.Ew)((function(e){return"consent"===e.functionName}))(t.q);return(0,s.UI)((t=>e.consentValidation(t.arguments[0])))(i)})(e),d),(0,a.UI)((e=>e?(0,r.F2)(!0):(0,r.t$)("No consent to run on the page"))))}},5097:(e,t,i)=>{i.d(t,{v:()=>n});const n=(e,t,i)=>(...n)=>(i()?t:e)(...n)},1728:(e,t,i)=>{i.d(t,{J:()=>s});var n=i(3735),r=i(6567),o=i(6146);const s=(e,t)=>(0,n.zG)((0,r.ij)(t),(t=>!1===e&&(0,r.Wi)(t)?{isValid:!0,consentData:(0,o.qA)()}:(e=>(0,r.pC)(e)&&(e=>null!==e&&"object"==typeof e)(e.value)&&(e=>{var t;return!0===e.opt_in&&"string"==typeof e.token&&(null===(t=e.token)||void 0===t?void 0:t.length)>0})(e.value))(t)?{isValid:!0,consentData:t.value}:{isValid:!1,consentData:(0,o.vk)()}))},4910:(e,t,i)=>{i.d(t,{S:()=>j});var n=i(3735),r=i(655),o=i(6567),s=i(8206),a=i(4011),c=i(5857),u=i(64),l=i(550);const p=(e,t)=>{switch(d(e.event,e.isEventFullyEnriched,t)){case"immediate":return g(e);case"memoryOnly":return m(e);case"response":return f(e);case"deferred":return h(e);case"never":return v(e)}},d=(e,t,i)=>i?"deferred":_(e.name,t),_=(e,t)=>P.has(e)?"memoryOnly":E.has(e)?"never":t?"immediate":"response",g=({event:e,requestData:t,requestOptions:i,queryManager:o,eventsBatch:s,stateSync:u,metrics:l,logger:p})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const[r,{segmentsEntered:d,segmentsExited:_}]=yield q(e,l,o,p),g=(0,c.e5)(a.Eq)((0,c.G0)(a.Eq)(new Set(t.segments),d),_);return p.log(`Adding ${e.name} to batch, with segments`,g),Promise.all([s.add(Object.assign(Object.assign({},t),{segments:[...g]}),i,"immediate"),u.sync(r)]).then(n.Q1)})),m=({event:e,metrics:t,queryManager:i,logger:r})=>q(e,t,i,r).then(n.Q1),f=({requestData:e,requestOptions:t,queryManager:i,eventsCache:n,eventHandler:r,api:o,metrics:s,logger:a})=>o.track(s,e,!1).then((r=>y(r,e,t,n,s,i,a))).then((({event:e,error:t})=>k(r,e,t))),h=({event:e,isEventFullyEnriched:t,requestData:i,api:r,eventHandler:s})=>Promise.all([r.trackBeacon(i,t),k(s,e,o.YP)]).then(n.Q1),v=({requestData:e,requestOptions:t,eventsBatch:i})=>i.add(e,t,"never"),y=(e,t,i,n,r,o,s)=>(0,l.bk)(e)?w(e,t,i):b(e,t,i,n,r,o,s),w=(e,t,i)=>{const r={name:t.name,session_id:t.session_id,view_id:t.view_id,properties:t.properties,id:null,time:new Date};return(0,n.zG)(i.error(e.error.message),(t=>Promise.resolve({event:r,error:(0,o.G)(e)})))},b=(e,t,i,r,s,a,c)=>{const u=(0,l.sv)(e)?(0,l.kJ)(Object.assign(Object.assign({},e),{session_id:t.session_id,view_id:t.view_id})):(0,l.mh)(e,t);return q(u,s,a,c).then((e=>(0,n.zG)(i.success(u),(e=>r.add(u,{persistOnDisk:!0})),(e=>({event:u,error:o.YP})))))},q=(e,t,i,r)=>O.has(e.name)?(0,n.zG)(t.startTimer("sdk_events_querylanguage_seconds",{}),(o=>i.process(e,!0).then((i=>(0,n.zG)(t.stopTimer("sdk_events_querylanguage_seconds",o),(t=>r.log("Processing event",e,"caused the following update",i)),(e=>i)))))):Promise.resolve([{},{segmentsEntered:new Set,segmentsExited:new Set}]),k=(e,t,i)=>{e.newEvent((0,l.XO)(t),(0,o.fS)((()=>null))(i))},E=new Set(["ThirdPartySegments","SlotRendered"]),P=new Set([...u.D0?["PageviewEngagement"]:[],...u.ED?["SegmentEntry","SegmentExit"]:[]]),S=new Set(["PageviewComplete"]),O=new Set(["!UpdateSecondPartyData","!UpdateThirdPartyData","LinkClick","Pageview"]);var D=i(1057),M=i(3351);var I=i(6013);class x{constructor(e,t={}){this.wait_prev=t.wait_prev||!1,this.block_next=t.block_next||!1,this.started=!1,this.complete=!1,this.task=e}waits(){return this.wait_prev}blocks(){return this.block_next}execute(e){this.started=!0,this.task((()=>{this.complete=!0,e()}))}}var T=i(8941);class A{constructor(e,t,i,n,r,o,s,a,c,u,l,p,d,_,g,m,f,h,v,y,w,b,q,k,E,P,S,O,D,M,I,x,T,A){this.namespace=e,this.logger=t,this.api=i,this.eventHandler=n,this.activationManager=r,this.sessionManager=o,this.metrics=s,this.viewId=a,this.userId=c,this.network=u,this.enrichers=l,this.clientContext=p,this.unprocessedEvents=d,this.eventsBatch=_,this.queryManager=g,this.stateSync=m,this.eventsCache=f,this.taskQueue=h,this.identities=v,this.permutiveReset=y,this.messages=w,this.addons=b,this.trace=q,this.permutiveRealtime=k,this.state=E,this.customProperties=P,this.config=S,this.permutiveData=O,this.externalData=D,this.cookies=M,this.thirdParty=I,this.models=x,this.identitiesIngestor=T,this.global=A,this.initialisedAddons=[],this.triggerListeners=[]}identify(e){this.logger.debug("<call> identify",e);const t=(0,I.b2)(),i=this.identities.parseCustomerDefinedIdentities(e),n=Object.assign(Object.assign({},this.identities.getIdentitiesMap()),i.reduce(((e,{tag:t,id:i,priority:n,expiry:r})=>Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({id:i},void 0!==n?{priority:n}:{}),void 0!==r?{expiry:r}:{})})),{})),o=Object.values(n).map((e=>e.id)),a=this.identities.getPrioritizedIdentities(n);if("string"==typeof e&&(0,s.Bt)("7c6db7ee-7cf2-4f9a-853a-78875d37e2bb","7c6db7ee-7cf2-4f9a-853a-78875d37e2bb",o,window.location.hostname,this.userId.get()))return t.resolve(),t.promise;const c=()=>(0,r.mG)(this,void 0,void 0,(function*(){yield(0,T.WI)({logger:this.logger,queryManager:this.queryManager,thirdParty:this.thirdParty,trace:this.trace})})),u=e=>(0,r.mG)(this,void 0,void 0,(function*(){yield(0,T.Yj)({clientContext:this.clientContext,eventsCache:this.eventsCache,global:this.global,identities:this.identities,logger:this.logger,metrics:this.metrics,models:this.models,queryManager:this.queryManager,reset:this.permutiveReset,stateSync:this.stateSync,thirdParty:this.thirdParty,trace:this.trace,userId:this.userId},e.user_id)}));return this.taskQueue.add(new x((e=>(0,r.mG)(this,void 0,void 0,(function*(){this.logger.debug("<task> identify ",i);const n=yield this.api.identify(this.metrics,this.userId,a);this.identities.setIdentities(i),this.userId.isEqual(n.user_id)?yield c():yield u(n),this.logger.debug("<done> identify",i),e(),t.resolve(),yield this.identitiesIngestor.ingestIfEligible(i).catch((e=>this.network.error(`Couldn't ingest identities, got ${e}`,this.userId.get())))}))),{wait_prev:!0,block_next:!0})),t.promise}on(e,t){return this.eventHandler.addListener({name:e,callback:t,once:!1})}once(e,t){return this.eventHandler.addListener({name:e,callback:t,once:!0})}track(...e){var t,i,r;const[o,s,a]=[e[0],e[1]||{},e[2]||{}],c=this.trace.startSpan("track_event");this.logger.log("<call> track",o);const u=(0,I.b2)();if(!this.api)return this.network.error("The API hasn't been loaded."),u.reject(),u.promise;const l=null!==(t=a.unprocessedData)&&void 0!==t?t:{},d=null!==(i=l.sessionId)&&void 0!==i?i:this.sessionManager.getSessionId(),_=null!==(r=l.viewId)&&void 0!==r?r:this.viewId.get(),g={success:a.success||(e=>{}),error:a.error||((e,t)=>{})};return this.taskQueue.add(new x((e=>{this.logger.log("<task> track",o);const{output:t,isFullyEnriched:i}=this.enrichers.enrich(s,P.has(o));this.metrics.track({name:i?"sdk_event_enrichment_success_count":"sdk_event_enrichment_fail_count",value:1,labels:{}});return(l.client?Promise.resolve(l.client):this.clientContext.getClient()).then((r=>{var l;const m=Object.assign(Object.assign({},t),{client:s.client?(0,I.PM)(r,s.client):r}),f={user_id:this.userId.get(),name:o,segments:this.queryManager.userSegments.getAllAsList(),properties:m,session_id:d,view_id:_},h={name:o,properties:m,session_id:d,view_id:_,time:new Date};return((e,t)=>p(e,t).then((t=>S.has(e.event.name)?e.unprocessedPVC.reset():(0,n.Q1)())))({event:h,requestData:f,isEventFullyEnriched:i,requestOptions:g,logger:this.logger,queryManager:this.queryManager,stateSync:this.stateSync,eventsCache:this.eventsCache,eventHandler:this.eventHandler,metrics:this.metrics,eventsBatch:this.eventsBatch,api:this.api,unprocessedPVC:this.unprocessedEvents.PageviewComplete},null!==(l=a.useBeacon)&&void 0!==l&&l).then((t=>{this.logger.log("<done> track",h.name),u.resolve(h),e(),c.finish()})).catch((e=>{g.error(e),this.network.error(e,this.userId.get())}))}))}))),u.promise}trigger(e,t,i){const n=(0,I.b2)();this.logger.log("<call> trigger",e),this.triggerListeners=this.triggerListeners||[];return this.taskQueue.add(new x((t=>{this.logger.log("<task> trigger",e);const r=this.messages.on("permutive:query:changed",(function(t){t.queryCode===e&&(i(t.result),n.resolve(t.result))}));this.triggerListeners.push(r),this.logger.log("<done> trigger",e),t()}))),n.promise}query(){return Promise.resolve({result:!1})}segment(e,t){const i=(0,I.b2)();this.logger.log("<call> segment",e);return this.taskQueue.add(new x((n=>{var r;this.logger.log("<task> segment",e);const o=this.queryManager.stateMap.value[e];o&&(t((null===(r=null==o?void 0:o.result)||void 0===r?void 0:r.result)||!1),i.resolve()),this.logger.log("<done> segment",e),n()}))),i.promise}segments(e,t="all"){const i=(0,I.b2)();this.logger.log("<call> segments");return this.taskQueue.add(new x((n=>{this.logger.log("<task> segments ("+t+")");const r=r=>{e(r),i.resolve(r),this.logger.log("<done> segments ("+t+")"),n()};"dfp"===t?this.messages.once("permutive:dfp:ready",(()=>{r(this.addons.dfp.segments.liveSegments)})):r(this.queryManager.userSegments.getAllAsList())}))),i.promise}reset(){return Promise.all([this.api.reset(this.metrics),this.identities.reset(),this.permutiveReset.reset(),this.stateSync.reset(),this.unprocessedEvents.PageviewComplete.reset(),this.queryManager.bootstrap([])]).then((([e])=>(this.userId.set(e.id),this.eventsCache.reset()))).then((()=>{this.messages.emit("permutive:reset")})).catch((e=>{this.network.error(`Error resetting internals. Got ${e}`)}))}addon(e,t){const n=Object.assign(Object.assign({},t),{permutive:this,api:this.api,activationManager:this.activationManager,network:this.network,clientContext:this.clientContext,logger:this.logger,unprocessedEvents:this.unprocessedEvents,metrics:this.metrics,namespace:this.namespace,state:this.state,queryManager:this.queryManager,messages:this.messages,userId:this.userId,viewId:this.viewId,customProperties:this.customProperties,config:this.config,permutiveData:this.permutiveData,sessionManager:this.sessionManager,userSegments:this.queryManager.userSegments,addons:this.addons,enrichers:this.enrichers,externalData:this.externalData,cookies:this.cookies});if(-1===this.initialisedAddons.indexOf(e))switch(this.initialisedAddons.push(e),e){case"web":Promise.resolve().then(i.bind(i,8482)).then((e=>this.addons.web=new e.WebAddon(n))).then((()=>this.messages.emit("permutive:web:ready")));break;case"publishers":case"nativo":case"freewheel":case"eyeota_pixel":case"rubicon":case"rubicon_ssp":case"tracking_pixel":case"twitter_pixel":case"pinterest_pixel":case"local_storage":case"appnexus_adserver":case"prebid":case"classification_models":case"gam_log":case"socio_demo_cohorts":case"smart":case"tradedesk":case"ddp":case"dbm":case"appnexus":case"pubmatic":case"ctv":0;break;case"overlays":Promise.resolve().then(i.bind(i,718)).then((e=>this.addons.overlays=new e.OverlaysAddon(n)));break;case"scriptrunner":Promise.resolve().then(i.bind(i,7926)).then((e=>this.addons.scriptrunner=new e.ScriptRunnerAddon(n)));break;case"dfp":Promise.resolve().then(i.bind(i,2127)).then((e=>this.addons.dfp=e.createAddon(n)));break;case"facebook_pixel_v2":Promise.resolve().then(i.bind(i,4892)).then((e=>this.addons.facebook_pixel_v2=new e.FacebookV2Pixel(n)));break;case"clean_room":Promise.resolve().then(i.bind(i,5607)).then((e=>this.addons.clean_room=new e.CleanRoomAddon(n)))}else"web"===e&&!0!==t.auto_init?((e,t,i,n)=>new Promise(((r,s)=>{var a;const c=(0,o.Y3)(e);if((0,o.pC)(c))return r(c.value);i.once(t,(()=>(0,o.g_)((()=>s(new Error(`Error after waiting for event ${t}`))),r)((0,o.Y3)(e))));const u=null!==(a=null==n?void 0:n.timeout)&&void 0!==a?a:1e4;setTimeout((()=>s(new Error(`Event ${t} was not received within the timeout period ${u}ms`))),u)})))((()=>this.addons.web.reset(t)),"permutive:web:ready",this.messages).catch((e=>{this.network.error(`Got error while trying to reset web. Got ${e.message}`,this.state.userId.get())})):"ctv"===e&&(null==t||t.auto_init)}addonIfTCFConsent(e,t){const i=()=>{switch(e.key){case"tradedesk":this.addons.tradedesk=new e.Addon(t);break;case"ddp":this.addons.ddp=new e.Addon(t);break;case"appnexus":this.addons.appnexus=new e.Addon(t);break;case"pubmatic":this.addons.pubmatic=new e.Addon(t)}},r=t=>t[M.D[e.key]]?i():(0,n.Q1)();return(0,D._8)(window).then((e=>{switch(e.type){case"missing":return i();case"aborted":return(0,n.Q1)();case"loaded":return(0,n.zG)((0,D.Ec)(e.data),(0,o.g_)(i,r))}}))}ready(e,t="initialised"){const i=(0,I.b2)(),n=()=>{e(),i.resolve()};switch(t){case"initialised":this.permutiveRealtime.isReady()?n():this.messages.on("permutive:ready",n);break;case"realtime":this.permutiveRealtime.isRealtime()?n():this.messages.once("permutive:realtime",n)}return i.promise}}var C=i(5097);const U=e=>{const{logger:t,consentTracking:i}=e,o=(...e)=>(t.debug("Methods[track]: Cannot track as consent is revoked"),Promise.resolve(null));return e=>class extends e{constructor(...e){super(...e),this.track=(0,C.v)(super.track.bind(this),o,i.isRevoked),i.listenForConsent((()=>this.consentRevoked()),n.Q1)}consentRevoked(){return(0,r.mG)(this,void 0,void 0,(function*(){return yield this.sessionManager.reset(),this.reset()}))}}},j=(e,t,i,r,o,s,a,c,u,l,p,d,_,g,m,f,h,v,y,w,b,q,k,E,P,S,O,D,M,I,x,T,C,j,L)=>new((0,n.zG)(A,U({consentTracking:L,logger:t})))(e,t,i,r,o,s,a,c,u,l,p,d,_,g,m,f,h,v,y,w,b,q,k,E,P,S,O,D,M,I,x,T,C,j)},7281:(e,t,i)=>{i.d(t,{Oc:()=>l,l9:()=>p});var n=i(1828),r=i(8198),o=i(3735);class s{constructor(){}setItem(e,t){return(0,o.zG)(JSON.stringify(t),(t=>window.sessionStorage.setItem(e,t)))}getItem(e){return(0,o.zG)(window.sessionStorage.getItem(e),JSON.parse)}}class a{constructor(){}setItem(){}getItem(){return null}}const c=e=>(0,r.tS)((e=>1===e.size?(0,r.F2)(null):(0,r.t$)("Iterable Maps not supported")))((e=>"function"==typeof e.Map?(0,r.F2)(new e.Map([["a",1]])):(0,r.t$)("Maps not supported"))(e)),u=e=>(0,r.tS)((e=>2===e.size?(0,r.F2)(null):(0,r.t$)("Iterable Sets not supported")))((e=>"function"==typeof e.Set?(0,r.F2)(new e.Set([1,2])):(0,r.t$)("Sets not supported"))(e)),l=e=>(0,o.zG)((0,n.gz)(r.G5)(c(e),u(e),(e=>{const t=["QuotaExceededError","QUOTA_EXCEEDED_ERR","NS_ERROR_DOM_QUOTA_REACHED"];return(0,r.Y3)((()=>{const t="_permutive_ls_test";e.localStorage.setItem(t,t),e.localStorage.removeItem(t)}),(i=>e.localStorage&&0===e.localStorage.remainingSpace||t.some((e=>-1!==String(i).indexOf(e)))?"localStorage quota exceeded":"localStorage not supported"))})(e),(e=>e.Worker&&e.Blob?(0,r.F2)(null):(0,r.t$)("WebWorkers not supported"))(e)),(e=>(0,r.UI)(o.Q1)(e))),p=e=>{const t=(0,r.Y3)((()=>{const t="_permutive_ls_test";e.sessionStorage.setItem(t,t),e.sessionStorage.getItem(t),e.sessionStorage.removeItem(t)}),(e=>"sessionStorage not supported"));return(0,o.zG)(t,(0,r.g_)((()=>new a),(()=>new s)))}},8941:(e,t,i)=>{i.d(t,{Yj:()=>p,TZ:()=>l,MA:()=>_,WI:()=>g});var n=i(655),r=i(2688),o=i(3735),s=i(6567);var a=i(8206),c=i(449);const u=e=>(0,n.mG)(void 0,void 0,void 0,(function*(){yield e.identityPromise,yield function(e,t){return(0,a.Bt)("7c6db7ee-7cf2-4f9a-853a-78875d37e2bb","7c6db7ee-7cf2-4f9a-853a-78875d37e2bb",e.identities.getPrioritizedIdentities(e.identities.getIdentitiesMap()).map((e=>e.id)),window.location.hostname,e.userId.get())?t.reset():Promise.resolve()}(e,e.permutiveMethods);const t=yield function(e){const t=e.trace.startSpan("identify");0;return(e=>(0,n.mG)(void 0,void 0,void 0,(function*(){const{logger:t,network:i,api:r,userId:o,identities:s,metrics:a,identitiesIngestor:c,messages:u}=e,l=s.extractIdentifyFromQueue(e),p=s.getIdentitiesMap(),d=l.reduce(((e,{tag:t,id:i,priority:n,expiry:r})=>Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({id:i},r?{expiry:r}:{}),void 0!==n?{priority:n}:{})})),{}),_=Object.assign(Object.assign({},p),d);t.log("Starting identification... Identities are:",_);const g=s.getPrioritizedIdentities(_),m=yield r.identify(a,o,g).then((e=>(0,n.mG)(void 0,void 0,void 0,(function*(){const i=e.user_id;return o.isEqual(i)?{identityChanged:!1}:(t.log(`Got different user id from API: ${i}`),{identityChanged:!0,userId:i})})))).catch((e=>(0,n.mG)(void 0,void 0,void 0,(function*(){const t=o.get();return i.error(`Couldn't set identity for user ${t}. Got ${e}`,t),{identityChanged:!1}}))));return s.setIdentities(Object.entries(_).map((([e,{id:t,priority:i,expiry:n}])=>Object.assign(Object.assign({tag:e,id:t},n?{expiry:n}:{}),void 0!==i?{priority:i}:{})))),c.ingestIfEligible(g).catch((e=>i.error(`Couldn't ingest identities, got ${e}`,m.identityChanged?m.userId:o.get()))),u.emit("permutive:user:ready"),t.debug("<done> init identity ",m),m})))(e).catch((t=>(e.network.error(`Failed to identify. Got ${(0,r.w)(t)}`),{identityChanged:!1}))).then((e=>(t.finish(),e)))}(e);return t.identityChanged?(e.metrics.track({name:"sdk_identity_changed_total",value:1,labels:{}}),yield p(e,t.userId)):(e.metrics.track({name:"sdk_identity_remained_total",value:1,labels:{}}),e.logger.log("Identity has not changed"),yield g(e)),t})),l=e=>(0,n.mG)(void 0,void 0,void 0,(function*(){u(e),yield function(e,t,i,r,a,c,u){e.log("Assuming identity hasn't changed");const l=a.hasNewOrModifiedQueries,p=t.startSpan(`qm_bootstrap_${l}`),d=()=>l?c.all().then((e=>a.bootstrap(e))):a.bootstrap([]);return c.resetIfNeeded().then((e=>e?(u.track({name:"sdk_reset_hearst_count",value:1,labels:{}}),i.reset()):Promise.resolve())).then(d).then((()=>r.PageviewComplete.getIfPresent())).then((0,s.g_)((()=>e.log("No unprocessed PVC data detected")),(t=>(0,o.zG)(e.log("Unprocessed PVC data detected",t),(e=>{const{props:i}=t;return{props:i,unprocessedData:(0,n._T)(t,["props"])}}),(({props:e,unprocessedData:t})=>i.track("PageviewComplete",e,{unprocessedData:t}).finally((()=>r.PageviewComplete.reset()))))))).then((()=>p.finish()))}(e.logger,e.trace,e.permutiveMethods,e.unprocessedEvents,e.queryManager,e.eventsCache,e.metrics),d(e.global,e.clientContext)}));function p(e,t){return(0,n.mG)(this,void 0,void 0,(function*(){e.logger.log("Identity has changed"),yield e.reset.reset(),e.userId.set(t),d(e.global,e.clientContext),e.identities.setIdentities([]);const i=yield e.eventsCache.reset(c.m),n=e.trace.startSpan("ss_reset_sync");e.thirdParty.reset(),yield f(e,i),n.finish()}))}function d(e,t){return e.context=t.getContext()}function _({logger:e,queryManager:t,models:i,trace:r}){return(0,n.mG)(this,void 0,void 0,(function*(){const n=r.startSpan("lal_http"),o=yield i.getModels();n.finish(),e.debug("Updating lookalike models");const s=r.startSpan("update_env_lal");return yield t.updateLAL(o),s.finish(),o}))}function g({logger:e,queryManager:t,thirdParty:i,trace:r}){return(0,n.mG)(this,void 0,void 0,(function*(){const n=r.startSpan("tpd_http"),o=yield i.segments();n.finish(),e.log("Updating TPD segments");const s=r.startSpan("update_env_tpd");return yield t.updateTPD(o),s.finish(),o}))}function m(e){const t=e.trace.startSpan("tpd_models");return Promise.all([g(e),_(e)]).then((([i,n])=>{e.logger.debug("Loaded TPD segments and lookalike models",i,n),t.finish()}))}const f=(e,t)=>(0,n.mG)(void 0,void 0,void 0,(function*(){yield Promise.all([m(e),e.stateSync.resetSync(),e.queryManager.bootstrap(t)])}))},6785:(e,t,i)=>{function n(e,t,i,n,r){r.debug("set SDK as ready"),e.setAsReady(),t.emit("permutive:api:ready"),i.track({name:"sdk_local_storage_byte_total",value:n.getStateSizeInBytes(),labels:{}}),i.track({name:"sdk_query_states_byte_total",value:e.getStateSizeInBytes(),labels:{}})}i.d(t,{R:()=>n})},3368:(e,t,i)=>{i.d(t,{$o:()=>h,uU:()=>y,je:()=>v});var n=i(8198),r=i(3735),o=i(655),s=i(2688),a=i(6567),c=i(3629);class u{constructor(e,t,i){this.urls=e,this.config=t,this.logger=i}req(e){return this.reqImpl(e).then((e=>(0,r.MZ)(e)))}reqWithBeacon({url:e,payload:t}){return null===navigator||void 0===navigator?void 0:navigator.sendBeacon(e,JSON.stringify(t))}error(e,t,i){return(0,o.mG)(this,void 0,void 0,(function*(){this.logger.error((0,s.w)(e)),this.config.sendClientErrors&&(yield this.errorNetwork(e,t,i).catch((0,r.ls)(s.w,(e=>this.logger.error(e)))))}))}errorNetwork(e,t,i){var n,r,o,s,u,l,p,d;const _=e instanceof Error?e:new Error(JSON.stringify(e)),g={error_message:null!==(r=null===(n=null==_?void 0:_.message)||void 0===n?void 0:n.toString())&&void 0!==r?r:"",stack_trace:null===(o=null==_?void 0:_.stack)||void 0===o?void 0:o.split("\n")},m=t?{user_id:t}:{},f=Object.assign({platform:"web",sdk_version:"v19.31.0",ql_runtime_version:"v5.1.1",timestamp:null!=i?i:new Date,domain:null!==(u=null===(s=null===window||void 0===window?void 0:window.location)||void 0===s?void 0:s.hostname)&&void 0!==u?u:"",url:(0,c.bk)(null===(l=null===window||void 0===window?void 0:window.location)||void 0===l?void 0:l.href),referrer:(0,c.bk)(null===document||void 0===document?void 0:document.referrer),user_agent:null!==(p=null===navigator||void 0===navigator?void 0:navigator.userAgent)&&void 0!==p?p:"",error_message:null!==(d=g.error_message)&&void 0!==d?d:String(e),stack_trace:g.stack_trace},m);return this.req({url:this.urls.getSdkErrorsUrl("/errors",(0,a.G)(this.config.sdkErrorsApiVersion)),method:"POST",payload:[f],contentType:"text/plain",dataType:"text",withCredentials:!1})}reqImpl(e){const{url:t,dataType:i,contentType:r,method:o,withCredentials:s,timeout:a}=e;return new Promise(((c,u)=>{const l=new XMLHttpRequest,p="POST"===e.method?"string"==typeof(d=e.payload)?d:JSON.stringify(d):null;var d;l.onload=function(){if(this.status>=400){const e="text"===this.responseType||""===this.responseType?this.responseText:"Couldn't access response text";u(`Failed ajax request. Status code was ${this.status}. ${e}`)}else if("json"===i){const e=this.responseText?(0,n.Y3)((()=>JSON.parse(this.responseText)),(e=>`Failed to parse response as JSON. Response was ${JSON.stringify(this.responseText)}. Got ${e}`)):(0,n.F2)(null);(0,n.g_)(u,c)(e)}else c("text"===i?this.responseText:this.response)},l.onerror=()=>u(new Error("Network request failed")),l.ontimeout=()=>u(new Error("Network request timed out")),l.open(o,t,!0),r&&l.setRequestHeader("content-type",r),l.timeout=a||l.timeout,l.withCredentials=s||l.withCredentials,l.responseType="binary"===i?"arraybuffer":l.responseType,l.send(p)}))}}var l=i(6013);const p="__permutive.",d="__permutiveConfigQueryParams";const _={default:{windowKey:"permutive",environment:"default",apiHost:"api.permutive.com",apiKey:"",cdnBaseUrl:"cdn.permutive.com",pxidHost:"prmutv.co",apiVersion:"v2.0",sdkErrorsApiVersion:"v2",advertiserApiVersion:"v2",classificationModelsApiVersion:"v1",apiProtocol:"https",loggingEnabled:!1,tracingEnabled:!1,requestTimeout:5e3,cookieDomain:"."+(0,c._Y)(window.location.hostname),cookieName:"permutive-id",cookieExpiry:function(){const e=new Date;return e.setMonth(e.getMonth()+6),e.toUTCString()}(),eventsTTLInDays:null,permutiveDataMiscKey:"permutive-data-misc",permutiveDataModelsKey:"permutive-data-models",permutiveDataQueriesKey:"permutive-data-queries",permutiveDataTPDKey:"permutive-data-tpd",permutiveDataEnrichersKey:"permutive-data-enrichers",stateNamespace:"",sendClientErrors:!0,metricsSamplingPercentage:20,eventsCacheLimitBytes:25e5,segmentSyncApiHost:"7c6db7ee-7cf2-4f9a-853a-78875d37e2bb.partner.permutive.app",consentRequired:!1,sdkType:"stable",viewId:null,localStorageDebouncedKeys:["internal_query_states"],localStorageWriteDelay:1e3,localStorageWriteMaxDelay:1500,watson:{enabled:!0}},production:{},development:{apiProtocol:"http",loggingEnabled:!0,tracingEnabled:!0,sendClientErrors:!1}},g=e=>{const t={consentRequired:!0,loggingEnabled:!0,sendClientErrors:!0,tracingEnabled:!0},i={eventsTTLInDays:!0,eventsCacheLimitBytes:!0,metricsSamplingPercentage:!0,requestTimeout:!0,localStorageWriteDelay:!0,localStorageWriteMaxDelay:!0};return Object.keys(e).reduce(((n,r)=>{if(t.hasOwnProperty(r)){const t="true"===e[r];return Object.assign(Object.assign({},n),{[r]:t})}if(i.hasOwnProperty(r)){const t=Number(e[r]);return isNaN(t)?n:Object.assign(Object.assign({},n),{[r]:t})}return Object.assign(Object.assign({},n),{[r]:e[r]})}),{})},m=e=>Object.entries(e).reduce(((e,[t,i])=>{if(!(0===t.indexOf(p)))return e;const n=t.replace(p,"");return[...e,[n,i]]}),[]),f=(e,t,i)=>{var n;const o=(0,r.zG)(t,m,(e=>(0,l.m8)(...e)),g),s=null!==(n=_[e.environment])&&void 0!==n?n:{};return(0,l.PM)(_.default,s,e,((e,t)=>{const i=t.getItem(d),n=(0,l.PM)(i,e);return t.setItem(d,n),n})(o,i))},h=e=>{var t,i;const o="7c6db7ee-7cf2-4f9a-853a-78875d37e2bb",s=void 0!==(null===(t=e[o])||void 0===t?void 0:t.q)&&void 0!==(null===(i=e[o])||void 0===i?void 0:i.config)?o:"permutive";return(0,r.zG)(e[s],(0,n.ij)("Can't find permutive tag on the page"),(0,n.UI)((e=>({tag:e,key:s}))))},v=({tag:e,key:t},i,n)=>Object.assign(Object.assign({},e),{config:f(Object.assign(Object.assign({},e.config),{windowKey:t}),i,n)}),y=(e,t,i)=>new u(e,t,i)},6112:(e,t,i)=>{i.d(t,{F:()=>o});var n=i(7112),r=i(4938);const o=(0,n.Y3)((()=>{const e=(0,r.e)();return e.postMessage({type:"noop",userId:null}),Promise.resolve(e)}),(e=>`Failed to start QueryWorker. Got ${e}`))},9848:(e,t,i)=>{i.d(t,{LA:()=>a});var n=i(9320),r=i(7209),o=i(6013);const s=(e,t,{network:i,state:n})=>{i.error(`Function "permutive.${t.functionName}" caused an error: ${e.message}`,n.userId.get())};function a(e,t,i,a,d,_,g=l){const m=function(e){const t=(0,n.uK)((e=>-1!==u.indexOf(e.functionName)))(e),i=t.right,s=t.left.filter((e=>"consent"!==e.functionName)),a=(0,r.Zt)(((e,t)=>c(e)&&c(t)?(0,o.lW)(p).compare(e.arguments[0],t.arguments[0]):(0,o.lW)(u).compare(e.functionName,t.functionName))),l=(0,n.DY)(a)(i);return l.concat(s)}(e),f=_.startSpan("queued_methods"),h={network:d,state:t.state};m.forEach((e=>{try{t=e.functionName,g.includes(t)||(e=>{e.functionName in i?i[e.functionName].apply(a,e.arguments):s(new Error("Does not exist."),e,h)})(e)}catch(t){const i=t instanceof Error?t:new Error("Unknown error.");s(i,e,h)}var t})),f.finish()}const c=e=>"addon"===e.functionName,u=["identify","trigger","addon","track"],l=["identify"],p=["dfp","appnexus_adserver","web"]},5791:(e,t,i)=>{i.d(t,{y:()=>v});var n=i(655),r=i(2688),o=i(9320),s=i(3735),a=i(9384),c=function(e,t){return function(){return t(e())}},u=function(e){return function(t){return c(t,e)}},l=s.a9,p=(s.yR,s.yR,a.F4,a.Xl,function(){return Math.random()});function d(e,t){return(0,s.zG)(p,u((function(i){return Math.floor((t-e+1)*i+e)})))}u((function(e){return e<.5}));var _=i(356),g=i(274),m=i(6013);class f{constructor(e,t,i,r,o){this.sdkInitTimestamp=e,this.api=t,this.messages=i,this.logger=r,this.enrichers=o,this.environment="web",this.pendingMetrics=[],this.pendingTimers={},this.messages.on("permutive:ready",(()=>{const e=d(3e4,9e4),t=i=>window.setTimeout((()=>(0,n.mG)(this,void 0,void 0,(function*(){const i=(yield this.processPending())?5e3:e();t(i)}))),i);t(5e3),(0,m.aq)((()=>{this.processPending.bind(this)}),navigator.userAgent)})),this.track({name:"sdk_initialisation_start_time_seconds",value:e/1e3,labels:{}})}track(e){this.pendingMetrics.push(e)}trackTimeSinceInit(e,t){const i=(performance.now()-this.sdkInitTimestamp)/1e3;this.logger.debug("metrics: timer stopped",e,i),this.track({name:e,value:i,labels:t})}startTimer(e,t){const i=performance.now(),n=this.generateRandomKey(e);return this.pendingTimers[n]={startTime:i,labels:t},n}stopTimer(e,t){const i=this.pendingTimers[t];if(i){const n=(performance.now()-i.startTime)/1e3;this.logger.debug("metrics: timer stopped",e,n),this.track({name:e,value:n,labels:i.labels}),delete this.pendingTimers[t]}}processPending(){return(0,n.mG)(this,void 0,void 0,(function*(){if((0,o.xb)(this.pendingMetrics))return!0;const e=this.pendingMetrics;this.pendingMetrics=[];const t=()=>(0,s.zG)({},(e=>(0,_.dx)("continent",g.U.$ip_geo_info_continent)(e)),(e=>this.enrichers.enrich(e,!0).output));try{return yield this.api.metrics({context:Object.assign(Object.assign({},t()),{environment:this.environment,events_count:0,segments_count:0}),items:e}),!0}catch(t){return this.logger.error(`Metrics: Request failed from error ${(0,r.w)(t).message}`,e),this.pendingMetrics=[...this.pendingMetrics,...e],!1}}))}generateRandomKey(e){return`${e}-${[...Array(24)].map((()=>Math.random().toString(36)[2])).join("")}`}}class h{track(e){}trackTimeSinceInit(e,t){}startTimer(e,t){return""}stopTimer(e,t){}}function v(e,t,i,n,r,o,s){return(null!==(a=n.getData("metricsEnabled"))&&void 0!==a?a:(()=>{const e=Math.random()<=i.metricsSamplingPercentage/100;return n.setData("metricsEnabled",e),e})())?new f(e,t,r,o,s):new h;var a}},6992:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>initialiseWebSDK,f:()=>initialisationSequence});var tslib__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(655),fp_ts_Either__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(8198),fp_ts_function__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(3735),fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(7112),_identity_legacy_NeustarFabrickIdentitiesIngestor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9417),_identity_legacy_PermutiveIdentities__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8206),_identity_legacy_PermutiveIdentitiesIngestorNoOp__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(6815),_publisher_cohorts_legacy_models_PermutiveModelsNoOp__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(933),_core_activations_PermutiveActivationManagerWeb__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8764),_core_activations_PermutiveAddons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5506),_core_context_PermutiveClientContextWeb__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(427),_core_crypto_HashcodeDigest__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(4572),_core_events_EventsCacheWeb__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8231),_core_events_PermutiveEventCustomProps__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(2923),_core_events_PermutiveEventsBatch__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4314),_core_events_unprocessed_UnprocessedPageviewComplete__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(6515),_core_events_unprocessed_UnprocessedPrebidAuctions__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(3937),_core_internals_CookiesWeb__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9175),_core_internals_ExternalDataWeb__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(3319),_core_internals_PermutiveInternals__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(6715),_core_internals_PermutiveLogger__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(4828),_core_internals_SDKMessages__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(8167),_core_queries_query_manager_QueryManagerWeb__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(4938),_core_session_SessionManager__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(3253),_core_state_PermutiveDataStoreWeb__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2747),_core_state_PermutiveEventSourceId__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1823),_core_state_PermutiveNamespace__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(7738),_core_state_PermutiveRealtime__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(4528),_core_state_PermutiveReset__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(2472),_core_state_PermutiveStateSyncWeb__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1714),_core_state_PermutiveStateWeb__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(7258),_core_state_PermutiveUserId__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(7846),_core_state_PermutiveViewId__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(6919),_core_store_LocalStorageWeb__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(3195),_core_tcf_TCF__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1057),_core_third_party_ThirdPartyBase__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(2520),_dynamic_addons_LoadAddons__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(2223),_dynamic_enrichment_Enrichers_GlobalEnricher__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(7735),_dynamic_enrichment_RegisterEnrichers__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(3760),_http_PermutiveApi__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(4762),_http_PermutiveUrls__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(8110),_utils_event_handler_PermutiveEventHandler__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(9409),_utils_PermutiveUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6013),_utils_task_queue_PermutiveTaskQueue__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(7749),_utils_Trace__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(998),_utils_urls_UrlHelpers__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(3629),_Consent_Consent__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(6146),_Consent_InitialisationCheckWeb__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(9658),_initialisation_browserFeatures__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(7281),_initialisation_identity__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(8941),_initialisation_initialisationLifecycle__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(6785),_initialisation_permutiveTag__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(3368),_initialisation_queryWorkerInit__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(6112),_initialisation_queuedMethods__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(9848),_initialisation_setupMetrics__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(5791),_PermutiveMethodsWeb__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(4910);const sdkInitTimestamp=window.performance.now(),initialiseWebSDK=({queryWorker,tag,partialTagWithKey,urls,network,namespace,messages,logger,consentModule})=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.Y3)((()=>(0,tslib__WEBPACK_IMPORTED_MODULE_27__.mG)(void 0,void 0,void 0,(function*(){const windowKey=partialTagWithKey.key,permutiveGlobal=window[windowKey],config=tag.config,trace=new _utils_Trace__WEBPACK_IMPORTED_MODULE_28__.l(config),sdkReadySpan=trace.startSpan("sdk_ready"),{consentTracking,consentValidation}=consentModule;window[windowKey].consent=consentValidation;const context=(0,_utils_PermutiveUtils__WEBPACK_IMPORTED_MODULE_18__.PM)(tag.context||{},{path:window.location.pathname,url:(0,_utils_urls_UrlHelpers__WEBPACK_IMPORTED_MODULE_29__.bk)(window.location.href),referrer:(0,_utils_urls_UrlHelpers__WEBPACK_IMPORTED_MODULE_29__.bk)(document.referrer)}),createInternalsSpan=trace.startSpan("internals"),eventHandler=new _utils_event_handler_PermutiveEventHandler__WEBPACK_IMPORTED_MODULE_30__.b,cookieStore=(0,_core_internals_CookiesWeb__WEBPACK_IMPORTED_MODULE_7__.S)(namespace,config,logger,consentTracking),localStorage=(0,_core_store_LocalStorageWeb__WEBPACK_IMPORTED_MODULE_31__.S)(namespace,logger,consentTracking),externalData=(0,_core_internals_ExternalDataWeb__WEBPACK_IMPORTED_MODULE_32__.S)(namespace,logger,consentTracking),clientContext=new _core_context_PermutiveClientContextWeb__WEBPACK_IMPORTED_MODULE_33__.z(context),viewId=new _core_state_PermutiveViewId__WEBPACK_IMPORTED_MODULE_14__.W(clientContext,config),userId=new _core_state_PermutiveUserId__WEBPACK_IMPORTED_MODULE_13__.M(config,clientContext,cookieStore,externalData),permutiveData=(0,_core_state_PermutiveDataStoreWeb__WEBPACK_IMPORTED_MODULE_10__.S)(config,namespace,logger,network,userId,consentTracking),eventSourceId=new _core_state_PermutiveEventSourceId__WEBPACK_IMPORTED_MODULE_11__.$(permutiveData),enrichers=new _dynamic_enrichment_Enrichers_GlobalEnricher__WEBPACK_IMPORTED_MODULE_34__.J,api=new _http_PermutiveApi__WEBPACK_IMPORTED_MODULE_35__.F(urls,config,network),metrics=(0,_initialisation_setupMetrics__WEBPACK_IMPORTED_MODULE_24__.y)(sdkInitTimestamp,api,config,permutiveData,messages,logger,enrichers),identityProviderEnv={permutive:permutiveGlobal,network,api,userId,metrics,permutiveData,messages,config,cookies:cookieStore,logger},identities=new _identity_legacy_PermutiveIdentities__WEBPACK_IMPORTED_MODULE_1__.lg(metrics,trace,permutiveData,identityProviderEnv,logger),identityPromise=identities.prepareThirdPartyIdentities(),models=new _publisher_cohorts_legacy_models_PermutiveModelsNoOp__WEBPACK_IMPORTED_MODULE_36__.p,identitiesIngestor=new _identity_legacy_PermutiveIdentitiesIngestorNoOp__WEBPACK_IMPORTED_MODULE_37__.z,permutiveRealtime=new _core_state_PermutiveRealtime__WEBPACK_IMPORTED_MODULE_38__.u(metrics,messages),sessionManager=yield _core_session_SessionManager__WEBPACK_IMPORTED_MODULE_9__.S.initialise(cookieStore,localStorage),_internals=new _core_internals_PermutiveInternals__WEBPACK_IMPORTED_MODULE_39__.P(logger,network,userId,viewId,messages,sessionManager,cookieStore,externalData);_internals.metrics=metrics,_internals.identities=identities;const eventsCache=new _core_events_EventsCacheWeb__WEBPACK_IMPORTED_MODULE_5__.K(config,namespace,logger,network,trace,metrics,userId,consentTracking),eventsBatch=new _core_events_PermutiveEventsBatch__WEBPACK_IMPORTED_MODULE_6__.c(eventHandler,api,metrics,userId,network,eventsCache),unprocessedArgs={consentTracking,logger,namespace},unprocessedEvents={PageviewComplete:new _core_events_unprocessed_UnprocessedPageviewComplete__WEBPACK_IMPORTED_MODULE_40__.p(unprocessedArgs),PrebidAuctions:new _core_events_unprocessed_UnprocessedPrebidAuctions__WEBPACK_IMPORTED_MODULE_41__.J(unprocessedArgs)},customProperties=new _core_events_PermutiveEventCustomProps__WEBPACK_IMPORTED_MODULE_42__.X,queryManagerTransitionDebounceTime=1e3,queryManagerTransitionMaxDebounceTime=1e4,queryManager=new _core_queries_query_manager_QueryManagerWeb__WEBPACK_IMPORTED_MODULE_8__.c({customProperties,externalData,logger,messages,network,permutive:permutiveGlobal,permutiveData,queryWorker,realtime:permutiveRealtime,sessionManager,transitionDebounceMaxTime:queryManagerTransitionMaxDebounceTime,transitionDebounceTime:queryManagerTransitionDebounceTime,userId,viewId});_internals.queryManager=queryManager;const permutiveReset=new _core_state_PermutiveReset__WEBPACK_IMPORTED_MODULE_43__.a(config,localStorage,logger,queryManager,permutiveData,eventSourceId,cookieStore,externalData),taskQueue=new _utils_task_queue_PermutiveTaskQueue__WEBPACK_IMPORTED_MODULE_44__.i(messages),stateSync=new _core_state_PermutiveStateSyncWeb__WEBPACK_IMPORTED_MODULE_12__.N(api,network,sessionManager,permutiveData,queryManager,metrics,userId,eventSourceId,(0,_core_state_PermutiveStateSyncWeb__WEBPACK_IMPORTED_MODULE_12__.e)()),thirdParty=new _core_third_party_ThirdPartyBase__WEBPACK_IMPORTED_MODULE_16__.U(network,logger,api,permutiveData,messages,sessionManager,metrics,identities,queryManager,permutiveGlobal,userId),activationManager=new _core_activations_PermutiveActivationManagerWeb__WEBPACK_IMPORTED_MODULE_2__.v(logger,permutiveGlobal,clientContext),state=new _core_state_PermutiveStateWeb__WEBPACK_IMPORTED_MODULE_45__.u(permutiveData,permutiveReset,userId,viewId,eventsCache);_internals.state=state;const permutiveMethods=(0,_PermutiveMethodsWeb__WEBPACK_IMPORTED_MODULE_25__.S)(namespace,logger,api,eventHandler,activationManager,sessionManager,metrics,viewId,userId,network,enrichers,clientContext,unprocessedEvents,eventsBatch,queryManager,stateSync,eventsCache,taskQueue,identities,permutiveReset,messages,_internals.addons,trace,permutiveRealtime,state,customProperties,config,permutiveData,externalData,cookieStore,thirdParty,models,identitiesIngestor,permutiveGlobal,consentTracking);createInternalsSpan.finish(),[].forEach((s=>{(0,fp_ts_Either__WEBPACK_IMPORTED_MODULE_46__.Y3)((()=>eval(s)),(e=>{network.error(Object.assign(Object.assign({},e),{message:`Error running custom script ${s}`}),userId.get())}))})),_internals.addBlocker("permutive:queries:initialised"),messages.on("permutive:user:ready",(()=>{permutiveGlobal.identify=permutiveMethods.identify.bind(permutiveMethods);const e=identities.extractIdentifyFromQueue({global:permutiveGlobal});e.length>0&&permutiveGlobal.identify(e)})),_internals.messages.on("permutive:blockers:empty",(()=>{permutiveGlobal.on=permutiveMethods.on.bind(permutiveMethods),permutiveGlobal.once=permutiveMethods.once.bind(permutiveMethods),permutiveGlobal.track=permutiveMethods.track.bind(permutiveMethods),permutiveGlobal.trigger=permutiveMethods.trigger.bind(permutiveMethods),permutiveGlobal.query=permutiveMethods.query.bind(permutiveMethods),permutiveGlobal.segment=permutiveMethods.segment.bind(permutiveMethods),permutiveGlobal.segments=permutiveMethods.segments.bind(permutiveMethods),permutiveGlobal.reset=permutiveMethods.reset.bind(permutiveMethods),permutiveGlobal.ready=permutiveMethods.ready.bind(permutiveMethods),permutiveGlobal.addon=permutiveMethods.addon.bind(permutiveMethods),permutiveGlobal.context=clientContext.getContext(),permutiveGlobal.addons=_internals.addons,permutiveGlobal.config=config,permutiveRealtime.setAsReady(),(0,_initialisation_queuedMethods__WEBPACK_IMPORTED_MODULE_23__.LA)(permutiveGlobal.q,_internals,permutiveGlobal,permutiveMethods,network,trace)}));const loadAddonsSpan=trace.startSpan("load_addons");(0,_dynamic_addons_LoadAddons__WEBPACK_IMPORTED_MODULE_17__.C)({_internals,logger,network,permutiveMethods,q:permutiveGlobal.q,clientContext}),loadAddonsSpan.finish();const loadEnrichersSpan=trace.startSpan("load_enrichers"),enricherEnv={api,config,clientContext,logger,permutiveData,metrics,sessionManager:_internals.sessionManager,enrichers,network},loadEnrichersPromise=(0,_dynamic_enrichment_RegisterEnrichers__WEBPACK_IMPORTED_MODULE_47__.H)(enricherEnv)();loadEnrichersPromise.then((()=>{loadEnrichersSpan.finish()})),yield(0,_initialisation_identity__WEBPACK_IMPORTED_MODULE_20__.TZ)({api,clientContext,eventsCache,externalData,global:permutiveGlobal,identities,identitiesIngestor,identityPromise,logger,messages,metrics,models,network,permutiveMethods,queryManager,reset:permutiveReset,stateSync,thirdParty,trace,unprocessedEvents,userId}),(0,_initialisation_identity__WEBPACK_IMPORTED_MODULE_20__.MA)({logger,queryManager,models,trace}),yield loadEnrichersPromise,(0,_initialisation_initialisationLifecycle__WEBPACK_IMPORTED_MODULE_48__.R)(queryManager,messages,metrics,state,logger),sdkReadySpan.finish()}))),(e=>`Exception during initialisation. Got ${e}`)),initialisationSequence=(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_49__.zG)(fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.Do,(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("support",(()=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.Uo)((0,_initialisation_browserFeatures__WEBPACK_IMPORTED_MODULE_50__.Oc)(window)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("queryWorker",(()=>_initialisation_queryWorkerInit__WEBPACK_IMPORTED_MODULE_22__.F)),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("sessionStorage",(()=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)((0,_initialisation_browserFeatures__WEBPACK_IMPORTED_MODULE_50__.l9)(window)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("partialTagWithKey",(()=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.Uo)((0,_initialisation_permutiveTag__WEBPACK_IMPORTED_MODULE_21__.$o)(window)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("queryParams",(()=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)((0,_utils_urls_UrlHelpers__WEBPACK_IMPORTED_MODULE_29__.zM)()))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("tag",(({partialTagWithKey:e,queryParams:t,sessionStorage:i})=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)((0,_initialisation_permutiveTag__WEBPACK_IMPORTED_MODULE_21__.je)(e,t,i)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("logger",(({tag:e})=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)((0,_core_internals_PermutiveLogger__WEBPACK_IMPORTED_MODULE_51__.SX)(e.config)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("urls",(({tag:e})=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)(new _http_PermutiveUrls__WEBPACK_IMPORTED_MODULE_52__.s(e.config)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("network",(({tag:e,urls:t,logger:i})=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)((0,_initialisation_permutiveTag__WEBPACK_IMPORTED_MODULE_21__.uU)(t,e.config,i)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("namespace",(({tag:e})=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)(new _core_state_PermutiveNamespace__WEBPACK_IMPORTED_MODULE_53__.L(e.config)))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("messages",(()=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.F2)(new _core_internals_SDKMessages__WEBPACK_IMPORTED_MODULE_54__.Q))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("consentModule",(({tag:e,namespace:t,logger:i,messages:n})=>(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.fF)((()=>(0,_Consent_Consent__WEBPACK_IMPORTED_MODULE_55__.NY)(n,i,t,e.config))))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.ak)("consent",(e=>(0,_Consent_InitialisationCheckWeb__WEBPACK_IMPORTED_MODULE_19__.D)(e))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_26__.tS)((e=>initialiseWebSDK(e))))},6013:(e,t,i)=>{i.d(t,{Fi:()=>O,G6:()=>S,Gz:()=>q,PM:()=>_,PQ:()=>D,Z_:()=>T,a4:()=>f,aq:()=>w,b0:()=>k,b2:()=>m,cO:()=>M,eu:()=>v,fl:()=>P,hk:()=>p,j5:()=>x,k$:()=>b,ke:()=>y,lW:()=>I,m8:()=>E,qh:()=>d,rB:()=>h,vp:()=>g});var n=i(4268),r=i(3735),o=i(6567),s=i(7209),a=i(6017),c=i(356),u=i(5857),l=i(2751);const p=(0,c.hX)((0,a.ff)(c.xb)),d=e=>Object.entries(e);function _(...e){return e.reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})}function g(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return t}(0,a.ff)(l.xb);function m(){let e,t;return{promise:new Promise(((i,n)=>{e=i,t=n})),reject:t,resolve:e}}function f(e,t,i={}){const{waitTimeInMs:n,exponentialBackOff:s,maxAttempts:a}=_({waitTimeInMs:50,exponentialBackOff:!1,maxAttempts:20},i);let c=0;const u=i=>new Promise((n=>Promise.resolve(t()).then((t=>t?Promise.resolve(e()).then((e=>n((0,o.G)(e)))):(0,r.zG)(c++,(e=>e<a?setTimeout((()=>n(u(i*(s?2:1)))),i):n(o.YP)))))));return u(n)}function h(e){const t={equals:(t,i)=>t[0]===i[0]&&e.equals(t[1],i[1])},i=(0,u.Eh)(t);return(0,n.Uz)((e=>new Set(Object.entries(e))))(i)}function v(e,t){const i=Object.create(null);for(const n of t)i[n]=e[n];return i}function y(e){if("string"==typeof e){const t=+e;if(!isNaN(t))return t}return e}function w(e,t){const i=t=>{if(!n&&t)return n=!0,e()};let n=!1;["blur","visibilitychange"].forEach((e=>{window.addEventListener(e,(()=>i(document.hidden&&function(e){return/Mobi|Android/i.test(e)}(t))))})),["beforeunload","pagehide"].forEach((e=>{window.addEventListener(e,(()=>i(!0)))}))}function b(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^(window.crypto||window.msCrypto).getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}function q(e){return 36===e.length&&/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(e)}function k(e,t){const i=Object.keys(e),n=i.length,r={};for(let s=0;s<n;s++){const n=i[s],a=t(n,e[n]);(0,o.pC)(a)&&(r[n]=a.value)}return r}function E(...e){const t={},i=e.length;for(let n=0;n<i;n++){const[i,r]=e[n];t[i]=r}return t}function P(e,t){return k(e,((e,i)=>t(e)?(0,o.G)(i):o.YP))}function S(e){return/^((?!chrome|android).)*safari/i.test(e)}function O(e){}function D(e,t){return new Promise((i=>{var n;setTimeout((()=>{Promise.resolve(e()).then(i)}),null!==(n=null==t?void 0:t.timeout)&&void 0!==n?n:0)}))}function M(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}function I(e){return(0,s.Zt)(((t,i)=>{const n=e.indexOf(t),r=e.indexOf(i);switch(!0){case-1===n&&-1===r:return 0;case-1!==n&&-1===r:return-1;case-1===n&&-1!==r:return 1;default:return n<=r?-1:1}}))}function x(e){return e.reduce(((e,t)=>(e[t]=!0,e)),{})}function T(e,t,i){return(...n)=>{try{return i(...n)}catch(i){e.error(i,t.get())}}}},998:(e,t,i)=>{i.d(t,{l:()=>n});class n{constructor(e){var t;this.config=e,this.shouldUsePerformanceMark=!1,this.placeholderSpan={spanId:null,finish:()=>({})},this.shouldUsePerformanceMark=(null===(t=null===window||void 0===window?void 0:window.performance)||void 0===t?void 0:t.mark)&&this.config.tracingEnabled}startSpan(e){var t;if(this.shouldUsePerformanceMark){const i=this.generateId(),n=`permutive_${e}`,r=`${n}${i}_start`;return null===(t=null===window||void 0===window?void 0:window.performance)||void 0===t||t.mark(r),{spanId:r,finish:()=>{var e,t;null===(t=null===(e=null===window||void 0===window?void 0:window.performance)||void 0===e?void 0:e.measure)||void 0===t||t.call(e,n,r)}}}return this.placeholderSpan}generateId(){return"_"+Math.random().toString(36).substr(2,9)}}},9409:(e,t,i)=>{i.d(t,{b:()=>n});class n{constructor(){this.events=[],this.listeners=[]}newEvent(e,t){this.events.push([e,t]),[...this.listeners].forEach((i=>{this.handle(e,t,i)}))}addListener(e){this.listeners.push(e);const t={replay:()=>(this.replay(e),t),remove:()=>(this.remove(e),t)};return t}handle(e,t,i){const n="string"==typeof i.name&&e.name===i.name,r=i.name.test&&i.name.test(e.name),o=n||r;if(o)try{i.callback(e,t)}catch(e){window.console&&window.console.error&&window.console.error("callback error: ",e)}o&&i.once&&this.remove(i)}replay(e){let t=-1!==this.listeners.indexOf(e);for(let i=0;i<this.events.length&&t;i++)this.handle(this.events[i][0],this.events[i][1],e),t=-1!==this.listeners.indexOf(e)}remove(e){const t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}}},7545:(e,t,i)=>{i.d(t,{b:()=>r});var n=i(6013);class r{constructor(e,t){this.timeoutDurationInMilliseconds=e,this.maxTimeOutDurationInMilliseconds=t}schedule(e,t=this.timeoutDurationInMilliseconds,i=this.maxTimeOutDurationInMilliseconds){return this.debounce(e,t,i)}scheduleAccumulated(e,t,i=this.timeoutDurationInMilliseconds,n=this.maxTimeOutDurationInMilliseconds){return this.debounce(e,i,n,t)}scheduleForPageUnload(e){return(0,n.aq)(e,navigator.userAgent)}debounce(e,t,i,r){let o,s,a=null==r?void 0:r.empty,c=[];return u=>{r&&(a=r.concat(a,u));const l=(0,n.b2)();c.push(l);return o&&window.clearTimeout(o),o=window.setTimeout((()=>{window.clearTimeout(s),s=null;const t=e(r?a:u);c.forEach((e=>e.resolve(t))),a=null==r?void 0:r.empty,c=[]}),t),s||(s=window.setTimeout((()=>{window.clearTimeout(o),s=null;const t=e(r?a:u);c.forEach((e=>e.resolve(t))),a=null==r?void 0:r.empty,c=[]}),i)),l.promise}}}},7749:(e,t,i)=>{i.d(t,{i:()=>n});class n{constructor(e){this.messages=e,this.queue=[],this.nextNotify=null,e.on("permutive:taskQueue:update",(()=>{this.execute()}))}add(e){this.queue.push(e),this.notify()}notify(){const e=()=>{this.messages.emit("permutive:taskQueue:update")},t=(new Date).getTime();null===this.nextNotify||this.nextNotify<t-50?(this.nextNotify=t,e()):this.nextNotify<=t&&(this.nextNotify=t+50,window.setTimeout(e,50))}execute(){if(0===this.queue.length)return;let e=!1,t=!1,i=0;for(let n=0;n<this.queue.length;n++){const r=this.queue[n];if(r.complete)i+=1;else if(r.started)t=!0,e=e||r.blocks();else{if(r.waits()&&t)break;e||(t=!0,e=e||r.blocks(),r.execute((()=>{this.notify()})))}}this.queue.splice(0,i)}size(){return this.queue.length}}},3629:(e,t,i)=>{i.d(t,{_Y:()=>s,bk:()=>o,zM:()=>r});var n=i(3735);const r=()=>{var e,t;const i=null===(t=null===(e=window.location.href.split("?")[1])||void 0===e?void 0:e.split("#")[0])||void 0===t?void 0:t.split("&");return void 0===i?{}:i.reduce(((e,t)=>{const[i,n]=t.split("=");return Object.assign(Object.assign({},e),{[i]:n})}),{})},o=e=>{if(!e)return"";return(0,n.zG)(e,(e=>{const t=e.length-1;return"/"===e[t]?e.slice(0,t):e}))};function s(e){const t=e.match(/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/),i=e.match(/[a-z0-9][a-z0-9-]+\.[a-z.]{2,24}$/i),n=e.match(/localhost/);if((null==i?void 0:i.length)>0){const t=e.split(".").reverse();return t.length>=3&&t[1].match(/^(com|edu|gov|net|mil|org|nom|co|ac|name|info|biz)$/i)?t[2]+"."+t[1]+"."+t[0]:t[1]+"."+t[0]}return(null==t?void 0:t.length)>0?t[0]:(null==n?void 0:n.length)>0?"localhost":""}},933:(e,t,i)=>{i.d(t,{p:()=>n});class n{getModels(){return Promise.resolve({})}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{var e=__webpack_require__(8198),t=__webpack_require__(3735),i=__webpack_require__(3760),n=__webpack_require__(6567),r=__webpack_require__(274),o=__webpack_require__(9320),s=__webpack_require__(6013),a=__webpack_require__(416);class c{constructor(e,t){this.config=e,this.logger=t,this.defaultReplacementMap=this.filterReplacementMap(this.config.defaultMap),this.replacementMap=this.setReplacementMap(this.config.replacementMap)}get getReplacementMap(){return this.replacementMap}setReplacementMap(e){return this.replacementMap=Object.assign(Object.assign({},this.defaultReplacementMap),this.filterReplacementMap(e)),this.logger.debug(`enrichers[${this.config.name}]: replacement map updated`,this.getReplacementMap),this.getReplacementMap}}class u extends c{filterReplacementMap(e){return(0,t.zG)(e,s.qh,(0,o.DZ)((e=>{const[,t]=e;return(0,a.t)(t)?n.YP:(0,n.G)(e)})),(0,o.u4)({},((e,[t,i])=>(void 0===i||(e[t]=i),e))))}}class l extends c{filterReplacementMap(e){return e}}const p="geoip",d="enricher:geoip",_={},g={include_geo:(null==_?void 0:_.include_geo)||!0,include_isp:(null==_?void 0:_.include_isp)||!0,include_ip_hash:(null==_?void 0:_.include_ip_hash)||!0,include_ip:(null==_?void 0:_.include_ip)||!1},m=(e,i)=>{const{$ip_geo_info_continent:o,$ip_address:s,$ip_address_hash:a}=r.U,c={$ip_geo_info_continent:o,$ip_address:s,$ip_geo_info:{city:r.U.$ip_geo_info_city,continent:r.U.$ip_geo_info_continent,country:r.U.$ip_geo_info_country,postal_code:r.U.$ip_geo_info_postal_code,province:r.U.$ip_geo_info_province},$ip_address_hash:a,$ip_isp_info:{autonomous_system_number:0,isp:r.U.$ip_isp_info_isp,autonomous_system_organization:r.U.$ip_isp_info_autonomous_system_organization,organization:r.U.$ip_isp_info_organization}},u=(0,t.zG)((0,n.Y3)((()=>({$ip_geo_info:e.geo_info,$ip_geo_info_continent:e.geo_info.continent,$ip_isp_info:e.isp_info,$ip_address:e.ip,$ip_address_hash:e.ip_hash}))),(0,n.fS)((()=>({}))));return new l({name:p,defaultMap:c,replacementMap:u},i)},f=({clientContext:e,api:t,permutiveData:i,metrics:n,sessionManager:r,enrichers:o,network:s,logger:a,config:c})=>{const u=t=>{t.isp_info&&e.updateContext(["isp",t.isp_info.isp],["organization",t.isp_info.organization],["autonomous_system_number",t.isp_info.autonomous_system_number],["autonomous_system_organization",t.isp_info.autonomous_system_organization]),t.geo_info&&e.updateContext(["continent",t.geo_info.continent],["country",t.geo_info.country],["city",t.geo_info.city],["province",t.geo_info.province],["postal_code",t.geo_info.postal_code])},l=i.getData(d);return l&&l.session_id===r.getSessionId()?(u(l.data),o.register(m(l.data,a)),Promise.resolve()):(a.debug("enrichers[geoip]: start HTTP request"),h(t,n,c,g).then((e=>(a.debug("enrichers[geoip]: end HTTP request"),u(e),i.setData(d,{session_id:r.getSessionId(),data:e}),e))).catch((e=>(s.error(`Error while registering the geoip enricher: got ${e}`),null))).then((e=>{o.register(m(e,a))})))},h=(e,t,i,r)=>{const o=[];return r.include_geo&&o.push(["include","geo"]),r.include_isp&&o.push(["include","isp"]),r.include_ip&&o.push(["include","ip"]),r.include_ip_hash&&o.push(["include","ip_hash"]),e.reqWithMetrics(t,"sdk_http_geoip_seconds",{url:e.urls.getEndpointUrl("/geoip",(0,n.G)(i.apiVersion),o),method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!1})},v=()=>(0,i.B)({load:f});var y=__webpack_require__(655),w=__webpack_require__(2751);const b="watson";function q(e){if(!e)return[];const t=(0,o.xH)(e.filter(Boolean).map((e=>(e=>{const t=e.split("/").filter((e=>e));return t.map(((e,i)=>"/"+t.slice(0,i+1).join("/")))})(e.label))));return(0,o.jj)(w.Eq)(t)}const k=({api:e,clientContext:t,config:i,enrichers:n,logger:r,metrics:o})=>{r.debug("enrichers[watson]: is enabled",i.watson.enabled);const s=i.watson.enabled?()=>(0,y.mG)(void 0,void 0,void 0,(function*(){const n=yield t.getClient();r.debug("enrichers[watson]: start HTTP request");const s=yield E(e,o,i,n.url);return r.debug("enrichers[watson]: end HTTP request",s),s})):()=>(0,y.mG)(void 0,void 0,void 0,(function*(){return r.debug("enrichers[watson]: stubbing response"),null})),a=s().then((e=>{t.updateContext([b,e]),n.register(((e,t)=>{var i,n,r,o;const s={$alchemy_concepts:null==e?void 0:e.concepts,$alchemy_document_emotion:null===(n=null===(i=null==e?void 0:e.emotion)||void 0===i?void 0:i.document)||void 0===n?void 0:n.emotion,$alchemy_document_sentiment:null===(r=null==e?void 0:e.sentiment)||void 0===r?void 0:r.document,$alchemy_entities:null==e?void 0:e.entities,$alchemy_entity_names:null===(o=null==e?void 0:e.entities)||void 0===o?void 0:o.map((e=>e.text)),$alchemy_keywords:null==e?void 0:e.keywords,$alchemy_taxonomy:null==e?void 0:e.taxonomy,$alchemy_taxonomy_labels:q(null==e?void 0:e.taxonomy),$taxonomy_labels:q(null==e?void 0:e.taxonomy)};return new u({name:b,defaultMap:{$alchemy_concepts:[],$alchemy_document_emotion:null,$alchemy_document_sentiment:null,$alchemy_entities:[],$alchemy_entity_names:[],$alchemy_keywords:[],$alchemy_taxonomy:[],$alchemy_taxonomy_labels:[],$taxonomy_labels:[]},replacementMap:s},t)})(e,r))}));return a.catch((e=>{r.error(`Error while registering the watson enricher: got ${e}`),o.track({name:"sdk_watson_classification_fail_count",value:1,labels:{}})})),a},E=(e,t,i,r)=>e.reqWithMetrics(t,"sdk_http_watson_seconds",{url:e.urls.getEndpointUrl("/watson",(0,n.G)(i.apiVersion)),method:"POST",contentType:"text/plain",dataType:"json",withCredentials:!1,payload:{url:r,classify:!0}}),P=()=>(0,i.B)({load:k});var S,O=__webpack_require__(6992);S=O.f,v(),P(),S().then((0,e.g_)((e=>console.warn(`Permutive was not initialized. ${e}`)),t.Q1))})()})();